1707462045
ac1e01bd81d25a49725bc38f4603e687-phpdoc%3A5de8b9f62402ea88afb20f05e46c4726-8c34e7d8e3dd802bacf16c687a1392c1
s:28580:"TzozMzoicGhwRG9jdW1lbnRvclxSZWZsZWN0aW9uXFBocFxGaWxlIjoxNDp7czo0MzoiAHBocERvY3VtZW50b3JcUmVmbGVjdGlvblxQaHBcRmlsZQBkb2NCbG9jayI7TjtzOjM5OiIAcGhwRG9jdW1lbnRvclxSZWZsZWN0aW9uXFBocFxGaWxlAGhhc2giO3M6MzI6IjhjMzRlN2Q4ZTNkZDgwMmJhY2YxNmM2ODdhMTM5MmMxIjtzOjM5OiIAcGhwRG9jdW1lbnRvclxSZWZsZWN0aW9uXFBocFxGaWxlAG5hbWUiO3M6MTg6InNpbXBsZS1waHB1bml0LnBocCI7czozOToiAHBocERvY3VtZW50b3JcUmVmbGVjdGlvblxQaHBcRmlsZQBwYXRoIjtzOjUyOiJ2ZW5kb3Ivc3ltZm9ueS9waHB1bml0LWJyaWRnZS9iaW4vc2ltcGxlLXBocHVuaXQucGhwIjtzOjQxOiIAcGhwRG9jdW1lbnRvclxSZWZsZWN0aW9uXFBocFxGaWxlAHNvdXJjZSI7czoxOTA3NzoiPD9waHAKCi8qCiAqIFRoaXMgZmlsZSBpcyBwYXJ0IG9mIHRoZSBTeW1mb255IHBhY2thZ2UuCiAqCiAqIChjKSBGYWJpZW4gUG90ZW5jaWVyIDxmYWJpZW5Ac3ltZm9ueS5jb20+CiAqCiAqIEZvciB0aGUgZnVsbCBjb3B5cmlnaHQgYW5kIGxpY2Vuc2UgaW5mb3JtYXRpb24sIHBsZWFzZSB2aWV3IHRoZSBMSUNFTlNFCiAqIGZpbGUgdGhhdCB3YXMgZGlzdHJpYnV0ZWQgd2l0aCB0aGlzIHNvdXJjZSBjb2RlLgogKi8KCi8vIFBsZWFzZSB1cGRhdGUgd2hlbiBwaHB1bml0IG5lZWRzIHRvIGJlIHJlaW5zdGFsbGVkIHdpdGggZnJlc2ggZGVwczoKLy8gQ2FjaGUtSWQ6IDIwMjEtMDItMDQgMTE6MDAgVVRDCgppZiAoJ2NsaScgIT09IFxQSFBfU0FQSSAmJiAncGhwZGJnJyAhPT0gXFBIUF9TQVBJKSB7CiAgICB0aHJvdyBuZXcgRXhjZXB0aW9uKCdUaGlzIHNjcmlwdCBtdXN0IGJlIHJ1biBmcm9tIHRoZSBjb21tYW5kIGxpbmUuJyk7Cn0KCmVycm9yX3JlcG9ydGluZygtMSk7CgpnbG9iYWwgJGFyZ3YsICRhcmdjOwokYXJndiA9ICRfU0VSVkVSWydhcmd2J10gPz8gW107CiRhcmdjID0gJF9TRVJWRVJbJ2FyZ2MnXSA/PyAwOwokZ2V0RW52VmFyID0gZnVuY3Rpb24gKCRuYW1lLCAkZGVmYXVsdCA9IGZhbHNlKSB1c2UgKCRhcmd2KSB7CiAgICBpZiAoZmFsc2UgIT09ICR2YWx1ZSA9IGdldGVudigkbmFtZSkpIHsKICAgICAgICByZXR1cm4gJHZhbHVlOwogICAgfQoKICAgIHN0YXRpYyAkcGhwdW5pdENvbmZpZyA9IG51bGw7CiAgICBpZiAobnVsbCA9PT0gJHBocHVuaXRDb25maWcpIHsKICAgICAgICAkcGhwdW5pdENvbmZpZ0ZpbGVuYW1lID0gbnVsbDsKICAgICAgICAkZ2V0UGhwVW5pdENvbmZpZyA9IGZ1bmN0aW9uICgkcHJvYmFibGVDb25maWcpIHVzZSAoJiRnZXRQaHBVbml0Q29uZmlnKSB7CiAgICAgICAgICAgIGlmICghJHByb2JhYmxlQ29uZmlnKSB7CiAgICAgICAgICAgICAgICByZXR1cm4gbnVsbDsKICAgICAgICAgICAgfQogICAgICAgICAgICBpZiAoaXNfZGlyKCRwcm9iYWJsZUNvbmZpZykpIHsKICAgICAgICAgICAgICAgIHJldHVybiAkZ2V0UGhwVW5pdENvbmZpZygkcHJvYmFibGVDb25maWcuXERJUkVDVE9SWV9TRVBBUkFUT1IuJ3BocHVuaXQueG1sJyk7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIGlmIChmaWxlX2V4aXN0cygkcHJvYmFibGVDb25maWcpKSB7CiAgICAgICAgICAgICAgICByZXR1cm4gJHByb2JhYmxlQ29uZmlnOwogICAgICAgICAgICB9CiAgICAgICAgICAgIGlmIChmaWxlX2V4aXN0cygkcHJvYmFibGVDb25maWcuJy5kaXN0JykpIHsKICAgICAgICAgICAgICAgIHJldHVybiAkcHJvYmFibGVDb25maWcuJy5kaXN0JzsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgcmV0dXJuIG51bGw7CiAgICAgICAgfTsKCiAgICAgICAgZm9yZWFjaCAoJGFyZ3YgYXMgJGNsaUFyZ3VtZW50SW5kZXggPT4gJGNsaUFyZ3VtZW50KSB7CiAgICAgICAgICAgIGlmICgnLS0nID09PSAkY2xpQXJndW1lbnQpIHsKICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICB9CiAgICAgICAgICAgIC8vIGxvbmcgb3B0aW9uCiAgICAgICAgICAgIGlmICgnLS1jb25maWd1cmF0aW9uJyA9PT0gJGNsaUFyZ3VtZW50ICYmIGFycmF5X2tleV9leGlzdHMoJGNsaUFyZ3VtZW50SW5kZXggKyAxLCAkYXJndikpIHsKICAgICAgICAgICAgICAgICRwaHB1bml0Q29uZmlnRmlsZW5hbWUgPSAkZ2V0UGhwVW5pdENvbmZpZygkYXJndlskY2xpQXJndW1lbnRJbmRleCArIDFdKTsKICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICB9CiAgICAgICAgICAgIC8vIHNob3J0IG9wdGlvbgogICAgICAgICAgICBpZiAoMCA9PT0gc3RycG9zKCRjbGlBcmd1bWVudCwgJy1jJykpIHsKICAgICAgICAgICAgICAgIGlmICgnLWMnID09PSAkY2xpQXJndW1lbnQgJiYgYXJyYXlfa2V5X2V4aXN0cygkY2xpQXJndW1lbnRJbmRleCArIDEsICRhcmd2KSkgewogICAgICAgICAgICAgICAgICAgICRwaHB1bml0Q29uZmlnRmlsZW5hbWUgPSAkZ2V0UGhwVW5pdENvbmZpZygkYXJndlskY2xpQXJndW1lbnRJbmRleCArIDFdKTsKICAgICAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICAgICAgJHBocHVuaXRDb25maWdGaWxlbmFtZSA9ICRnZXRQaHBVbml0Q29uZmlnKHN1YnN0cigkY2xpQXJndW1lbnQsIDIpKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICB9CiAgICAgICAgfQoKICAgICAgICAkcGhwdW5pdENvbmZpZ0ZpbGVuYW1lID0gJHBocHVuaXRDb25maWdGaWxlbmFtZSA/OiAkZ2V0UGhwVW5pdENvbmZpZygncGhwdW5pdC54bWwnKTsKCiAgICAgICAgaWYgKCRwaHB1bml0Q29uZmlnRmlsZW5hbWUpIHsKICAgICAgICAgICAgJHBocHVuaXRDb25maWcgPSBuZXcgRE9NRG9jdW1lbnQoKTsKICAgICAgICAgICAgJHBocHVuaXRDb25maWctPmxvYWQoJHBocHVuaXRDb25maWdGaWxlbmFtZSk7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgJHBocHVuaXRDb25maWcgPSBmYWxzZTsKICAgICAgICB9CiAgICB9CiAgICBpZiAoZmFsc2UgIT09ICRwaHB1bml0Q29uZmlnKSB7CiAgICAgICAgJHZhciA9IG5ldyBET01YUGF0aCgkcGhwdW5pdENvbmZpZyk7CiAgICAgICAgZm9yZWFjaCAoJHZhci0+cXVlcnkoJy8vcGhwL3NlcnZlcltAbmFtZT0iJy4kbmFtZS4nIl0nKSBhcyAkdmFyKSB7CiAgICAgICAgICAgIHJldHVybiAkdmFyLT5nZXRBdHRyaWJ1dGUoJ3ZhbHVlJyk7CiAgICAgICAgfQogICAgICAgIGZvcmVhY2ggKCR2YXItPnF1ZXJ5KCcvL3BocC9lbnZbQG5hbWU9IicuJG5hbWUuJyJdJykgYXMgJHZhcikgewogICAgICAgICAgICByZXR1cm4gJHZhci0+Z2V0QXR0cmlidXRlKCd2YWx1ZScpOwogICAgICAgIH0KICAgIH0KCiAgICByZXR1cm4gJGRlZmF1bHQ7Cn07CgokcGFzc3RocnVPckZhaWwgPSBmdW5jdGlvbiAoJGNvbW1hbmQpIHsKICAgIHBhc3N0aHJ1KCRjb21tYW5kLCAkc3RhdHVzKTsKCiAgICBpZiAoJHN0YXR1cykgewogICAgICAgIGV4aXQoJHN0YXR1cyk7CiAgICB9Cn07CgppZiAoXFBIUF9WRVJTSU9OX0lEID49IDgwMDAwKSB7CiAgICAkUEhQVU5JVF9WRVJTSU9OID0gJGdldEVudlZhcignU1lNRk9OWV9QSFBVTklUX1ZFUlNJT04nLCAnOS42JykgPzogJzkuNic7Cn0gZWxzZSB7CiAgICAkUEhQVU5JVF9WRVJTSU9OID0gJGdldEVudlZhcignU1lNRk9OWV9QSFBVTklUX1ZFUlNJT04nLCAnOC41JykgPzogJzguNSc7Cn0KCiRNQVhfUEhQVU5JVF9WRVJTSU9OID0gJGdldEVudlZhcignU1lNRk9OWV9NQVhfUEhQVU5JVF9WRVJTSU9OJywgZmFsc2UpOwoKaWYgKCRNQVhfUEhQVU5JVF9WRVJTSU9OICYmIHZlcnNpb25fY29tcGFyZSgkTUFYX1BIUFVOSVRfVkVSU0lPTiwgJFBIUFVOSVRfVkVSU0lPTiwgJzwnKSkgewogICAgJFBIUFVOSVRfVkVSU0lPTiA9ICRNQVhfUEhQVU5JVF9WRVJTSU9OOwp9CgokUEhQVU5JVF9SRU1PVkVfUkVUVVJOX1RZUEVISU5UID0gZmlsdGVyX3ZhcigkZ2V0RW52VmFyKCdTWU1GT05ZX1BIUFVOSVRfUkVNT1ZFX1JFVFVSTl9UWVBFSElOVCcsICcwJyksIFxGSUxURVJfVkFMSURBVEVfQk9PTEVBTik7CgokQ09NUE9TRVJfSlNPTiA9IGdldGVudignQ09NUE9TRVInKSA/OiAnY29tcG9zZXIuanNvbic7Cgokcm9vdCA9IF9fRElSX187CndoaWxlICghZmlsZV9leGlzdHMoJHJvb3QuJy8nLiRDT01QT1NFUl9KU09OKSB8fCBmaWxlX2V4aXN0cygkcm9vdC4nL0RlcHJlY2F0aW9uRXJyb3JIYW5kbGVyLnBocCcpKSB7CiAgICBpZiAoJHJvb3QgPT09IGRpcm5hbWUoJHJvb3QpKSB7CiAgICAgICAgYnJlYWs7CiAgICB9CiAgICAkcm9vdCA9IGRpcm5hbWUoJHJvb3QpOwp9Cgokb2xkUHdkID0gZ2V0Y3dkKCk7CiRQSFBVTklUX0RJUiA9IHJ0cmltKCRnZXRFbnZWYXIoJ1NZTUZPTllfUEhQVU5JVF9ESVInLCAkcm9vdC4nL3ZlbmRvci9iaW4vLnBocHVuaXQnKSwgJy8nLlxESVJFQ1RPUllfU0VQQVJBVE9SKTsKJFBIUCA9IGRlZmluZWQoJ1BIUF9CSU5BUlknKSA/IFxQSFBfQklOQVJZIDogJ3BocCc7CiRQSFAgPSBlc2NhcGVzaGVsbGFyZygkUEhQKTsKaWYgKCdwaHBkYmcnID09PSBcUEhQX1NBUEkpIHsKICAgICRQSFAgLj0gJyAtcXJyJzsKfQoKJGRlZmF1bHRFbnZzID0gWwogICAgJ0NPTVBPU0VSJyA9PiAnY29tcG9zZXIuanNvbicsCiAgICAnQ09NUE9TRVJfVkVORE9SX0RJUicgPT4gJ3ZlbmRvcicsCiAgICAnQ09NUE9TRVJfQklOX0RJUicgPT4gJ2JpbicsCiAgICAnU1lNRk9OWV9TSU1QTEVfUEhQVU5JVF9CSU5fRElSJyA9PiBfX0RJUl9fLApdOwoKZm9yZWFjaCAoJGRlZmF1bHRFbnZzIGFzICRlbnZOYW1lID0+ICRlbnZWYWx1ZSkgewogICAgaWYgKCRlbnZWYWx1ZSAhPT0gZ2V0ZW52KCRlbnZOYW1lKSkgewogICAgICAgIHB1dGVudigiJGVudk5hbWU9JGVudlZhbHVlIik7CiAgICAgICAgJF9TRVJWRVJbJGVudk5hbWVdID0gJF9FTlZbJGVudk5hbWVdID0gJGVudlZhbHVlOwogICAgfQp9CgppZiAoJ2Rpc2FibGVkJyA9PT0gJGdldEVudlZhcignU1lNRk9OWV9ERVBSRUNBVElPTlNfSEVMUEVSJykpIHsKICAgIHB1dGVudignU1lNRk9OWV9ERVBSRUNBVElPTlNfSEVMUEVSPWRpc2FibGVkJyk7Cn0KCmlmICghJGdldEVudlZhcignRE9DVFJJTkVfREVQUkVDQVRJT05TJykpIHsKICAgIHB1dGVudignRE9DVFJJTkVfREVQUkVDQVRJT05TPXRyaWdnZXInKTsKICAgICRfU0VSVkVSWydET0NUUklORV9ERVBSRUNBVElPTlMnXSA9ICRfRU5WWydET0NUUklORV9ERVBSRUNBVElPTlMnXSA9ICd0cmlnZ2VyJzsKfQoKJENPTVBPU0VSID0gKCRDT01QT1NFUiA9IGdldGVudignQ09NUE9TRVJfQklOQVJZJykpCiAgICB8fCBmaWxlX2V4aXN0cygkQ09NUE9TRVIgPSAkb2xkUHdkLicvY29tcG9zZXIucGhhcicpCiAgICB8fCAoJENPTVBPU0VSID0gcnRyaW0oKHN0cmluZykgKCdcXCcgPT09IFxESVJFQ1RPUllfU0VQQVJBVE9SID8gcHJlZ19yZXBsYWNlKCcvW1xyXG5dLiovJywgJycsIHNoZWxsX2V4ZWMoJ3doZXJlLmV4ZSBjb21wb3Nlci5waGFyIDI+IE5VTCcpKSA6IHNoZWxsX2V4ZWMoJ3doaWNoIGNvbXBvc2VyLnBoYXIgMj4gL2Rldi9udWxsJykpKSkKICAgIHx8ICgkQ09NUE9TRVIgPSBydHJpbSgoc3RyaW5nKSAoJ1xcJyA9PT0gXERJUkVDVE9SWV9TRVBBUkFUT1IgPyBwcmVnX3JlcGxhY2UoJy9bXHJcbl0uKi8nLCAnJywgc2hlbGxfZXhlYygnd2hlcmUuZXhlIGNvbXBvc2VyIDI+IE5VTCcpKSA6IHNoZWxsX2V4ZWMoJ3doaWNoIGNvbXBvc2VyIDI+IC9kZXYvbnVsbCcpKSkpCiAgICB8fCBmaWxlX2V4aXN0cygkQ09NUE9TRVIgPSBydHJpbSgoc3RyaW5nKSAoJ1xcJyA9PT0gXERJUkVDVE9SWV9TRVBBUkFUT1IgPyBzaGVsbF9leGVjKCdnaXQgcmV2LXBhcnNlIC0tc2hvdy10b3BsZXZlbCAyPiBOVUwnKSA6IHNoZWxsX2V4ZWMoJ2dpdCByZXYtcGFyc2UgLS1zaG93LXRvcGxldmVsIDI+IC9kZXYvbnVsbCcpKSkuXERJUkVDVE9SWV9TRVBBUkFUT1IuJ2NvbXBvc2VyLnBoYXInKQogICAgPyAoJyMhL3Vzci9iaW4vZW52IHBocCcgPT09IGZpbGVfZ2V0X2NvbnRlbnRzKCRDT01QT1NFUiwgZmFsc2UsIG51bGwsIDAsIDE4KSA/ICRQSFAgOiAnJykuJyAnLmVzY2FwZXNoZWxsYXJnKCRDT01QT1NFUikgLy8gZGV0ZWN0IHNoZWxsIHdyYXBwZXJzIGJ5IGxvb2tpbmcgYXQgdGhlIHNoZWJhbmcKICAgIDogJ2NvbXBvc2VyJzsKCiRwcmV2Q2FjaGVEaXIgPSBnZXRlbnYoJ0NPTVBPU0VSX0NBQ0hFX0RJUicpOwppZiAoJHByZXZDYWNoZURpcikgewogICAgaWYgKGZhbHNlID09PSAkYWJzb2x1dGVDYWNoZURpciA9IHJlYWxwYXRoKCRwcmV2Q2FjaGVEaXIpKSB7CiAgICAgICAgQG1rZGlyKCRwcmV2Q2FjaGVEaXIsIDA3NzcsIHRydWUpOwogICAgICAgICRhYnNvbHV0ZUNhY2hlRGlyID0gcmVhbHBhdGgoJHByZXZDYWNoZURpcik7CiAgICB9CiAgICBpZiAoJGFic29sdXRlQ2FjaGVEaXIpIHsKICAgICAgICBwdXRlbnYoIkNPTVBPU0VSX0NBQ0hFX0RJUj0kYWJzb2x1dGVDYWNoZURpciIpOwogICAgfSBlbHNlIHsKICAgICAgICAkcHJldkNhY2hlRGlyID0gZmFsc2U7CiAgICB9Cn0KJFNZTUZPTllfUEhQVU5JVF9SRU1PVkUgPSAkZ2V0RW52VmFyKCdTWU1GT05ZX1BIUFVOSVRfUkVNT1ZFJywgJ3BocHNwZWMvcHJvcGhlY3knLigkUEhQVU5JVF9WRVJTSU9OIDwgNi4wID8gJyBzeW1mb255L3lhbWwnIDogJycpKTsKJFNZTUZPTllfUEhQVU5JVF9SRVFVSVJFID0gJGdldEVudlZhcignU1lNRk9OWV9QSFBVTklUX1JFUVVJUkUnLCAnJyk7CiRjb25maWd1cmF0aW9uSGFzaCA9IG1kNShpbXBsb2RlKFxQSFBfRU9MLCBbbWQ1X2ZpbGUoX19GSUxFX18pLCAkU1lNRk9OWV9QSFBVTklUX1JFTU9WRSwgJFNZTUZPTllfUEhQVU5JVF9SRVFVSVJFLCAoaW50KSAkUEhQVU5JVF9SRU1PVkVfUkVUVVJOX1RZUEVISU5UXSkpOwokUEhQVU5JVF9WRVJTSU9OX0RJUiA9IHNwcmludGYoJ3BocHVuaXQtJXMtJWQnLCAkUEhQVU5JVF9WRVJTSU9OLCAkUEhQVU5JVF9SRU1PVkVfUkVUVVJOX1RZUEVISU5UKTsKaWYgKCFmaWxlX2V4aXN0cygiJFBIUFVOSVRfRElSLyRQSFBVTklUX1ZFUlNJT05fRElSL3BocHVuaXQiKSB8fCAkY29uZmlndXJhdGlvbkhhc2ggIT09IEBmaWxlX2dldF9jb250ZW50cygiJFBIUFVOSVRfRElSLy4kUEhQVU5JVF9WRVJTSU9OX0RJUi5tZDUiKSkgewogICAgLy8gQnVpbGQgYSBzdGFuZGFsb25lIHBocHVuaXQgd2l0aG91dCBzeW1mb255L3lhbWwgbm9yIHByb3BoZWN5IGJ5IGRlZmF1bHQKCiAgICBAbWtkaXIoJFBIUFVOSVRfRElSLCAwNzc3LCB0cnVlKTsKICAgIGNoZGlyKCRQSFBVTklUX0RJUik7CiAgICBpZiAoZmlsZV9leGlzdHMoIiRQSFBVTklUX1ZFUlNJT05fRElSIikpIHsKICAgICAgICBwYXNzdGhydShzcHJpbnRmKCdcXCcgPT09IFxESVJFQ1RPUllfU0VQQVJBVE9SID8gJ3JtZGlyIC9TIC9RICVzIDI+IE5VTCcgOiAncm0gLXJmICVzJywgZXNjYXBlc2hlbGxhcmcoIiRQSFBVTklUX1ZFUlNJT05fRElSLm9sZCIpKSk7CiAgICAgICAgcmVuYW1lKCIkUEhQVU5JVF9WRVJTSU9OX0RJUiIsICIkUEhQVU5JVF9WRVJTSU9OX0RJUi5vbGQiKTsKICAgICAgICBwYXNzdGhydShzcHJpbnRmKCdcXCcgPT09IFxESVJFQ1RPUllfU0VQQVJBVE9SID8gJ3JtZGlyIC9TIC9RICVzJyA6ICdybSAtcmYgJXMnLCBlc2NhcGVzaGVsbGFyZygiJFBIUFVOSVRfVkVSU0lPTl9ESVIub2xkIikpKTsKICAgIH0KCiAgICAkaW5mbyA9IFtdOwogICAgZm9yZWFjaCAoZXhwbG9kZSgiXG4iLCBgJENPTVBPU0VSIGluZm8gLS1uby1hbnNpIC1hIC1uIHBocHVuaXQvcGhwdW5pdCAiJFBIUFVOSVRfVkVSU0lPTi4qImApIGFzICRsaW5lKSB7CiAgICAgICAgJGxpbmUgPSBydHJpbSgkbGluZSk7CgogICAgICAgIGlmICghJGluZm8gJiYgcHJlZ19tYXRjaCgnL152ZXJzaW9ucyArOiAvJywgJGxpbmUpKSB7CiAgICAgICAgICAgICRpbmZvWyd2ZXJzaW9ucyddID0gZXhwbG9kZSgnLCAnLCBsdHJpbShzdWJzdHIoJGxpbmUsIDkpLCAnOiAnKSk7CiAgICAgICAgfSBlbHNlaWYgKGlzc2V0KCRpbmZvWydyZXF1aXJlcyddKSkgewogICAgICAgICAgICBpZiAoJycgPT09ICRsaW5lKSB7CiAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgJGxpbmUgPSBleHBsb2RlKCcgJywgJGxpbmUsIDIpOwogICAgICAgICAgICAkaW5mb1sncmVxdWlyZXMnXVskbGluZVswXV0gPSAkbGluZVsxXTsKICAgICAgICB9IGVsc2VpZiAoJGluZm8gJiYgJ3JlcXVpcmVzJyA9PT0gJGxpbmUpIHsKICAgICAgICAgICAgJGluZm9bJ3JlcXVpcmVzJ10gPSBbXTsKICAgICAgICB9CiAgICB9CgogICAgaWYgKGluX2FycmF5KCctLWNvbG9ycz1uZXZlcicsICRhcmd2LCB0cnVlKSB8fCAoaXNzZXQoJGFyZ3ZbJGkgPSBhcnJheV9zZWFyY2goJ25ldmVyJywgJGFyZ3YsIHRydWUpIC0gMV0pICYmICctLWNvbG9ycycgPT09ICRhcmd2WyRpXSkpIHsKICAgICAgICAkQ09NUE9TRVIgLj0gJyAtLW5vLWFuc2knOwogICAgfSBlbHNlIHsKICAgICAgICAkQ09NUE9TRVIgLj0gJyAtLWFuc2knOwogICAgfQoKICAgICRpbmZvICs9IFsKICAgICAgICAndmVyc2lvbnMnID0+IFtdLAogICAgICAgICdyZXF1aXJlcycgPT4gWydwaHAnID0+ICcqJ10sCiAgICBdOwoKICAgICRzdGFibGVWZXJzaW9ucyA9IGFycmF5X2ZpbHRlcigkaW5mb1sndmVyc2lvbnMnXSwgZnVuY3Rpb24gKCR2KSB7CiAgICAgICAgcmV0dXJuICFwcmVnX21hdGNoKCcvLWRldiR8XmRldi0vJywgJHYpOwogICAgfSk7CgogICAgaWYgKCEkc3RhYmxlVmVyc2lvbnMpIHsKICAgICAgICAkcGFzc3RocnVPckZhaWwoIiRDT01QT1NFUiBjcmVhdGUtcHJvamVjdCAtLWlnbm9yZS1wbGF0Zm9ybS1yZXFzIC0tbm8taW5zdGFsbCAtLXByZWZlci1kaXN0IC0tbm8tc2NyaXB0cyAtLW5vLXBsdWdpbnMgLS1uby1wcm9ncmVzcyAtcyBkZXYgcGhwdW5pdC9waHB1bml0ICRQSFBVTklUX1ZFUlNJT05fRElSIFwiJFBIUFVOSVRfVkVSU0lPTi4qXCIiKTsKICAgIH0gZWxzZSB7CiAgICAgICAgJHBhc3N0aHJ1T3JGYWlsKCIkQ09NUE9TRVIgY3JlYXRlLXByb2plY3QgLS1pZ25vcmUtcGxhdGZvcm0tcmVxcyAtLW5vLWluc3RhbGwgLS1wcmVmZXItZGlzdCAtLW5vLXNjcmlwdHMgLS1uby1wbHVnaW5zIC0tbm8tcHJvZ3Jlc3MgcGhwdW5pdC9waHB1bml0ICRQSFBVTklUX1ZFUlNJT05fRElSIFwiJFBIUFVOSVRfVkVSU0lPTi4qXCIiKTsKICAgIH0KCiAgICBAY29weSgiJFBIUFVOSVRfVkVSU0lPTl9ESVIvcGhwdW5pdC54c2QiLCAncGhwdW5pdC54c2QnKTsKICAgIGNoZGlyKCIkUEhQVU5JVF9WRVJTSU9OX0RJUiIpOwogICAgaWYgKCRTWU1GT05ZX1BIUFVOSVRfUkVNT1ZFKSB7CiAgICAgICAgJHBhc3N0aHJ1T3JGYWlsKCIkQ09NUE9TRVIgcmVtb3ZlIC0tbm8tdXBkYXRlIC0tbm8taW50ZXJhY3Rpb24gIi4kU1lNRk9OWV9QSFBVTklUX1JFTU9WRSk7CiAgICB9CiAgICBpZiAoJFNZTUZPTllfUEhQVU5JVF9SRVFVSVJFKSB7CiAgICAgICAgJHBhc3N0aHJ1T3JGYWlsKCIkQ09NUE9TRVIgcmVxdWlyZSAtLW5vLXVwZGF0ZSAtLW5vLWludGVyYWN0aW9uICIuJFNZTUZPTllfUEhQVU5JVF9SRVFVSVJFKTsKICAgIH0KICAgIGlmICg1LjEgPD0gJFBIUFVOSVRfVkVSU0lPTiAmJiAkUEhQVU5JVF9WRVJTSU9OIDwgNS40KSB7CiAgICAgICAgJHBhc3N0aHJ1T3JGYWlsKCIkQ09NUE9TRVIgcmVxdWlyZSAtLW5vLXVwZGF0ZSBwaHB1bml0L3BocHVuaXQtbW9jay1vYmplY3RzIFwifjMuMS4wXCIiKTsKICAgIH0KCiAgICBpZiAocHJlZ19tYXRjaCgne1xeKChcZCsrXC4pXGQrKylbXGRcLl0qJH0nLCAkaW5mb1sncmVxdWlyZXMnXVsncGhwJ10sICRwaHBWZXJzaW9uKSAmJiB2ZXJzaW9uX2NvbXBhcmUoJHBocFZlcnNpb25bMl0uJzk5JywgXFBIUF9WRVJTSU9OLCAnPCcpKSB7CiAgICAgICAgJHBhc3N0aHJ1T3JGYWlsKCIkQ09NUE9TRVIgY29uZmlnIHBsYXRmb3JtLnBocCBcIiRwaHBWZXJzaW9uWzFdLjk5XCIiKTsKICAgIH0gZWxzZSB7CiAgICAgICAgJHBhc3N0aHJ1T3JGYWlsKCIkQ09NUE9TRVIgY29uZmlnIC0tdW5zZXQgcGxhdGZvcm0ucGhwIik7CiAgICB9CiAgICBpZiAoZmlsZV9leGlzdHMoJHBhdGggPSAkcm9vdC4nL3ZlbmRvci9zeW1mb255L3BocHVuaXQtYnJpZGdlJykpIHsKICAgICAgICAkaGF5c3RhY2sgPSAiJFBIUFVOSVRfRElSLyRQSFBVTklUX1ZFUlNJT05fRElSIjsKICAgICAgICAkcm9vdExlbiA9IHN0cmxlbigkcm9vdCk7CgogICAgICAgICRwID0gKCRyb290TGVuIDw9IHN0cmxlbigkaGF5c3RhY2spID8gc3RyX3JlcGVhdCgnLi4vJywgc3Vic3RyX2NvdW50KCRoYXlzdGFjaywgJy8nLCAkcm9vdExlbikpIDogJycpLid2ZW5kb3Ivc3ltZm9ueS9waHB1bml0LWJyaWRnZSc7CiAgICAgICAgaWYgKHJlYWxwYXRoKCRwKSA9PT0gcmVhbHBhdGgoJHBhdGgpKSB7CiAgICAgICAgICAgICRwYXRoID0gJHA7CiAgICAgICAgfQogICAgICAgICRwYXNzdGhydU9yRmFpbCgiJENPTVBPU0VSIHJlcXVpcmUgLS1uby11cGRhdGUgc3ltZm9ueS9waHB1bml0LWJyaWRnZSBcIipAZGV2XCIiKTsKICAgICAgICAkcGFzc3RocnVPckZhaWwoIiRDT01QT1NFUiBjb25maWcgcmVwb3NpdG9yaWVzLnBocHVuaXQtYnJpZGdlIHBhdGggIi5lc2NhcGVzaGVsbGFyZyhzdHJfcmVwbGFjZSgnLycsIFxESVJFQ1RPUllfU0VQQVJBVE9SLCAkcGF0aCkpKTsKICAgICAgICBpZiAoJ1xcJyA9PT0gXERJUkVDVE9SWV9TRVBBUkFUT1IpIHsKICAgICAgICAgICAgZmlsZV9wdXRfY29udGVudHMoJ2NvbXBvc2VyLmpzb24nLCBwcmVnX3JlcGxhY2UoJy9eKCB7OH0pInBocHVuaXQtYnJpZGdlIjogXHskL20nLCAiJDBcbiQxICAgICIuJyJvcHRpb25zIjogeyJzeW1saW5rIjogZmFsc2V9LCcsIGZpbGVfZ2V0X2NvbnRlbnRzKCdjb21wb3Nlci5qc29uJykpKTsKICAgICAgICB9CiAgICB9IGVsc2UgewogICAgICAgICRwYXNzdGhydU9yRmFpbCgiJENPTVBPU0VSIHJlcXVpcmUgLS1uby11cGRhdGUgc3ltZm9ueS9waHB1bml0LWJyaWRnZSBcIipcIiIpOwogICAgfQogICAgJHByZXZSb290ID0gZ2V0ZW52KCdDT01QT1NFUl9ST09UX1ZFUlNJT04nKTsKICAgIHB1dGVudigiQ09NUE9TRVJfUk9PVF9WRVJTSU9OPSRQSFBVTklUX1ZFUlNJT04uOTkiKTsKICAgICRxID0gJ1xcJyA9PT0gXERJUkVDVE9SWV9TRVBBUkFUT1IgJiYgXFBIUF9WRVJTSU9OX0lEIDwgODAwMDAgPyAnIicgOiAnJzsKICAgIC8vIC0tbm8tc3VnZ2VzdCBpcyBub3QgaW4gdGhlIGxpc3QgdG8ga2VlcCBjb21wYXQgd2l0aCBjb21wb3NlciAxLjAsIHdoaWNoIGlzIHNoaXBwZWQgd2l0aCBVYnVudHUgMTYuMDRMVFMKICAgICRleGl0ID0gcHJvY19jbG9zZShwcm9jX29wZW4oIiRxJENPTVBPU0VSIHVwZGF0ZSAtLW5vLWRldiAtLXByZWZlci1kaXN0IC0tbm8tcHJvZ3Jlc3MgJHEiLCBbXSwgJHAsIGdldGN3ZCgpKSk7CiAgICBwdXRlbnYoJ0NPTVBPU0VSX1JPT1RfVkVSU0lPTicuKGZhbHNlICE9PSAkcHJldlJvb3QgPyAnPScuJHByZXZSb290IDogJycpKTsKICAgIGlmICgkcHJldkNhY2hlRGlyKSB7CiAgICAgICAgcHV0ZW52KCJDT01QT1NFUl9DQUNIRV9ESVI9JHByZXZDYWNoZURpciIpOwogICAgfQogICAgaWYgKCRleGl0KSB7CiAgICAgICAgZXhpdCgkZXhpdCk7CiAgICB9CgogICAgLy8gTXV0YXRlIFRlc3RDYXNlIGNvZGUKICAgICRhbHRlcmVkQ29kZSA9IGZpbGVfZ2V0X2NvbnRlbnRzKCRhbHRlcmVkRmlsZSA9ICcuL3NyYy9GcmFtZXdvcmsvVGVzdENhc2UucGhwJyk7CiAgICBpZiAoJFBIUFVOSVRfUkVNT1ZFX1JFVFVSTl9UWVBFSElOVCkgewogICAgICAgICRhbHRlcmVkQ29kZSA9IHByZWdfcmVwbGFjZSgnL14gICAgKCg/OnByb3RlY3RlZHxwdWJsaWMpKD86IHN0YXRpYyk/IGZ1bmN0aW9uIFx3K1woXCkpOiB2b2lkL20nLCAnICAgICQxJywgJGFsdGVyZWRDb2RlKTsKICAgIH0KICAgICRhbHRlcmVkQ29kZSA9IHByZWdfcmVwbGFjZSgnL2Fic3RyYWN0IGNsYXNzIFRlc3RDYXNlW15ce10rXHsvJywgJyQwICcuXFBIUF9FT0wuIiAgICB1c2UgXFN5bWZvbnlcQnJpZGdlXFBocFVuaXRcTGVnYWN5XFBvbHlmaWxsVGVzdENhc2VUcmFpdDsiLCAkYWx0ZXJlZENvZGUsIDEpOwogICAgZmlsZV9wdXRfY29udGVudHMoJGFsdGVyZWRGaWxlLCAkYWx0ZXJlZENvZGUpOwoKICAgIC8vIE11dGF0ZSBBc3NlcnQgY29kZQogICAgJGFsdGVyZWRDb2RlID0gZmlsZV9nZXRfY29udGVudHMoJGFsdGVyZWRGaWxlID0gJy4vc3JjL0ZyYW1ld29yay9Bc3NlcnQucGhwJyk7CiAgICAkYWx0ZXJlZENvZGUgPSBwcmVnX3JlcGxhY2UoJy9hYnN0cmFjdCBjbGFzcyBBc3NlcnRbXlx7XStcey8nLCAnJDAgJy5cUEhQX0VPTC4iICAgIHVzZSBcU3ltZm9ueVxCcmlkZ2VcUGhwVW5pdFxMZWdhY3lcUG9seWZpbGxBc3NlcnRUcmFpdDsiLCAkYWx0ZXJlZENvZGUsIDEpOwogICAgZmlsZV9wdXRfY29udGVudHMoJGFsdGVyZWRGaWxlLCAkYWx0ZXJlZENvZGUpOwoKICAgIGZpbGVfcHV0X2NvbnRlbnRzKCdwaHB1bml0JywgPDw8J0VPUEhQJwo8P3BocAoKZGVmaW5lKCdQSFBVTklUX0NPTVBPU0VSX0lOU1RBTEwnLCBfX0RJUl9fLicvdmVuZG9yL2F1dG9sb2FkLnBocCcpOwpyZXF1aXJlIFBIUFVOSVRfQ09NUE9TRVJfSU5TVEFMTDsKCmlmICghY2xhc3NfZXhpc3RzKFxTeW1mb255RXhjbHVkZUxpc3RQaHB1bml0OjpjbGFzcywgZmFsc2UpKSB7CiAgICBjbGFzcyBTeW1mb255RXhjbHVkZUxpc3RQaHB1bml0IHt9Cn0KaWYgKG1ldGhvZF9leGlzdHMoXFBIUFVuaXRcVXRpbFxFeGNsdWRlTGlzdDo6Y2xhc3MsICdhZGREaXJlY3RvcnknKSkgewogICAgKG5ldyBQSFBVbml0XFV0aWxcRXhjbHVkZWxpc3QoKSktPmdldEV4Y2x1ZGVkRGlyZWN0b3JpZXMoKTsKICAgIFBIUFVuaXRcVXRpbFxFeGNsdWRlTGlzdDo6YWRkRGlyZWN0b3J5KFxkaXJuYW1lKChuZXcgXFJlZmxlY3Rpb25DbGFzcyhcU3ltZm9ueUV4Y2x1ZGVMaXN0UGhwdW5pdDo6Y2xhc3MpKS0+Z2V0RmlsZU5hbWUoKSkpOwogICAgY2xhc3NfZXhpc3RzKFxTeW1mb255RXhjbHVkZUxpc3RTaW1wbGVQaHB1bml0OjpjbGFzcywgZmFsc2UpICYmIFBIUFVuaXRcVXRpbFxFeGNsdWRlTGlzdDo6YWRkRGlyZWN0b3J5KFxkaXJuYW1lKChuZXcgXFJlZmxlY3Rpb25DbGFzcyhcU3ltZm9ueUV4Y2x1ZGVMaXN0U2ltcGxlUGhwdW5pdDo6Y2xhc3MpKS0+Z2V0RmlsZU5hbWUoKSkpOwp9IGVsc2VpZiAobWV0aG9kX2V4aXN0cyhcUEhQVW5pdFxVdGlsXEJsYWNrbGlzdDo6Y2xhc3MsICdhZGREaXJlY3RvcnknKSkgewogICAgKG5ldyBQSFBVbml0XFV0aWxcQmxhY2tMaXN0KCkpLT5nZXRCbGFja2xpc3RlZERpcmVjdG9yaWVzKCk7CiAgICBQSFBVbml0XFV0aWxcQmxhY2tsaXN0OjphZGREaXJlY3RvcnkoXGRpcm5hbWUoKG5ldyBcUmVmbGVjdGlvbkNsYXNzKFxTeW1mb255RXhjbHVkZUxpc3RQaHB1bml0OjpjbGFzcykpLT5nZXRGaWxlTmFtZSgpKSk7CiAgICBjbGFzc19leGlzdHMoXFN5bWZvbnlFeGNsdWRlTGlzdFNpbXBsZVBocHVuaXQ6OmNsYXNzLCBmYWxzZSkgJiYgUEhQVW5pdFxVdGlsXEJsYWNrbGlzdDo6YWRkRGlyZWN0b3J5KFxkaXJuYW1lKChuZXcgXFJlZmxlY3Rpb25DbGFzcyhcU3ltZm9ueUV4Y2x1ZGVMaXN0U2ltcGxlUGhwdW5pdDo6Y2xhc3MpKS0+Z2V0RmlsZU5hbWUoKSkpOwp9IGVsc2UgewogICAgUEhQVW5pdFxVdGlsXEJsYWNrbGlzdDo6JGJsYWNrbGlzdGVkQ2xhc3NOYW1lc1snU3ltZm9ueUV4Y2x1ZGVMaXN0UGhwdW5pdCddID0gMTsKICAgIFBIUFVuaXRcVXRpbFxCbGFja2xpc3Q6OiRibGFja2xpc3RlZENsYXNzTmFtZXNbJ1N5bWZvbnlFeGNsdWRlTGlzdFNpbXBsZVBocHVuaXQnXSA9IDE7Cn0KClN5bWZvbnlcQnJpZGdlXFBocFVuaXRcVGV4dFVJXENvbW1hbmQ6Om1haW4oKTsKCkVPUEhQCiAgICApOwogICAgY2hkaXIoJy4uJyk7CiAgICBmaWxlX3B1dF9jb250ZW50cygiLiRQSFBVTklUX1ZFUlNJT05fRElSLm1kNSIsICRjb25maWd1cmF0aW9uSGFzaCk7CiAgICBjaGRpcigkb2xkUHdkKTsKfQoKLy8gQ3JlYXRlIGEgc3ltbGluayB3aXRoIGEgcHJlZGljdGFibGUgcGF0aCBwb2ludGluZyB0byB0aGUgY3VycmVudGx5IHVzZWQgdmVyc2lvbi4KLy8gVGhpcyBpcyB1c2VmdWwgZm9yIHN0YXRpYyBhbmFseXRpY3MgdG9vbHMgc3VjaCBhcyBQSFBTdGFuIGhhdmluZyB0byBsb2FkIFBIUFVuaXQncyBjbGFzc2VzCi8vIGFuZCBmb3Igb3RoZXIgdGVzdGluZyBsaWJyYXJpZXMgc3VjaCBhcyBCZWhhdCB1c2luZyBQSFBVbml0J3MgYXNzZXJ0aW9ucy4KY2hkaXIoJFBIUFVOSVRfRElSKTsKaWYgKCdcXCcgPT09IFxESVJFQ1RPUllfU0VQQVJBVE9SKSB7CiAgICBwYXNzdGhydSgncm1kaXIgL1MgL1EgcGhwdW5pdCAyPiBOVUwnKTsKICAgIHBhc3N0aHJ1KHNwcmludGYoJ21rbGluayAvaiBwaHB1bml0ICVzID4gTlVMIDI+JjEnLCBlc2NhcGVzaGVsbGFyZygkUEhQVU5JVF9WRVJTSU9OX0RJUikpKTsKfSBlbHNlIHsKICAgIGlmIChmaWxlX2V4aXN0cygncGhwdW5pdCcpKSB7CiAgICAgICAgQHVubGluaygncGhwdW5pdCcpOwogICAgfQogICAgQHN5bWxpbmsoJFBIUFVOSVRfVkVSU0lPTl9ESVIsICdwaHB1bml0Jyk7Cn0KY2hkaXIoJG9sZFB3ZCk7CgppZiAoJFBIUFVOSVRfVkVSU0lPTiA8IDguMCkgewogICAgJGFyZ3YgPSBhcnJheV9maWx0ZXIoJGFyZ3YsIGZ1bmN0aW9uICgkdikgdXNlICgmJGFyZ2MpIHsKICAgICAgICBpZiAoJy0tZG8tbm90LWNhY2hlLXJlc3VsdCcgIT09ICR2KSB7CiAgICAgICAgICAgIHJldHVybiB0cnVlOwogICAgICAgIH0KICAgICAgICAtLSRhcmdjOwoKICAgICAgICByZXR1cm4gZmFsc2U7CiAgICB9KTsKfSBlbHNlaWYgKGZpbHRlcl92YXIoZ2V0ZW52KCdTWU1GT05ZX1BIUFVOSVRfRElTQUJMRV9SRVNVTFRfQ0FDSEUnKSwgXEZJTFRFUl9WQUxJREFURV9CT09MRUFOKSkgewogICAgJGFyZ3ZbXSA9ICctLWRvLW5vdC1jYWNoZS1yZXN1bHQnOwogICAgKyskYXJnYzsKfQoKJGNvbXBvbmVudHMgPSBbXTsKJGNtZCA9IGFycmF5X21hcCgnZXNjYXBlc2hlbGxhcmcnLCAkYXJndik7CiRleGl0ID0gMDsKCmlmIChpc3NldCgkYXJndlsxXSkgJiYgJ3N5bWZvbnknID09PSAkYXJndlsxXSAmJiAhZmlsZV9leGlzdHMoJ3N5bWZvbnknKSAmJiBmaWxlX2V4aXN0cygnc3JjL1N5bWZvbnknKSkgewogICAgJGFyZ3ZbMV0gPSAnc3JjL1N5bWZvbnknOwp9CmlmIChpc3NldCgkYXJndlsxXSkgJiYgaXNfZGlyKCRhcmd2WzFdKSAmJiAhZmlsZV9leGlzdHMoJGFyZ3ZbMV0uJy9waHB1bml0LnhtbC5kaXN0JykpIHsKICAgIC8vIEZpbmQgU3ltZm9ueSBjb21wb25lbnRzIGluIHBsYWluIHBocCBmb3IgV2luZG93cyBwb3J0YWJpbGl0eQoKICAgICRmaW5kZXIgPSBuZXcgUmVjdXJzaXZlRGlyZWN0b3J5SXRlcmF0b3IoJGFyZ3ZbMV0sIEZpbGVzeXN0ZW1JdGVyYXRvcjo6S0VZX0FTX0ZJTEVOQU1FIHwgRmlsZXN5c3RlbUl0ZXJhdG9yOjpVTklYX1BBVEhTKTsKICAgICRmaW5kZXIgPSBuZXcgUmVjdXJzaXZlSXRlcmF0b3JJdGVyYXRvcigkZmluZGVyKTsKICAgICRmaW5kZXItPnNldE1heERlcHRoKGdldGVudignU1lNRk9OWV9QSFBVTklUX01BWF9ERVBUSCcpID86IDMpOwoKICAgIGZvcmVhY2ggKCRmaW5kZXIgYXMgJGZpbGUgPT4gJGZpbGVJbmZvKSB7CiAgICAgICAgaWYgKCdwaHB1bml0LnhtbC5kaXN0JyA9PT0gJGZpbGUpIHsKICAgICAgICAgICAgJGNvbXBvbmVudHNbXSA9IGRpcm5hbWUoJGZpbGVJbmZvLT5nZXRQYXRobmFtZSgpKTsKICAgICAgICB9CiAgICB9CiAgICBpZiAoJGNvbXBvbmVudHMpIHsKICAgICAgICBhcnJheV9zaGlmdCgkY21kKTsKICAgIH0KfQoKJGNtZFswXSA9IHNwcmludGYoJyVzICVzIC0tY29sb3JzPSVzJywgJFBIUCwgZXNjYXBlc2hlbGxhcmcoIiRQSFBVTklUX0RJUi8kUEhQVU5JVF9WRVJTSU9OX0RJUi9waHB1bml0IiksIGZhbHNlID09PSAkZ2V0RW52VmFyKCdOT19DT0xPUicpID8gJ2Fsd2F5cycgOiAnbmV2ZXInKTsKJGNtZCA9IHN0cl9yZXBsYWNlKCclJywgJyUlJywgaW1wbG9kZSgnICcsICRjbWQpKS4nICUxJHMnOwoKaWYgKCdcXCcgPT09IFxESVJFQ1RPUllfU0VQQVJBVE9SKSB7CiAgICAkY21kID0gJ2NtZCAvdjpvbiAvZCAvYyAiKCcuJGNtZC4nKSUyJHMiJzsKfSBlbHNlIHsKICAgICRjbWQgLj0gJyUyJHMnOwp9CgppZiAoJGNvbXBvbmVudHMpIHsKICAgICRza2lwcGVkVGVzdHMgPSAkX1NFUlZFUlsnU1lNRk9OWV9QSFBVTklUX1NLSVBQRURfVEVTVFMnXSA/PyBmYWxzZTsKICAgICRydW5uaW5nUHJvY3MgPSBbXTsKCiAgICBmb3JlYWNoICgkY29tcG9uZW50cyBhcyAkY29tcG9uZW50KSB7CiAgICAgICAgLy8gUnVuIHBocHVuaXQgdGVzdHMgaW4gcGFyYWxsZWwKCiAgICAgICAgaWYgKCRza2lwcGVkVGVzdHMpIHsKICAgICAgICAgICAgcHV0ZW52KCJTWU1GT05ZX1BIUFVOSVRfU0tJUFBFRF9URVNUUz0kY29tcG9uZW50LyRza2lwcGVkVGVzdHMiKTsKICAgICAgICB9CgogICAgICAgICRjID0gZXNjYXBlc2hlbGxhcmcoJGNvbXBvbmVudCk7CgogICAgICAgIGlmICgkcHJvYyA9IHByb2Nfb3BlbihzcHJpbnRmKCRjbWQsICRjLCAiID4gJGMvcGhwdW5pdC5zdGRvdXQgMj4gJGMvcGhwdW5pdC5zdGRlcnIiKSwgW10sICRwaXBlcykpIHsKICAgICAgICAgICAgJHJ1bm5pbmdQcm9jc1skY29tcG9uZW50XSA9ICRwcm9jOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICRleGl0ID0gMTsKICAgICAgICAgICAgZWNobyAiXDAzM1s0MW1LT1wwMzNbMG0gJGNvbXBvbmVudFxuXG4iOwogICAgICAgIH0KICAgIH0KCiAgICAkbGFzdE91dHB1dCA9IG51bGw7CiAgICAkbGFzdE91dHB1dFRpbWUgPSBudWxsOwoKICAgIHdoaWxlICgkcnVubmluZ1Byb2NzKSB7CiAgICAgICAgdXNsZWVwKDMwMDAwMCk7CiAgICAgICAgJHRlcm1pbmF0ZWRQcm9jcyA9IFtdOwogICAgICAgIGZvcmVhY2ggKCRydW5uaW5nUHJvY3MgYXMgJGNvbXBvbmVudCA9PiAkcHJvYykgewogICAgICAgICAgICAkcHJvY1N0YXR1cyA9IHByb2NfZ2V0X3N0YXR1cygkcHJvYyk7CiAgICAgICAgICAgIGlmICghJHByb2NTdGF0dXNbJ3J1bm5pbmcnXSkgewogICAgICAgICAgICAgICAgJHRlcm1pbmF0ZWRQcm9jc1skY29tcG9uZW50XSA9ICRwcm9jU3RhdHVzWydleGl0Y29kZSddOwogICAgICAgICAgICAgICAgdW5zZXQoJHJ1bm5pbmdQcm9jc1skY29tcG9uZW50XSk7CiAgICAgICAgICAgICAgICBwcm9jX2Nsb3NlKCRwcm9jKTsKICAgICAgICAgICAgfQogICAgICAgIH0KCiAgICAgICAgaWYgKCEkdGVybWluYXRlZFByb2NzICYmIDEgPT09IGNvdW50KCRydW5uaW5nUHJvY3MpKSB7CiAgICAgICAgICAgICRjb21wb25lbnQgPSBrZXkoJHJ1bm5pbmdQcm9jcyk7CgogICAgICAgICAgICAkb3V0cHV0ID0gZmlsZV9nZXRfY29udGVudHMoIiRjb21wb25lbnQvcGhwdW5pdC5zdGRvdXQiKTsKICAgICAgICAgICAgJG91dHB1dCAuPSBmaWxlX2dldF9jb250ZW50cygiJGNvbXBvbmVudC9waHB1bml0LnN0ZGVyciIpOwoKICAgICAgICAgICAgaWYgKCRsYXN0T3V0cHV0ICE9PSAkb3V0cHV0KSB7CiAgICAgICAgICAgICAgICAkbGFzdE91dHB1dCA9ICRvdXRwdXQ7CiAgICAgICAgICAgICAgICAkbGFzdE91dHB1dFRpbWUgPSBtaWNyb3RpbWUodHJ1ZSk7CiAgICAgICAgICAgIH0gZWxzZWlmIChtaWNyb3RpbWUodHJ1ZSkgLSAkbGFzdE91dHB1dFRpbWUgPiA2MCkgewogICAgICAgICAgICAgICAgZWNobyAiXDAzM1s0MW1UaW1lb3V0XDAzM1swbSAkY29tcG9uZW50XG5cbiI7CgogICAgICAgICAgICAgICAgaWYgKCdcXCcgPT09IFxESVJFQ1RPUllfU0VQQVJBVE9SKSB7CiAgICAgICAgICAgICAgICAgICAgZXhlYyhzcHJpbnRmKCd0YXNra2lsbCAvRiAvVCAvUElEICVkIDI+JjEnLCAkcHJvY1N0YXR1c1sncGlkJ10pLCAkb3V0cHV0LCAkZXhpdENvZGUpOwogICAgICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgICAgICBwcm9jX3Rlcm1pbmF0ZShjdXJyZW50KCRydW5uaW5nUHJvY3MpKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgIH0KCiAgICAgICAgZm9yZWFjaCAoJHRlcm1pbmF0ZWRQcm9jcyBhcyAkY29tcG9uZW50ID0+ICRwcm9jU3RhdHVzKSB7CiAgICAgICAgICAgIGZvcmVhY2ggKFsnb3V0JywgJ2VyciddIGFzICRmaWxlKSB7CiAgICAgICAgICAgICAgICAkZmlsZSA9ICIkY29tcG9uZW50L3BocHVuaXQuc3RkJGZpbGUiOwogICAgICAgICAgICAgICAgcmVhZGZpbGUoJGZpbGUpOwogICAgICAgICAgICAgICAgdW5saW5rKCRmaWxlKTsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgLy8gRmFpbCBvbiBhbnkgaW5kaXZpZHVhbCBjb21wb25lbnQgZmFpbHVyZXMgYnV0IGlnbm9yZSBzb21lIGVycm9yIGNvZGVzIG9uIFdpbmRvd3Mgd2hlbiBBUEN1IGlzIGVuYWJsZWQ6CiAgICAgICAgICAgIC8vIFNUQVRVU19TVEFDS19CVUZGRVJfT1ZFUlJVTiAoLTEwNzM3NDA3OTEvMHhDMDAwMDQwOSkKICAgICAgICAgICAgLy8gU1RBVFVTX0FDQ0VTU19WSU9MQVRJT04gKC0xMDczNzQxODE5LzB4QzAwMDAwMDUpCiAgICAgICAgICAgIC8vIFNUQVRVU19IRUFQX0NPUlJVUFRJT04gKC0xMDczNzQwOTQwLzB4QzAwMDAzNzQpCiAgICAgICAgICAgIGlmICgkcHJvY1N0YXR1cyAmJiAoJ1xcJyAhPT0gXERJUkVDVE9SWV9TRVBBUkFUT1IgfHwgIWV4dGVuc2lvbl9sb2FkZWQoJ2FwY3UnKSB8fCAhZmlsdGVyX3ZhcihpbmlfZ2V0KCdhcGMuZW5hYmxlX2NsaScpLCBcRklMVEVSX1ZBTElEQVRFX0JPT0xFQU4pIHx8ICFpbl9hcnJheSgkcHJvY1N0YXR1cywgWy0xMDczNzQwNzkxLCAtMTA3Mzc0MTgxOSwgLTEwNzM3NDA5NDBdKSkpIHsKICAgICAgICAgICAgICAgICRleGl0ID0gJHByb2NTdGF0dXM7CiAgICAgICAgICAgICAgICBlY2hvICJcMDMzWzQxbUtPXDAzM1swbSAkY29tcG9uZW50XG5cbiI7CiAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICBlY2hvICJcMDMzWzMybU9LXDAzM1swbSAkY29tcG9uZW50XG5cbiI7CiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICB9Cn0gZWxzZWlmICghaXNzZXQoJGFyZ3ZbMV0pIHx8ICdpbnN0YWxsJyAhPT0gJGFyZ3ZbMV0gfHwgZmlsZV9leGlzdHMoJ2luc3RhbGwnKSkgewogICAgaWYgKCFjbGFzc19leGlzdHMoXFN5bWZvbnlFeGNsdWRlTGlzdFNpbXBsZVBocHVuaXQ6OmNsYXNzLCBmYWxzZSkpIHsKICAgICAgICBjbGFzcyBTeW1mb255RXhjbHVkZUxpc3RTaW1wbGVQaHB1bml0CiAgICAgICAgewogICAgICAgIH0KICAgIH0KICAgIGFycmF5X3NwbGljZSgkYXJndiwgMSwgMCwgWyctLWNvbG9ycz0nLihmYWxzZSA9PT0gJGdldEVudlZhcignTk9fQ09MT1InKSA/ICdhbHdheXMnIDogJ25ldmVyJyldKTsKICAgICRfU0VSVkVSWydhcmd2J10gPSAkYXJndjsKICAgICRfU0VSVkVSWydhcmdjJ10gPSArKyRhcmdjOwogICAgaW5jbHVkZSAiJFBIUFVOSVRfRElSLyRQSFBVTklUX1ZFUlNJT05fRElSL3BocHVuaXQiOwp9CgpleGl0KCRleGl0KTsKIjtzOjQ1OiIAcGhwRG9jdW1lbnRvclxSZWZsZWN0aW9uXFBocFxGaWxlAG5hbWVzcGFjZXMiO2E6MDp7fXM6NDM6IgBwaHBEb2N1bWVudG9yXFJlZmxlY3Rpb25cUGhwXEZpbGUAaW5jbHVkZXMiO2E6MDp7fXM6NDQ6IgBwaHBEb2N1bWVudG9yXFJlZmxlY3Rpb25cUGhwXEZpbGUAZnVuY3Rpb25zIjthOjA6e31zOjQ0OiIAcGhwRG9jdW1lbnRvclxSZWZsZWN0aW9uXFBocFxGaWxlAGNvbnN0YW50cyI7YTowOnt9czo0MjoiAHBocERvY3VtZW50b3JcUmVmbGVjdGlvblxQaHBcRmlsZQBjbGFzc2VzIjthOjE6e3M6MzI6IlxTeW1mb255RXhjbHVkZUxpc3RTaW1wbGVQaHB1bml0IjtPOjM1OiJwaHBEb2N1bWVudG9yXFJlZmxlY3Rpb25cUGhwXENsYXNzXyI6MTQ6e3M6NDI6IgBwaHBEb2N1bWVudG9yXFJlZmxlY3Rpb25cUGhwXENsYXNzXwBmcXNlbiI7TzozMDoicGhwRG9jdW1lbnRvclxSZWZsZWN0aW9uXEZxc2VuIjoyOntzOjM3OiIAcGhwRG9jdW1lbnRvclxSZWZsZWN0aW9uXEZxc2VuAGZxc2VuIjtzOjMyOiJcU3ltZm9ueUV4Y2x1ZGVMaXN0U2ltcGxlUGhwdW5pdCI7czozNjoiAHBocERvY3VtZW50b3JcUmVmbGVjdGlvblxGcXNlbgBuYW1lIjtzOjMxOiJTeW1mb255RXhjbHVkZUxpc3RTaW1wbGVQaHB1bml0Ijt9czo0NToiAHBocERvY3VtZW50b3JcUmVmbGVjdGlvblxQaHBcQ2xhc3NfAGRvY0Jsb2NrIjtOO3M6NDU6IgBwaHBEb2N1bWVudG9yXFJlZmxlY3Rpb25cUGhwXENsYXNzXwByZWFkT25seSI7YjowO3M6NDU6IgBwaHBEb2N1bWVudG9yXFJlZmxlY3Rpb25cUGhwXENsYXNzXwBhYnN0cmFjdCI7YjowO3M6NDI6IgBwaHBEb2N1bWVudG9yXFJlZmxlY3Rpb25cUGhwXENsYXNzXwBmaW5hbCI7YjowO3M6NDM6IgBwaHBEb2N1bWVudG9yXFJlZmxlY3Rpb25cUGhwXENsYXNzXwBwYXJlbnQiO047czo0NzoiAHBocERvY3VtZW50b3JcUmVmbGVjdGlvblxQaHBcQ2xhc3NfAGltcGxlbWVudHMiO2E6MDp7fXM6NDY6IgBwaHBEb2N1bWVudG9yXFJlZmxlY3Rpb25cUGhwXENsYXNzXwBjb25zdGFudHMiO2E6MDp7fXM6NDc6IgBwaHBEb2N1bWVudG9yXFJlZmxlY3Rpb25cUGhwXENsYXNzXwBwcm9wZXJ0aWVzIjthOjA6e31zOjQ0OiIAcGhwRG9jdW1lbnRvclxSZWZsZWN0aW9uXFBocFxDbGFzc18AbWV0aG9kcyI7YTowOnt9czo0NzoiAHBocERvY3VtZW50b3JcUmVmbGVjdGlvblxQaHBcQ2xhc3NfAHVzZWRUcmFpdHMiO2E6MDp7fXM6NDU6IgBwaHBEb2N1bWVudG9yXFJlZmxlY3Rpb25cUGhwXENsYXNzXwBsb2NhdGlvbiI7TzozMzoicGhwRG9jdW1lbnRvclxSZWZsZWN0aW9uXExvY2F0aW9uIjoyOntzOjQ1OiIAcGhwRG9jdW1lbnRvclxSZWZsZWN0aW9uXExvY2F0aW9uAGxpbmVOdW1iZXIiO2k6NDU4O3M6NDc6IgBwaHBEb2N1bWVudG9yXFJlZmxlY3Rpb25cTG9jYXRpb24AY29sdW1uTnVtYmVyIjtpOjA7fXM6NDg6IgBwaHBEb2N1bWVudG9yXFJlZmxlY3Rpb25cUGhwXENsYXNzXwBlbmRMb2NhdGlvbiI7TzozMzoicGhwRG9jdW1lbnRvclxSZWZsZWN0aW9uXExvY2F0aW9uIjoyOntzOjQ1OiIAcGhwRG9jdW1lbnRvclxSZWZsZWN0aW9uXExvY2F0aW9uAGxpbmVOdW1iZXIiO2k6NDYwO3M6NDc6IgBwaHBEb2N1bWVudG9yXFJlZmxlY3Rpb25cTG9jYXRpb24AY29sdW1uTnVtYmVyIjtpOjA7fXM6NDU6IgBwaHBEb2N1bWVudG9yXFJlZmxlY3Rpb25cUGhwXENsYXNzXwBtZXRhZGF0YSI7YTowOnt9fX1zOjQ1OiIAcGhwRG9jdW1lbnRvclxSZWZsZWN0aW9uXFBocFxGaWxlAGludGVyZmFjZXMiO2E6MDp7fXM6NDE6IgBwaHBEb2N1bWVudG9yXFJlZmxlY3Rpb25cUGhwXEZpbGUAdHJhaXRzIjthOjA6e31zOjQwOiIAcGhwRG9jdW1lbnRvclxSZWZsZWN0aW9uXFBocFxGaWxlAGVudW1zIjthOjA6e31zOjQzOiIAcGhwRG9jdW1lbnRvclxSZWZsZWN0aW9uXFBocFxGaWxlAG1ldGFkYXRhIjthOjA6e319";