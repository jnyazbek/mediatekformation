1707462020
ac1e01bd81d25a49725bc38f4603e687-phpdoc%3Ab7ce4ad62a3ff411dd73c2d9a251d460-eeefe1355268d5ed272e09fb2cc6d551
s:145764:"TzozMzoicGhwRG9jdW1lbnRvclxSZWZsZWN0aW9uXFBocFxGaWxlIjoxNDp7czo0MzoiAHBocERvY3VtZW50b3JcUmVmbGVjdGlvblxQaHBcRmlsZQBkb2NCbG9jayI7TjtzOjM5OiIAcGhwRG9jdW1lbnRvclxSZWZsZWN0aW9uXFBocFxGaWxlAGhhc2giO3M6MzI6ImVlZWZlMTM1NTI2OGQ1ZWQyNzJlMDlmYjJjYzZkNTUxIjtzOjM5OiIAcGhwRG9jdW1lbnRvclxSZWZsZWN0aW9uXFBocFxGaWxlAG5hbWUiO3M6MzY6ImM1MTU4MTE4MDdlYWRhNzJkZjZiMTgyMTVhNzg0OTk4LnBocCI7czozOToiAHBocERvY3VtZW50b3JcUmVmbGVjdGlvblxQaHBcRmlsZQBwYXRoIjtzOjU5OiJ2YXIvY2FjaGUvdGVzdC90d2lnL2M1L2M1MTU4MTE4MDdlYWRhNzJkZjZiMTgyMTVhNzg0OTk4LnBocCI7czo0MToiAHBocERvY3VtZW50b3JcUmVmbGVjdGlvblxQaHBcRmlsZQBzb3VyY2UiO3M6ODk3MTU6Ijw/cGhwCgp1c2UgVHdpZ1xFbnZpcm9ubWVudDsKdXNlIFR3aWdcRXJyb3JcTG9hZGVyRXJyb3I7CnVzZSBUd2lnXEVycm9yXFJ1bnRpbWVFcnJvcjsKdXNlIFR3aWdcRXh0ZW5zaW9uXFNhbmRib3hFeHRlbnNpb247CnVzZSBUd2lnXE1hcmt1cDsKdXNlIFR3aWdcU2FuZGJveFxTZWN1cml0eUVycm9yOwp1c2UgVHdpZ1xTYW5kYm94XFNlY3VyaXR5Tm90QWxsb3dlZFRhZ0Vycm9yOwp1c2UgVHdpZ1xTYW5kYm94XFNlY3VyaXR5Tm90QWxsb3dlZEZpbHRlckVycm9yOwp1c2UgVHdpZ1xTYW5kYm94XFNlY3VyaXR5Tm90QWxsb3dlZEZ1bmN0aW9uRXJyb3I7CnVzZSBUd2lnXFNvdXJjZTsKdXNlIFR3aWdcVGVtcGxhdGU7CgovKiBAV2ViUHJvZmlsZXIvUHJvZmlsZXIvYmFzZV9qcy5odG1sLnR3aWcgKi8KY2xhc3MgX19Ud2lnVGVtcGxhdGVfNDljYjYxNmM3M2FkNGU2OWU5MmUzZDM2MzA2MDU1MGMgZXh0ZW5kcyBUZW1wbGF0ZQp7CiAgICBwcml2YXRlICRzb3VyY2U7CiAgICBwcml2YXRlICRtYWNyb3MgPSBbXTsKCiAgICBwdWJsaWMgZnVuY3Rpb24gX19jb25zdHJ1Y3QoRW52aXJvbm1lbnQgJGVudikKICAgIHsKICAgICAgICBwYXJlbnQ6Ol9fY29uc3RydWN0KCRlbnYpOwoKICAgICAgICAkdGhpcy0+c291cmNlID0gJHRoaXMtPmdldFNvdXJjZUNvbnRleHQoKTsKCiAgICAgICAgJHRoaXMtPnBhcmVudCA9IGZhbHNlOwoKICAgICAgICAkdGhpcy0+YmxvY2tzID0gWwogICAgICAgIF07CiAgICB9CgogICAgcHJvdGVjdGVkIGZ1bmN0aW9uIGRvRGlzcGxheShhcnJheSAkY29udGV4dCwgYXJyYXkgJGJsb2NrcyA9IFtdKQogICAgewogICAgICAgICRtYWNyb3MgPSAkdGhpcy0+bWFjcm9zOwogICAgICAgICRfX2ludGVybmFsXzVhMjdhOGJhMjFjYTc5YjYxOTMyMzc2YjJmYTkyMmQyID0gJHRoaXMtPmV4dGVuc2lvbnNbIlN5bWZvbnlcXEJ1bmRsZVxcV2ViUHJvZmlsZXJCdW5kbGVcXFR3aWdcXFdlYlByb2ZpbGVyRXh0ZW5zaW9uIl07CiAgICAgICAgJF9faW50ZXJuYWxfNWEyN2E4YmEyMWNhNzliNjE5MzIzNzZiMmZhOTIyZDItPmVudGVyKCRfX2ludGVybmFsXzVhMjdhOGJhMjFjYTc5YjYxOTMyMzc2YjJmYTkyMmQyX3Byb2YgPSBuZXcgXFR3aWdcUHJvZmlsZXJcUHJvZmlsZSgkdGhpcy0+Z2V0VGVtcGxhdGVOYW1lKCksICJ0ZW1wbGF0ZSIsICJAV2ViUHJvZmlsZXIvUHJvZmlsZXIvYmFzZV9qcy5odG1sLnR3aWciKSk7CgogICAgICAgICRfX2ludGVybmFsXzZmNDdiYmU5OTgzYWY4MWYxZTc0NTBlOWEzZTM3NjhmID0gJHRoaXMtPmV4dGVuc2lvbnNbIlN5bWZvbnlcXEJyaWRnZVxcVHdpZ1xcRXh0ZW5zaW9uXFxQcm9maWxlckV4dGVuc2lvbiJdOwogICAgICAgICRfX2ludGVybmFsXzZmNDdiYmU5OTgzYWY4MWYxZTc0NTBlOWEzZTM3NjhmLT5lbnRlcigkX19pbnRlcm5hbF82ZjQ3YmJlOTk4M2FmODFmMWU3NDUwZTlhM2UzNzY4Zl9wcm9mID0gbmV3IFxUd2lnXFByb2ZpbGVyXFByb2ZpbGUoJHRoaXMtPmdldFRlbXBsYXRlTmFtZSgpLCAidGVtcGxhdGUiLCAiQFdlYlByb2ZpbGVyL1Byb2ZpbGVyL2Jhc2VfanMuaHRtbC50d2lnIikpOwoKICAgICAgICAvLyBsaW5lIDMKICAgICAgICBlY2hvICI8c2NyaXB0IjsKICAgICAgICBpZiAoKGFycmF5X2tleV9leGlzdHMoImNzcF9zY3JpcHRfbm9uY2UiLCAkY29udGV4dCkgJiYgKGlzc2V0KCRjb250ZXh0WyJjc3Bfc2NyaXB0X25vbmNlIl0pIHx8IGFycmF5X2tleV9leGlzdHMoImNzcF9zY3JpcHRfbm9uY2UiLCAkY29udGV4dCkgPyAkY29udGV4dFsiY3NwX3NjcmlwdF9ub25jZSJdIDogKGZ1bmN0aW9uICgpIHsgdGhyb3cgbmV3IFJ1bnRpbWVFcnJvcignVmFyaWFibGUgImNzcF9zY3JpcHRfbm9uY2UiIGRvZXMgbm90IGV4aXN0LicsIDMsICR0aGlzLT5zb3VyY2UpOyB9KSgpKSkpIHsKICAgICAgICAgICAgZWNobyAiIG5vbmNlPVwiIjsKICAgICAgICAgICAgZWNobyB0d2lnX2VzY2FwZV9maWx0ZXIoJHRoaXMtPmVudiwgKGlzc2V0KCRjb250ZXh0WyJjc3Bfc2NyaXB0X25vbmNlIl0pIHx8IGFycmF5X2tleV9leGlzdHMoImNzcF9zY3JpcHRfbm9uY2UiLCAkY29udGV4dCkgPyAkY29udGV4dFsiY3NwX3NjcmlwdF9ub25jZSJdIDogKGZ1bmN0aW9uICgpIHsgdGhyb3cgbmV3IFJ1bnRpbWVFcnJvcignVmFyaWFibGUgImNzcF9zY3JpcHRfbm9uY2UiIGRvZXMgbm90IGV4aXN0LicsIDMsICR0aGlzLT5zb3VyY2UpOyB9KSgpKSwgImh0bWwiLCBudWxsLCB0cnVlKTsKICAgICAgICAgICAgZWNobyAiXCIiOwogICAgICAgIH0KICAgICAgICBlY2hvICI+Lyo8IVtDREFUQVsqLwogICAgIjsKICAgICAgICAvLyBsaW5lIDcKICAgICAgICBlY2hvICIKaWYgKHR5cGVvZiBTZmpzID09PSAndW5kZWZpbmVkJyB8fCB0eXBlb2YgU2Zqcy5sb2FkVG9vbGJhciA9PT0gJ3VuZGVmaW5lZCcpIHsKICAgIFNmanMgPSAoZnVuY3Rpb24oKSB7CiAgICAgICAgXCJ1c2Ugc3RyaWN0XCI7CgogICAgICAgIGlmICgnY2xhc3NMaXN0JyBpbiBkb2N1bWVudC5kb2N1bWVudEVsZW1lbnQpIHsKICAgICAgICAgICAgdmFyIGhhc0NsYXNzID0gZnVuY3Rpb24gKGVsLCBjc3NDbGFzcykgeyByZXR1cm4gZWwuY2xhc3NMaXN0LmNvbnRhaW5zKGNzc0NsYXNzKTsgfTsKICAgICAgICAgICAgdmFyIHJlbW92ZUNsYXNzID0gZnVuY3Rpb24oZWwsIGNzc0NsYXNzKSB7IGVsLmNsYXNzTGlzdC5yZW1vdmUoY3NzQ2xhc3MpOyB9OwogICAgICAgICAgICB2YXIgYWRkQ2xhc3MgPSBmdW5jdGlvbihlbCwgY3NzQ2xhc3MpIHsgZWwuY2xhc3NMaXN0LmFkZChjc3NDbGFzcyk7IH07CiAgICAgICAgICAgIHZhciB0b2dnbGVDbGFzcyA9IGZ1bmN0aW9uKGVsLCBjc3NDbGFzcykgeyBlbC5jbGFzc0xpc3QudG9nZ2xlKGNzc0NsYXNzKTsgfTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgICB2YXIgaGFzQ2xhc3MgPSBmdW5jdGlvbiAoZWwsIGNzc0NsYXNzKSB7IHJldHVybiBlbC5jbGFzc05hbWUubWF0Y2gobmV3IFJlZ0V4cCgnXFxcXGInICsgY3NzQ2xhc3MgKyAnXFxcXGInKSk7IH07CiAgICAgICAgICAgIHZhciByZW1vdmVDbGFzcyA9IGZ1bmN0aW9uKGVsLCBjc3NDbGFzcykgeyBlbC5jbGFzc05hbWUgPSBlbC5jbGFzc05hbWUucmVwbGFjZShuZXcgUmVnRXhwKCdcXFxcYicgKyBjc3NDbGFzcyArICdcXFxcYicpLCAnICcpOyB9OwogICAgICAgICAgICB2YXIgYWRkQ2xhc3MgPSBmdW5jdGlvbihlbCwgY3NzQ2xhc3MpIHsgaWYgKCFoYXNDbGFzcyhlbCwgY3NzQ2xhc3MpKSB7IGVsLmNsYXNzTmFtZSArPSBcIiBcIiArIGNzc0NsYXNzOyB9IH07CiAgICAgICAgICAgIHZhciB0b2dnbGVDbGFzcyA9IGZ1bmN0aW9uKGVsLCBjc3NDbGFzcykgeyBoYXNDbGFzcyhlbCwgY3NzQ2xhc3MpID8gcmVtb3ZlQ2xhc3MoZWwsIGNzc0NsYXNzKSA6IGFkZENsYXNzKGVsLCBjc3NDbGFzcyk7IH07CiAgICAgICAgfQoKICAgICAgICB2YXIgbm9vcCA9IGZ1bmN0aW9uKCkge307CgogICAgICAgIHZhciBwcm9maWxlclN0b3JhZ2VLZXkgPSAnc3ltZm9ueS9wcm9maWxlci8nOwoKICAgICAgICB2YXIgYWRkRXZlbnRMaXN0ZW5lcjsKCiAgICAgICAgdmFyIGVsID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7CiAgICAgICAgaWYgKCEoJ2FkZEV2ZW50TGlzdGVuZXInIGluIGVsKSkgewogICAgICAgICAgICBhZGRFdmVudExpc3RlbmVyID0gZnVuY3Rpb24gKGVsZW1lbnQsIGV2ZW50TmFtZSwgY2FsbGJhY2spIHsKICAgICAgICAgICAgICAgIGVsZW1lbnQuYXR0YWNoRXZlbnQoJ29uJyArIGV2ZW50TmFtZSwgY2FsbGJhY2spOwogICAgICAgICAgICB9OwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIGFkZEV2ZW50TGlzdGVuZXIgPSBmdW5jdGlvbiAoZWxlbWVudCwgZXZlbnROYW1lLCBjYWxsYmFjaykgewogICAgICAgICAgICAgICAgZWxlbWVudC5hZGRFdmVudExpc3RlbmVyKGV2ZW50TmFtZSwgY2FsbGJhY2ssIGZhbHNlKTsKICAgICAgICAgICAgfTsKICAgICAgICB9CgogICAgICAgIGlmIChuYXZpZ2F0b3IuY2xpcGJvYXJkKSB7CiAgICAgICAgICAgIGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJ1tkYXRhLWNsaXBib2FyZC10ZXh0XScpLmZvckVhY2goZnVuY3Rpb24oZWxlbWVudCkgewogICAgICAgICAgICAgICAgcmVtb3ZlQ2xhc3MoZWxlbWVudCwgJ2hpZGRlbicpOwogICAgICAgICAgICAgICAgZWxlbWVudC5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIGZ1bmN0aW9uKCkgewogICAgICAgICAgICAgICAgICAgIG5hdmlnYXRvci5jbGlwYm9hcmQud3JpdGVUZXh0KGVsZW1lbnQuZ2V0QXR0cmlidXRlKCdkYXRhLWNsaXBib2FyZC10ZXh0JykpOwogICAgICAgICAgICAgICAgfSkKICAgICAgICAgICAgfSk7CiAgICAgICAgfQoKICAgICAgICB2YXIgcmVxdWVzdCA9IGZ1bmN0aW9uKHVybCwgb25TdWNjZXNzLCBvbkVycm9yLCBwYXlsb2FkLCBvcHRpb25zLCB0cmllcykgewogICAgICAgICAgICB2YXIgeGhyID0gd2luZG93LlhNTEh0dHBSZXF1ZXN0ID8gbmV3IFhNTEh0dHBSZXF1ZXN0KCkgOiBuZXcgQWN0aXZlWE9iamVjdCgnTWljcm9zb2Z0LlhNTEhUVFAnKTsKICAgICAgICAgICAgb3B0aW9ucyA9IG9wdGlvbnMgfHwge307CiAgICAgICAgICAgIG9wdGlvbnMucmV0cnkgPSBvcHRpb25zLnJldHJ5IHx8IGZhbHNlOwogICAgICAgICAgICB0cmllcyA9IHRyaWVzIHx8IDE7CiAgICAgICAgICAgIC8qIHRoaXMgZGVsYXlzIGZvciAxMjUsIDM3NSwgNjI1LCA4NzUsIGFuZCAxMDAwLCAuLi4gKi8KICAgICAgICAgICAgdmFyIGRlbGF5ID0gdHJpZXMgPCA1ID8gKHRyaWVzIC0gMC41KSAqIDI1MCA6IDEwMDA7CgogICAgICAgICAgICB4aHIub3BlbihvcHRpb25zLm1ldGhvZCB8fCAnR0VUJywgdXJsLCB0cnVlKTsKICAgICAgICAgICAgeGhyLnNldFJlcXVlc3RIZWFkZXIoJ1gtUmVxdWVzdGVkLVdpdGgnLCAnWE1MSHR0cFJlcXVlc3QnKTsKICAgICAgICAgICAgeGhyLm9ucmVhZHlzdGF0ZWNoYW5nZSA9IGZ1bmN0aW9uKHN0YXRlKSB7CiAgICAgICAgICAgICAgICBpZiAoNCAhPT0geGhyLnJlYWR5U3RhdGUpIHsKICAgICAgICAgICAgICAgICAgICByZXR1cm4gbnVsbDsKICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICBpZiAoeGhyLnN0YXR1cyA9PSA0MDQgJiYgb3B0aW9ucy5yZXRyeSAmJiAhb3B0aW9ucy5zdG9wKSB7CiAgICAgICAgICAgICAgICAgICAgc2V0VGltZW91dChmdW5jdGlvbigpIHsKICAgICAgICAgICAgICAgICAgICAgICAgaWYgKG9wdGlvbnMuc3RvcCkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuOwogICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgIHJlcXVlc3QodXJsLCBvblN1Y2Nlc3MsIG9uRXJyb3IsIHBheWxvYWQsIG9wdGlvbnMsIHRyaWVzICsgMSk7CiAgICAgICAgICAgICAgICAgICAgfSwgZGVsYXkpOwoKICAgICAgICAgICAgICAgICAgICByZXR1cm4gbnVsbDsKICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICBpZiAoMjAwID09PSB4aHIuc3RhdHVzKSB7CiAgICAgICAgICAgICAgICAgICAgKG9uU3VjY2VzcyB8fCBub29wKSh4aHIpOwogICAgICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgICAgICAob25FcnJvciB8fCBub29wKSh4aHIpOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9OwoKICAgICAgICAgICAgaWYgKG9wdGlvbnMub25TZW5kKSB7CiAgICAgICAgICAgICAgICBvcHRpb25zLm9uU2VuZCh0cmllcyk7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIHhoci5zZW5kKHBheWxvYWQgfHwgJycpOwogICAgICAgIH07CgogICAgICAgIHZhciBnZXRQcmVmZXJlbmNlID0gZnVuY3Rpb24obmFtZSkgewogICAgICAgICAgICBpZiAoIXdpbmRvdy5sb2NhbFN0b3JhZ2UpIHsKICAgICAgICAgICAgICAgIHJldHVybiBudWxsOwogICAgICAgICAgICB9CgogICAgICAgICAgICByZXR1cm4gbG9jYWxTdG9yYWdlLmdldEl0ZW0ocHJvZmlsZXJTdG9yYWdlS2V5ICsgbmFtZSk7CiAgICAgICAgfTsKCiAgICAgICAgdmFyIHNldFByZWZlcmVuY2UgPSBmdW5jdGlvbihuYW1lLCB2YWx1ZSkgewogICAgICAgICAgICBpZiAoIXdpbmRvdy5sb2NhbFN0b3JhZ2UpIHsKICAgICAgICAgICAgICAgIHJldHVybiBudWxsOwogICAgICAgICAgICB9CgogICAgICAgICAgICBsb2NhbFN0b3JhZ2Uuc2V0SXRlbShwcm9maWxlclN0b3JhZ2VLZXkgKyBuYW1lLCB2YWx1ZSk7CiAgICAgICAgfTsKCiAgICAgICAgdmFyIHJlcXVlc3RTdGFjayA9IFtdOwoKICAgICAgICB2YXIgZXh0cmFjdEhlYWRlcnMgPSBmdW5jdGlvbih4aHIsIHN0YWNrRWxlbWVudCkgewogICAgICAgICAgICAvKiBIZXJlIHdlIGF2b2lkIHRvIGNhbGwgeGhyLmdldFJlc3BvbnNlSGVhZGVyIGluIG9yZGVyIHRvICovCiAgICAgICAgICAgIC8qIHByZXZlbnQgcG9sbHV0aW5nIHRoZSBjb25zb2xlIHdpdGggQ09SUyBzZWN1cml0eSBlcnJvcnMgKi8KICAgICAgICAgICAgdmFyIGFsbEhlYWRlcnMgPSB4aHIuZ2V0QWxsUmVzcG9uc2VIZWFkZXJzKCk7CiAgICAgICAgICAgIHZhciByZXQ7CgogICAgICAgICAgICBpZiAocmV0ID0gYWxsSGVhZGVycy5tYXRjaCgvXngtZGVidWctdG9rZW46XFxzKyguKilcJC9pbSkpIHsKICAgICAgICAgICAgICAgIHN0YWNrRWxlbWVudC5wcm9maWxlID0gcmV0WzFdOwogICAgICAgICAgICB9CiAgICAgICAgICAgIGlmIChyZXQgPSBhbGxIZWFkZXJzLm1hdGNoKC9eeC1kZWJ1Zy10b2tlbi1saW5rOlxccysoLiopXCQvaW0pKSB7CiAgICAgICAgICAgICAgICBzdGFja0VsZW1lbnQucHJvZmlsZXJVcmwgPSByZXRbMV07CiAgICAgICAgICAgIH0KICAgICAgICAgICAgaWYgKHJldCA9IGFsbEhlYWRlcnMubWF0Y2goL15TeW1mb255LURlYnVnLVRvb2xiYXItUmVwbGFjZTpcXHMrKC4qKVwkL2ltKSkgewogICAgICAgICAgICAgICAgc3RhY2tFbGVtZW50LnRvb2xiYXJSZXBsYWNlRmluaXNoZWQgPSBmYWxzZTsKICAgICAgICAgICAgICAgIHN0YWNrRWxlbWVudC50b29sYmFyUmVwbGFjZSA9ICcxJyA9PT0gcmV0WzFdOwogICAgICAgICAgICB9CiAgICAgICAgfTsKCiAgICAgICAgdmFyIHN1Y2Nlc3NTdHJlYWsgPSA0OwogICAgICAgIHZhciBwZW5kaW5nUmVxdWVzdHMgPSAwOwogICAgICAgIHZhciByZW5kZXJBamF4UmVxdWVzdHMgPSBmdW5jdGlvbigpIHsKICAgICAgICAgICAgdmFyIHJlcXVlc3RDb3VudGVyID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLnNmLXRvb2xiYXItYWpheC1yZXF1ZXN0LWNvdW50ZXInKTsKICAgICAgICAgICAgaWYgKCFyZXF1ZXN0Q291bnRlcikgewogICAgICAgICAgICAgICAgcmV0dXJuOwogICAgICAgICAgICB9CiAgICAgICAgICAgIHJlcXVlc3RDb3VudGVyLnRleHRDb250ZW50ID0gcmVxdWVzdFN0YWNrLmxlbmd0aDsKCiAgICAgICAgICAgIHZhciBpbmZvU3BhbiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuc2YtdG9vbGJhci1hamF4LWluZm9cIik7CiAgICAgICAgICAgIGlmIChpbmZvU3BhbikgewogICAgICAgICAgICAgICAgaW5mb1NwYW4udGV4dENvbnRlbnQgPSByZXF1ZXN0U3RhY2subGVuZ3RoICsgJyBBSkFYIHJlcXVlc3QnICsgKHJlcXVlc3RTdGFjay5sZW5ndGggIT09IDEgPyAncycgOiAnJyk7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIHZhciBhamF4VG9vbGJhclBhbmVsID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLnNmLXRvb2xiYXItYmxvY2stYWpheCcpOwogICAgICAgICAgICBpZiAocmVxdWVzdFN0YWNrLmxlbmd0aCkgewogICAgICAgICAgICAgICAgYWpheFRvb2xiYXJQYW5lbC5zdHlsZS5kaXNwbGF5ID0gJ2Jsb2NrJzsKICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgIGFqYXhUb29sYmFyUGFuZWwuc3R5bGUuZGlzcGxheSA9ICdub25lJzsKICAgICAgICAgICAgfQogICAgICAgICAgICBpZiAocGVuZGluZ1JlcXVlc3RzID4gMCkgewogICAgICAgICAgICAgICAgYWRkQ2xhc3MoYWpheFRvb2xiYXJQYW5lbCwgJ3NmLWFqYXgtcmVxdWVzdC1sb2FkaW5nJyk7CiAgICAgICAgICAgIH0gZWxzZSBpZiAoc3VjY2Vzc1N0cmVhayA8IDQpIHsKICAgICAgICAgICAgICAgIGFkZENsYXNzKGFqYXhUb29sYmFyUGFuZWwsICdzZi10b29sYmFyLXN0YXR1cy1yZWQnKTsKICAgICAgICAgICAgICAgIHJlbW92ZUNsYXNzKGFqYXhUb29sYmFyUGFuZWwsICdzZi1hamF4LXJlcXVlc3QtbG9hZGluZycpOwogICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgcmVtb3ZlQ2xhc3MoYWpheFRvb2xiYXJQYW5lbCwgJ3NmLWFqYXgtcmVxdWVzdC1sb2FkaW5nJyk7CiAgICAgICAgICAgICAgICByZW1vdmVDbGFzcyhhamF4VG9vbGJhclBhbmVsLCAnc2YtdG9vbGJhci1zdGF0dXMtcmVkJyk7CiAgICAgICAgICAgIH0KICAgICAgICB9OwoKICAgICAgICB2YXIgc3RhcnRBamF4UmVxdWVzdCA9IGZ1bmN0aW9uKGluZGV4KSB7CiAgICAgICAgICAgIHZhciB0Ym9keSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5zZi10b29sYmFyLWFqYXgtcmVxdWVzdC1saXN0Jyk7CiAgICAgICAgICAgIGlmICghdGJvZHkpIHsKICAgICAgICAgICAgICAgIHJldHVybjsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgdmFyIG5iT2ZBamF4UmVxdWVzdCA9IHRib2R5LnJvd3MubGVuZ3RoOwogICAgICAgICAgICBpZiAobmJPZkFqYXhSZXF1ZXN0ID49IDEwMCkgewogICAgICAgICAgICAgICAgdGJvZHkuZGVsZXRlUm93KDApOwogICAgICAgICAgICB9CgogICAgICAgICAgICB2YXIgcmVxdWVzdCA9IHJlcXVlc3RTdGFja1tpbmRleF07CiAgICAgICAgICAgIHBlbmRpbmdSZXF1ZXN0cysrOwogICAgICAgICAgICB2YXIgcm93ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgndHInKTsKICAgICAgICAgICAgcmVxdWVzdC5ET01Ob2RlID0gcm93OwoKICAgICAgICAgICAgdmFyIHJlcXVlc3ROdW1iZXJDZWxsID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgndGQnKTsKICAgICAgICAgICAgcmVxdWVzdE51bWJlckNlbGwudGV4dENvbnRlbnQgPSBpbmRleCArIDE7CiAgICAgICAgICAgIHJvdy5hcHBlbmRDaGlsZChyZXF1ZXN0TnVtYmVyQ2VsbCk7CgogICAgICAgICAgICB2YXIgcHJvZmlsZXJDZWxsID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgndGQnKTsKICAgICAgICAgICAgcHJvZmlsZXJDZWxsLnRleHRDb250ZW50ID0gJ24vYSc7CiAgICAgICAgICAgIHJvdy5hcHBlbmRDaGlsZChwcm9maWxlckNlbGwpOwoKICAgICAgICAgICAgdmFyIG1ldGhvZENlbGwgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCd0ZCcpOwogICAgICAgICAgICBtZXRob2RDZWxsLnRleHRDb250ZW50ID0gcmVxdWVzdC5tZXRob2Q7CiAgICAgICAgICAgIHJvdy5hcHBlbmRDaGlsZChtZXRob2RDZWxsKTsKCiAgICAgICAgICAgIHZhciB0eXBlQ2VsbCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3RkJyk7CiAgICAgICAgICAgIHR5cGVDZWxsLnRleHRDb250ZW50ID0gcmVxdWVzdC50eXBlOwogICAgICAgICAgICByb3cuYXBwZW5kQ2hpbGQodHlwZUNlbGwpOwoKICAgICAgICAgICAgdmFyIHN0YXR1c0NvZGVDZWxsID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgndGQnKTsKICAgICAgICAgICAgdmFyIHN0YXR1c0NvZGUgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdzcGFuJyk7CiAgICAgICAgICAgIHN0YXR1c0NvZGUudGV4dENvbnRlbnQgPSAnbi9hJzsKICAgICAgICAgICAgc3RhdHVzQ29kZUNlbGwuYXBwZW5kQ2hpbGQoc3RhdHVzQ29kZSk7CiAgICAgICAgICAgIHJvdy5hcHBlbmRDaGlsZChzdGF0dXNDb2RlQ2VsbCk7CgogICAgICAgICAgICB2YXIgcGF0aENlbGwgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCd0ZCcpOwogICAgICAgICAgICBwYXRoQ2VsbC5jbGFzc05hbWUgPSAnc2YtYWpheC1yZXF1ZXN0LXVybCc7CiAgICAgICAgICAgIGlmICgnR0VUJyA9PT0gcmVxdWVzdC5tZXRob2QpIHsKICAgICAgICAgICAgICAgIHZhciBwYXRoTGluayA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2EnKTsKICAgICAgICAgICAgICAgIHBhdGhMaW5rLnNldEF0dHJpYnV0ZSgnaHJlZicsIHJlcXVlc3QudXJsKTsKICAgICAgICAgICAgICAgIHBhdGhMaW5rLnRleHRDb250ZW50ID0gcmVxdWVzdC51cmw7CiAgICAgICAgICAgICAgICBwYXRoQ2VsbC5hcHBlbmRDaGlsZChwYXRoTGluayk7CiAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICBwYXRoQ2VsbC50ZXh0Q29udGVudCA9IHJlcXVlc3QudXJsOwogICAgICAgICAgICB9CiAgICAgICAgICAgIHBhdGhDZWxsLnNldEF0dHJpYnV0ZSgndGl0bGUnLCByZXF1ZXN0LnVybCk7CiAgICAgICAgICAgIHJvdy5hcHBlbmRDaGlsZChwYXRoQ2VsbCk7CgogICAgICAgICAgICB2YXIgZHVyYXRpb25DZWxsID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgndGQnKTsKICAgICAgICAgICAgZHVyYXRpb25DZWxsLmNsYXNzTmFtZSA9ICdzZi1hamF4LXJlcXVlc3QtZHVyYXRpb24nOwogICAgICAgICAgICBkdXJhdGlvbkNlbGwudGV4dENvbnRlbnQgPSAnbi9hJzsKICAgICAgICAgICAgcm93LmFwcGVuZENoaWxkKGR1cmF0aW9uQ2VsbCk7CgogICAgICAgICAgICByZXF1ZXN0LmxpdmVEdXJhdGlvbkhhbmRsZSA9IHNldEludGVydmFsKGZ1bmN0aW9uKCkgewogICAgICAgICAgICAgICAgZHVyYXRpb25DZWxsLnRleHRDb250ZW50ID0gKG5ldyBEYXRlKCkgLSByZXF1ZXN0LnN0YXJ0KSArICcgbXMnOwogICAgICAgICAgICB9LCAxMDApOwoKICAgICAgICAgICAgcm93LmNsYXNzTmFtZSA9ICdzZi1hamF4LXJlcXVlc3Qgc2YtYWpheC1yZXF1ZXN0LWxvYWRpbmcnOwogICAgICAgICAgICB0Ym9keS5pbnNlcnRCZWZvcmUocm93LCBudWxsKTsKCiAgICAgICAgICAgIHZhciB0b29sYmFySW5mbyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5zZi10b29sYmFyLWJsb2NrLWFqYXggLnNmLXRvb2xiYXItaW5mbycpOwogICAgICAgICAgICB0b29sYmFySW5mby5zY3JvbGxUb3AgPSB0b29sYmFySW5mby5zY3JvbGxIZWlnaHQ7CgogICAgICAgICAgICByZW5kZXJBamF4UmVxdWVzdHMoKTsKICAgICAgICB9OwoKICAgICAgICB2YXIgZmluaXNoQWpheFJlcXVlc3QgPSBmdW5jdGlvbihpbmRleCkgewogICAgICAgICAgICB2YXIgcmVxdWVzdCA9IHJlcXVlc3RTdGFja1tpbmRleF07CiAgICAgICAgICAgIGNsZWFySW50ZXJ2YWwocmVxdWVzdC5saXZlRHVyYXRpb25IYW5kbGUpOwoKICAgICAgICAgICAgaWYgKCFyZXF1ZXN0LkRPTU5vZGUpIHsKICAgICAgICAgICAgICAgIHJldHVybjsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgaWYgKHJlcXVlc3QudG9vbGJhclJlcGxhY2UgJiYgIXJlcXVlc3QudG9vbGJhclJlcGxhY2VGaW5pc2hlZCAmJiByZXF1ZXN0LnByb2ZpbGUpIHsKICAgICAgICAgICAgICAgIC8qIEZsYWcgYXMgY29tcGxldGUgYmVjYXVzZSBmaW5pc2hBamF4UmVxdWVzdCBjYW4gYmUgY2FsbGVkIG11bHRpcGxlIHRpbWVzLiAqLwogICAgICAgICAgICAgICAgcmVxdWVzdC50b29sYmFyUmVwbGFjZUZpbmlzaGVkID0gdHJ1ZTsKICAgICAgICAgICAgICAgIC8qIFNlYXJjaCB1cCB0aHJvdWdoIHRoZSBET00gdG8gZmluZCB0aGUgdG9vbGJhcidzIGNvbnRhaW5lciBJRC4gKi8KICAgICAgICAgICAgICAgIGZvciAodmFyIGVsZW0gPSByZXF1ZXN0LkRPTU5vZGU7IGVsZW0gJiYgZWxlbSAhPT0gZG9jdW1lbnQ7IGVsZW0gPSBlbGVtLnBhcmVudE5vZGUpIHsKICAgICAgICAgICAgICAgICAgICBpZiAoZWxlbS5pZC5tYXRjaCgvXnNmd2R0LykpIHsKICAgICAgICAgICAgICAgICAgICAgICAgU2Zqcy5sb2FkVG9vbGJhcihlbGVtLmlkLnJlcGxhY2UoL15zZndkdC8sICcnKSwgcmVxdWVzdC5wcm9maWxlKTsKICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CgogICAgICAgICAgICBwZW5kaW5nUmVxdWVzdHMtLTsKICAgICAgICAgICAgdmFyIHJvdyA9IHJlcXVlc3QuRE9NTm9kZTsKICAgICAgICAgICAgLyogVW5wYWNrIHRoZSBjaGlsZHJlbiBmcm9tIHRoZSByb3cgKi8KICAgICAgICAgICAgdmFyIHByb2ZpbGVyQ2VsbCA9IHJvdy5jaGlsZHJlblsxXTsKICAgICAgICAgICAgdmFyIG1ldGhvZENlbGwgPSByb3cuY2hpbGRyZW5bMl07CiAgICAgICAgICAgIHZhciBzdGF0dXNDb2RlQ2VsbCA9IHJvdy5jaGlsZHJlbls0XTsKICAgICAgICAgICAgdmFyIHN0YXR1c0NvZGVFbGVtID0gc3RhdHVzQ29kZUNlbGwuY2hpbGRyZW5bMF07CiAgICAgICAgICAgIHZhciBkdXJhdGlvbkNlbGwgPSByb3cuY2hpbGRyZW5bNl07CgogICAgICAgICAgICBpZiAocmVxdWVzdC5lcnJvcikgewogICAgICAgICAgICAgICAgcm93LmNsYXNzTmFtZSA9ICdzZi1hamF4LXJlcXVlc3Qgc2YtYWpheC1yZXF1ZXN0LWVycm9yJzsKICAgICAgICAgICAgICAgIG1ldGhvZENlbGwuY2xhc3NOYW1lID0gJ3NmLWFqYXgtcmVxdWVzdC1lcnJvcic7CiAgICAgICAgICAgICAgICBzdWNjZXNzU3RyZWFrID0gMDsKICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgIHJvdy5jbGFzc05hbWUgPSAnc2YtYWpheC1yZXF1ZXN0IHNmLWFqYXgtcmVxdWVzdC1vayc7CiAgICAgICAgICAgICAgICBzdWNjZXNzU3RyZWFrKys7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIGlmIChyZXF1ZXN0LnN0YXR1c0NvZGUpIHsKICAgICAgICAgICAgICAgIGlmIChyZXF1ZXN0LnN0YXR1c0NvZGUgPCAzMDApIHsKICAgICAgICAgICAgICAgICAgICBzdGF0dXNDb2RlRWxlbS5zZXRBdHRyaWJ1dGUoJ2NsYXNzJywgJ3NmLXRvb2xiYXItc3RhdHVzJyk7CiAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKHJlcXVlc3Quc3RhdHVzQ29kZSA8IDQwMCkgewogICAgICAgICAgICAgICAgICAgIHN0YXR1c0NvZGVFbGVtLnNldEF0dHJpYnV0ZSgnY2xhc3MnLCAnc2YtdG9vbGJhci1zdGF0dXMgc2YtdG9vbGJhci1zdGF0dXMteWVsbG93Jyk7CiAgICAgICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgICAgIHN0YXR1c0NvZGVFbGVtLnNldEF0dHJpYnV0ZSgnY2xhc3MnLCAnc2YtdG9vbGJhci1zdGF0dXMgc2YtdG9vbGJhci1zdGF0dXMtcmVkJyk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICBzdGF0dXNDb2RlRWxlbS50ZXh0Q29udGVudCA9IHJlcXVlc3Quc3RhdHVzQ29kZTsKICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgIHN0YXR1c0NvZGVFbGVtLnNldEF0dHJpYnV0ZSgnY2xhc3MnLCAnc2YtdG9vbGJhci1zdGF0dXMgc2YtdG9vbGJhci1zdGF0dXMtcmVkJyk7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIGlmIChyZXF1ZXN0LmR1cmF0aW9uKSB7CiAgICAgICAgICAgICAgICBkdXJhdGlvbkNlbGwudGV4dENvbnRlbnQgPSByZXF1ZXN0LmR1cmF0aW9uICsgJyBtcyc7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIGlmIChyZXF1ZXN0LnByb2ZpbGVyVXJsKSB7CiAgICAgICAgICAgICAgICBwcm9maWxlckNlbGwudGV4dENvbnRlbnQgPSAnJzsKICAgICAgICAgICAgICAgIHZhciBwcm9maWxlckxpbmsgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdhJyk7CiAgICAgICAgICAgICAgICBwcm9maWxlckxpbmsuc2V0QXR0cmlidXRlKCdocmVmJywgcmVxdWVzdC5wcm9maWxlclVybCk7CiAgICAgICAgICAgICAgICBwcm9maWxlckxpbmsudGV4dENvbnRlbnQgPSByZXF1ZXN0LnByb2ZpbGU7CiAgICAgICAgICAgICAgICBwcm9maWxlckNlbGwuYXBwZW5kQ2hpbGQocHJvZmlsZXJMaW5rKTsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgcmVuZGVyQWpheFJlcXVlc3RzKCk7CiAgICAgICAgfTsKCiAgICAgICAgIjsKICAgICAgICAvLyBsaW5lIDI5MgogICAgICAgIGlmIChhcnJheV9rZXlfZXhpc3RzKCJleGNsdWRlZF9hamF4X3BhdGhzIiwgJGNvbnRleHQpKSB7CiAgICAgICAgICAgIC8vIGxpbmUgMjkzCiAgICAgICAgICAgIGVjaG8gIiAgICAgICAgICAgIGlmICh3aW5kb3cuZmV0Y2ggJiYgd2luZG93LmZldGNoLnBvbHlmaWxsID09PSB1bmRlZmluZWQpIHsKICAgICAgICAgICAgICAgIHZhciBvbGRGZXRjaCA9IHdpbmRvdy5mZXRjaDsKICAgICAgICAgICAgICAgIHdpbmRvdy5mZXRjaCA9IGZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgICAgICAgICB2YXIgcHJvbWlzZSA9IG9sZEZldGNoLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7CiAgICAgICAgICAgICAgICAgICAgdmFyIHVybCA9IGFyZ3VtZW50c1swXTsKICAgICAgICAgICAgICAgICAgICB2YXIgcGFyYW1zID0gYXJndW1lbnRzWzFdOwogICAgICAgICAgICAgICAgICAgIHZhciBwYXJhbVR5cGUgPSBPYmplY3QucHJvdG90eXBlLnRvU3RyaW5nLmNhbGwoYXJndW1lbnRzWzBdKTsKICAgICAgICAgICAgICAgICAgICBpZiAocGFyYW1UeXBlID09PSAnW29iamVjdCBSZXF1ZXN0XScpIHsKICAgICAgICAgICAgICAgICAgICAgICAgdXJsID0gYXJndW1lbnRzWzBdLnVybDsKICAgICAgICAgICAgICAgICAgICAgICAgcGFyYW1zID0gewogICAgICAgICAgICAgICAgICAgICAgICAgICAgbWV0aG9kOiBhcmd1bWVudHNbMF0ubWV0aG9kLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgY3JlZGVudGlhbHM6IGFyZ3VtZW50c1swXS5jcmVkZW50aWFscywKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGhlYWRlcnM6IGFyZ3VtZW50c1swXS5oZWFkZXJzLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgbW9kZTogYXJndW1lbnRzWzBdLm1vZGUsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZWRpcmVjdDogYXJndW1lbnRzWzBdLnJlZGlyZWN0CiAgICAgICAgICAgICAgICAgICAgICAgIH07CiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgICAgICAgICAgdXJsID0gU3RyaW5nKHVybCk7CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIGlmICghdXJsLm1hdGNoKG5ldyBSZWdFeHAoIjsKICAgICAgICAgICAgLy8gbGluZSAzMTIKICAgICAgICAgICAgZWNobyBqc29uX2VuY29kZSgoaXNzZXQoJGNvbnRleHRbImV4Y2x1ZGVkX2FqYXhfcGF0aHMiXSkgfHwgYXJyYXlfa2V5X2V4aXN0cygiZXhjbHVkZWRfYWpheF9wYXRocyIsICRjb250ZXh0KSA/ICRjb250ZXh0WyJleGNsdWRlZF9hamF4X3BhdGhzIl0gOiAoZnVuY3Rpb24gKCkgeyB0aHJvdyBuZXcgUnVudGltZUVycm9yKCdWYXJpYWJsZSAiZXhjbHVkZWRfYWpheF9wYXRocyIgZG9lcyBub3QgZXhpc3QuJywgMzEyLCAkdGhpcy0+c291cmNlKTsgfSkoKSkpOwogICAgICAgICAgICBlY2hvICIpKSkgewogICAgICAgICAgICAgICAgICAgICAgICB2YXIgbWV0aG9kID0gJ0dFVCc7CiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChwYXJhbXMgJiYgcGFyYW1zLm1ldGhvZCAhPT0gdW5kZWZpbmVkKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBtZXRob2QgPSBwYXJhbXMubWV0aG9kOwogICAgICAgICAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgICAgICAgICB2YXIgc3RhY2tFbGVtZW50ID0gewogICAgICAgICAgICAgICAgICAgICAgICAgICAgZXJyb3I6IGZhbHNlLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgdXJsOiB1cmwsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBtZXRob2Q6IG1ldGhvZCwKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHR5cGU6ICdmZXRjaCcsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdGFydDogbmV3IERhdGUoKQogICAgICAgICAgICAgICAgICAgICAgICB9OwoKICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGlkeCA9IHJlcXVlc3RTdGFjay5wdXNoKHN0YWNrRWxlbWVudCkgLSAxOwogICAgICAgICAgICAgICAgICAgICAgICBwcm9taXNlLnRoZW4oZnVuY3Rpb24gKHIpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN0YWNrRWxlbWVudC5kdXJhdGlvbiA9IG5ldyBEYXRlKCkgLSBzdGFja0VsZW1lbnQuc3RhcnQ7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdGFja0VsZW1lbnQuZXJyb3IgPSByLnN0YXR1cyA8IDIwMCB8fCByLnN0YXR1cyA+PSA0MDA7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdGFja0VsZW1lbnQuc3RhdHVzQ29kZSA9IHIuc3RhdHVzOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgc3RhY2tFbGVtZW50LnByb2ZpbGUgPSByLmhlYWRlcnMuZ2V0KCd4LWRlYnVnLXRva2VuJyk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdGFja0VsZW1lbnQucHJvZmlsZXJVcmwgPSByLmhlYWRlcnMuZ2V0KCd4LWRlYnVnLXRva2VuLWxpbmsnKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN0YWNrRWxlbWVudC50b29sYmFyUmVwbGFjZUZpbmlzaGVkID0gZmFsc2U7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdGFja0VsZW1lbnQudG9vbGJhclJlcGxhY2UgPSAnMScgPT09IHIuaGVhZGVycy5nZXQoJ1N5bWZvbnktRGVidWctVG9vbGJhci1SZXBsYWNlJyk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBmaW5pc2hBamF4UmVxdWVzdChpZHgpOwogICAgICAgICAgICAgICAgICAgICAgICB9LCBmdW5jdGlvbiAoZSl7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdGFja0VsZW1lbnQuZXJyb3IgPSB0cnVlOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgZmluaXNoQWpheFJlcXVlc3QoaWR4KTsKICAgICAgICAgICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgICAgICAgICAgIHN0YXJ0QWpheFJlcXVlc3QoaWR4KTsKICAgICAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgICAgIHJldHVybiBwcm9taXNlOwogICAgICAgICAgICAgICAgfTsKICAgICAgICAgICAgfQogICAgICAgICAgICBpZiAod2luZG93LlhNTEh0dHBSZXF1ZXN0ICYmIFhNTEh0dHBSZXF1ZXN0LnByb3RvdHlwZS5hZGRFdmVudExpc3RlbmVyKSB7CiAgICAgICAgICAgICAgICB2YXIgcHJveGllZCA9IFhNTEh0dHBSZXF1ZXN0LnByb3RvdHlwZS5vcGVuOwoKICAgICAgICAgICAgICAgIFhNTEh0dHBSZXF1ZXN0LnByb3RvdHlwZS5vcGVuID0gZnVuY3Rpb24obWV0aG9kLCB1cmwsIGFzeW5jLCB1c2VyLCBwYXNzKSB7CiAgICAgICAgICAgICAgICAgICAgdmFyIHNlbGYgPSB0aGlzOwoKICAgICAgICAgICAgICAgICAgICAvKiBwcmV2ZW50IGxvZ2dpbmcgQUpBWCBjYWxscyB0byBzdGF0aWMgYW5kIGlubGluZSBmaWxlcywgbGlrZSB0ZW1wbGF0ZXMgKi8KICAgICAgICAgICAgICAgICAgICB2YXIgcGF0aCA9IHVybDsKICAgICAgICAgICAgICAgICAgICBpZiAodXJsLnNsaWNlKDAsIDEpID09PSAnLycpIHsKICAgICAgICAgICAgICAgICAgICAgICAgaWYgKDAgPT09IHVybC5pbmRleE9mKCciOwogICAgICAgICAgICAvLyBsaW5lIDM1NQogICAgICAgICAgICBlY2hvIHR3aWdfZXNjYXBlX2ZpbHRlcigkdGhpcy0+ZW52LCB0d2lnX2VzY2FwZV9maWx0ZXIoJHRoaXMtPmVudiwgdHdpZ19nZXRfYXR0cmlidXRlKCR0aGlzLT5lbnYsICR0aGlzLT5zb3VyY2UsIChpc3NldCgkY29udGV4dFsicmVxdWVzdCJdKSB8fCBhcnJheV9rZXlfZXhpc3RzKCJyZXF1ZXN0IiwgJGNvbnRleHQpID8gJGNvbnRleHRbInJlcXVlc3QiXSA6IChmdW5jdGlvbiAoKSB7IHRocm93IG5ldyBSdW50aW1lRXJyb3IoJ1ZhcmlhYmxlICJyZXF1ZXN0IiBkb2VzIG5vdCBleGlzdC4nLCAzNTUsICR0aGlzLT5zb3VyY2UpOyB9KSgpKSwgImJhc2VQYXRoIiwgW10sICJhbnkiLCBmYWxzZSwgZmFsc2UsIGZhbHNlLCAzNTUpLCAianMiKSwgImh0bWwiLCBudWxsLCB0cnVlKTsKICAgICAgICAgICAgZWNobyAiJykpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBhdGggPSB1cmwuc2xpY2UoIjsKICAgICAgICAgICAgLy8gbGluZSAzNTYKICAgICAgICAgICAgZWNobyB0d2lnX2VzY2FwZV9maWx0ZXIoJHRoaXMtPmVudiwgdHdpZ19sZW5ndGhfZmlsdGVyKCR0aGlzLT5lbnYsIHR3aWdfZ2V0X2F0dHJpYnV0ZSgkdGhpcy0+ZW52LCAkdGhpcy0+c291cmNlLCAoaXNzZXQoJGNvbnRleHRbInJlcXVlc3QiXSkgfHwgYXJyYXlfa2V5X2V4aXN0cygicmVxdWVzdCIsICRjb250ZXh0KSA/ICRjb250ZXh0WyJyZXF1ZXN0Il0gOiAoZnVuY3Rpb24gKCkgeyB0aHJvdyBuZXcgUnVudGltZUVycm9yKCdWYXJpYWJsZSAicmVxdWVzdCIgZG9lcyBub3QgZXhpc3QuJywgMzU2LCAkdGhpcy0+c291cmNlKTsgfSkoKSksICJiYXNlUGF0aCIsIFtdLCAiYW55IiwgZmFsc2UsIGZhbHNlLCBmYWxzZSwgMzU2KSksICJodG1sIiwgbnVsbCwgdHJ1ZSk7CiAgICAgICAgICAgIGVjaG8gIik7CiAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgZWxzZSBpZiAoMCA9PT0gdXJsLmluZGV4T2YoJyI7CiAgICAgICAgICAgIC8vIGxpbmUgMzU5CiAgICAgICAgICAgIGVjaG8gdHdpZ19lc2NhcGVfZmlsdGVyKCR0aGlzLT5lbnYsIHR3aWdfZXNjYXBlX2ZpbHRlcigkdGhpcy0+ZW52LCAodHdpZ19nZXRfYXR0cmlidXRlKCR0aGlzLT5lbnYsICR0aGlzLT5zb3VyY2UsIChpc3NldCgkY29udGV4dFsicmVxdWVzdCJdKSB8fCBhcnJheV9rZXlfZXhpc3RzKCJyZXF1ZXN0IiwgJGNvbnRleHQpID8gJGNvbnRleHRbInJlcXVlc3QiXSA6IChmdW5jdGlvbiAoKSB7IHRocm93IG5ldyBSdW50aW1lRXJyb3IoJ1ZhcmlhYmxlICJyZXF1ZXN0IiBkb2VzIG5vdCBleGlzdC4nLCAzNTksICR0aGlzLT5zb3VyY2UpOyB9KSgpKSwgInNjaGVtZUFuZEh0dHBIb3N0IiwgW10sICJhbnkiLCBmYWxzZSwgZmFsc2UsIGZhbHNlLCAzNTkpIC4gdHdpZ19nZXRfYXR0cmlidXRlKCR0aGlzLT5lbnYsICR0aGlzLT5zb3VyY2UsIChpc3NldCgkY29udGV4dFsicmVxdWVzdCJdKSB8fCBhcnJheV9rZXlfZXhpc3RzKCJyZXF1ZXN0IiwgJGNvbnRleHQpID8gJGNvbnRleHRbInJlcXVlc3QiXSA6IChmdW5jdGlvbiAoKSB7IHRocm93IG5ldyBSdW50aW1lRXJyb3IoJ1ZhcmlhYmxlICJyZXF1ZXN0IiBkb2VzIG5vdCBleGlzdC4nLCAzNTksICR0aGlzLT5zb3VyY2UpOyB9KSgpKSwgImJhc2VQYXRoIiwgW10sICJhbnkiLCBmYWxzZSwgZmFsc2UsIGZhbHNlLCAzNTkpKSwgImpzIiksICJodG1sIiwgbnVsbCwgdHJ1ZSk7CiAgICAgICAgICAgIGVjaG8gIicpKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIHBhdGggPSB1cmwuc2xpY2UoIjsKICAgICAgICAgICAgLy8gbGluZSAzNjAKICAgICAgICAgICAgZWNobyB0d2lnX2VzY2FwZV9maWx0ZXIoJHRoaXMtPmVudiwgdHdpZ19sZW5ndGhfZmlsdGVyKCR0aGlzLT5lbnYsICh0d2lnX2dldF9hdHRyaWJ1dGUoJHRoaXMtPmVudiwgJHRoaXMtPnNvdXJjZSwgKGlzc2V0KCRjb250ZXh0WyJyZXF1ZXN0Il0pIHx8IGFycmF5X2tleV9leGlzdHMoInJlcXVlc3QiLCAkY29udGV4dCkgPyAkY29udGV4dFsicmVxdWVzdCJdIDogKGZ1bmN0aW9uICgpIHsgdGhyb3cgbmV3IFJ1bnRpbWVFcnJvcignVmFyaWFibGUgInJlcXVlc3QiIGRvZXMgbm90IGV4aXN0LicsIDM2MCwgJHRoaXMtPnNvdXJjZSk7IH0pKCkpLCAic2NoZW1lQW5kSHR0cEhvc3QiLCBbXSwgImFueSIsIGZhbHNlLCBmYWxzZSwgZmFsc2UsIDM2MCkgLiB0d2lnX2dldF9hdHRyaWJ1dGUoJHRoaXMtPmVudiwgJHRoaXMtPnNvdXJjZSwgKGlzc2V0KCRjb250ZXh0WyJyZXF1ZXN0Il0pIHx8IGFycmF5X2tleV9leGlzdHMoInJlcXVlc3QiLCAkY29udGV4dCkgPyAkY29udGV4dFsicmVxdWVzdCJdIDogKGZ1bmN0aW9uICgpIHsgdGhyb3cgbmV3IFJ1bnRpbWVFcnJvcignVmFyaWFibGUgInJlcXVlc3QiIGRvZXMgbm90IGV4aXN0LicsIDM2MCwgJHRoaXMtPnNvdXJjZSk7IH0pKCkpLCAiYmFzZVBhdGgiLCBbXSwgImFueSIsIGZhbHNlLCBmYWxzZSwgZmFsc2UsIDM2MCkpKSwgImh0bWwiLCBudWxsLCB0cnVlKTsKICAgICAgICAgICAgZWNobyAiKTsKICAgICAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgICAgIGlmICghcGF0aC5tYXRjaChuZXcgUmVnRXhwKCI7CiAgICAgICAgICAgIC8vIGxpbmUgMzYzCiAgICAgICAgICAgIGVjaG8ganNvbl9lbmNvZGUoKGlzc2V0KCRjb250ZXh0WyJleGNsdWRlZF9hamF4X3BhdGhzIl0pIHx8IGFycmF5X2tleV9leGlzdHMoImV4Y2x1ZGVkX2FqYXhfcGF0aHMiLCAkY29udGV4dCkgPyAkY29udGV4dFsiZXhjbHVkZWRfYWpheF9wYXRocyJdIDogKGZ1bmN0aW9uICgpIHsgdGhyb3cgbmV3IFJ1bnRpbWVFcnJvcignVmFyaWFibGUgImV4Y2x1ZGVkX2FqYXhfcGF0aHMiIGRvZXMgbm90IGV4aXN0LicsIDM2MywgJHRoaXMtPnNvdXJjZSk7IH0pKCkpKTsKICAgICAgICAgICAgZWNobyAiKSkpIHsKICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHN0YWNrRWxlbWVudCA9IHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVycm9yOiBmYWxzZSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHVybDogdXJsLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgbWV0aG9kOiBtZXRob2QsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0eXBlOiAneGhyJywKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN0YXJ0OiBuZXcgRGF0ZSgpCiAgICAgICAgICAgICAgICAgICAgICAgIH07CgogICAgICAgICAgICAgICAgICAgICAgICB2YXIgaWR4ID0gcmVxdWVzdFN0YWNrLnB1c2goc3RhY2tFbGVtZW50KSAtIDE7CgogICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmFkZEV2ZW50TGlzdGVuZXIoJ3JlYWR5c3RhdGVjaGFuZ2UnLCBmdW5jdGlvbigpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChzZWxmLnJlYWR5U3RhdGUgPT0gNCkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN0YWNrRWxlbWVudC5kdXJhdGlvbiA9IG5ldyBEYXRlKCkgLSBzdGFja0VsZW1lbnQuc3RhcnQ7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3RhY2tFbGVtZW50LmVycm9yID0gc2VsZi5zdGF0dXMgPCAyMDAgfHwgc2VsZi5zdGF0dXMgPj0gNDAwOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN0YWNrRWxlbWVudC5zdGF0dXNDb2RlID0gc2VsZi5zdGF0dXM7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZXh0cmFjdEhlYWRlcnMoc2VsZiwgc3RhY2tFbGVtZW50KTsKCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZmluaXNoQWpheFJlcXVlc3QoaWR4KTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgfSwgZmFsc2UpOwoKICAgICAgICAgICAgICAgICAgICAgICAgc3RhcnRBamF4UmVxdWVzdChpZHgpOwogICAgICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICAgICAgcHJveGllZC5hcHBseSh0aGlzLCBBcnJheS5wcm90b3R5cGUuc2xpY2UuY2FsbChhcmd1bWVudHMpKTsKICAgICAgICAgICAgICAgIH07CiAgICAgICAgICAgIH0KICAgICAgICAiOwogICAgICAgIH0KICAgICAgICAvLyBsaW5lIDM5MgogICAgICAgIGVjaG8gIgogICAgICAgIHJldHVybiB7CiAgICAgICAgICAgIGhhc0NsYXNzOiBoYXNDbGFzcywKCiAgICAgICAgICAgIHJlbW92ZUNsYXNzOiByZW1vdmVDbGFzcywKCiAgICAgICAgICAgIGFkZENsYXNzOiBhZGRDbGFzcywKCiAgICAgICAgICAgIHRvZ2dsZUNsYXNzOiB0b2dnbGVDbGFzcywKCiAgICAgICAgICAgIGdldFByZWZlcmVuY2U6IGdldFByZWZlcmVuY2UsCgogICAgICAgICAgICBzZXRQcmVmZXJlbmNlOiBzZXRQcmVmZXJlbmNlLAoKICAgICAgICAgICAgYWRkRXZlbnRMaXN0ZW5lcjogYWRkRXZlbnRMaXN0ZW5lciwKCiAgICAgICAgICAgIHJlcXVlc3Q6IHJlcXVlc3QsCgogICAgICAgICAgICByZW5kZXJBamF4UmVxdWVzdHM6IHJlbmRlckFqYXhSZXF1ZXN0cywKCiAgICAgICAgICAgIGdldFNmd2R0OiBmdW5jdGlvbih0b2tlbikgewogICAgICAgICAgICAgICAgaWYgKCF0aGlzLnNmd2R0KSB7CiAgICAgICAgICAgICAgICAgICAgdGhpcy5zZndkdCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdzZndkdCcgKyB0b2tlbik7CiAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuc2Z3ZHQ7CiAgICAgICAgICAgIH0sCgogICAgICAgICAgICBsb2FkOiBmdW5jdGlvbihzZWxlY3RvciwgdXJsLCBvblN1Y2Nlc3MsIG9uRXJyb3IsIG9wdGlvbnMpIHsKICAgICAgICAgICAgICAgIHZhciBlbCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKHNlbGVjdG9yKTsKCiAgICAgICAgICAgICAgICBpZiAoZWwgJiYgZWwuZ2V0QXR0cmlidXRlKCdkYXRhLXNmdXJsJykgIT09IHVybCkgewogICAgICAgICAgICAgICAgICAgIHJlcXVlc3QoCiAgICAgICAgICAgICAgICAgICAgICAgIHVybCwKICAgICAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24oeGhyKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbC5pbm5lckhUTUwgPSB4aHIucmVzcG9uc2VUZXh0OwogICAgICAgICAgICAgICAgICAgICAgICAgICAgZWwuc2V0QXR0cmlidXRlKCdkYXRhLXNmdXJsJywgdXJsKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlbW92ZUNsYXNzKGVsLCAnbG9hZGluZycpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHBlbmRpbmcgPSBwZW5kaW5nUmVxdWVzdHM7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHJlcXVlc3RTdGFjay5sZW5ndGg7IGkrKykgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN0YXJ0QWpheFJlcXVlc3QoaSk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHJlcXVlc3RTdGFja1tpXS5kdXJhdGlvbikgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmaW5pc2hBamF4UmVxdWVzdChpKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvKiBSZXZlcnQgdGhlIHBlbmRpbmcgc3RhdGUgaW4gY2FzZSB0aGVyZSB3YXMgYSBzdGFydCBjYWxsZWQgd2l0aG91dCBhIGZpbmlzaCBhYm92ZS4gKi8KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBlbmRpbmdSZXF1ZXN0cyA9IHBlbmRpbmc7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAob25TdWNjZXNzIHx8IG5vb3ApKHhociwgZWwpOwogICAgICAgICAgICAgICAgICAgICAgICB9LAogICAgICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbih4aHIpIHsgKG9uRXJyb3IgfHwgbm9vcCkoeGhyLCBlbCk7IH0sCiAgICAgICAgICAgICAgICAgICAgICAgICcnLAogICAgICAgICAgICAgICAgICAgICAgICBvcHRpb25zCiAgICAgICAgICAgICAgICAgICAgKTsKICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICByZXR1cm4gdGhpczsKICAgICAgICAgICAgfSwKCiAgICAgICAgICAgIHNob3dUb29sYmFyOiBmdW5jdGlvbih0b2tlbikgewogICAgICAgICAgICAgICAgdmFyIHNmd2R0ID0gdGhpcy5nZXRTZndkdCh0b2tlbik7CiAgICAgICAgICAgICAgICByZW1vdmVDbGFzcyhzZndkdCwgJ3NmLWRpc3BsYXktbm9uZScpOwoKICAgICAgICAgICAgICAgIGlmIChnZXRQcmVmZXJlbmNlKCd0b29sYmFyL2Rpc3BsYXlTdGF0ZScpID09ICdub25lJykgewogICAgICAgICAgICAgICAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdzZlRvb2xiYXJNYWluQ29udGVudC0nICsgdG9rZW4pLnN0eWxlLmRpc3BsYXkgPSAnbm9uZSc7CiAgICAgICAgICAgICAgICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3NmVG9vbGJhckNsZWFyZXItJyArIHRva2VuKS5zdHlsZS5kaXNwbGF5ID0gJ25vbmUnOwogICAgICAgICAgICAgICAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdzZk1pbmlUb29sYmFyLScgKyB0b2tlbikuc3R5bGUuZGlzcGxheSA9ICdibG9jayc7CiAgICAgICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdzZlRvb2xiYXJNYWluQ29udGVudC0nICsgdG9rZW4pLnN0eWxlLmRpc3BsYXkgPSAnYmxvY2snOwogICAgICAgICAgICAgICAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdzZlRvb2xiYXJDbGVhcmVyLScgKyB0b2tlbikuc3R5bGUuZGlzcGxheSA9ICdibG9jayc7CiAgICAgICAgICAgICAgICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3NmTWluaVRvb2xiYXItJyArIHRva2VuKS5zdHlsZS5kaXNwbGF5ID0gJ25vbmUnOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9LAoKICAgICAgICAgICAgaGlkZVRvb2xiYXI6IGZ1bmN0aW9uKHRva2VuKSB7CiAgICAgICAgICAgICAgICB2YXIgc2Z3ZHQgPSB0aGlzLmdldFNmd2R0KHRva2VuKTsKICAgICAgICAgICAgICAgIGFkZENsYXNzKHNmd2R0LCAnc2YtZGlzcGxheS1ub25lJyk7CiAgICAgICAgICAgIH0sCgogICAgICAgICAgICBpbml0VG9vbGJhcjogZnVuY3Rpb24odG9rZW4pIHsKICAgICAgICAgICAgICAgIHRoaXMuc2hvd1Rvb2xiYXIodG9rZW4pOwoKICAgICAgICAgICAgICAgIHZhciBoaWRlQnV0dG9uID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3NmVG9vbGJhckhpZGVCdXR0b24tJyArIHRva2VuKTsKICAgICAgICAgICAgICAgIHZhciBoaWRlQnV0dG9uU3ZnID0gaGlkZUJ1dHRvbi5xdWVyeVNlbGVjdG9yKCdzdmcnKTsKICAgICAgICAgICAgICAgIGhpZGVCdXR0b25Tdmcuc2V0QXR0cmlidXRlKCdhcmlhLWhpZGRlbicsICd0cnVlJyk7CiAgICAgICAgICAgICAgICBoaWRlQnV0dG9uU3ZnLnNldEF0dHJpYnV0ZSgnZm9jdXNhYmxlJywgJ2ZhbHNlJyk7CiAgICAgICAgICAgICAgICBhZGRFdmVudExpc3RlbmVyKGhpZGVCdXR0b24sICdjbGljaycsIGZ1bmN0aW9uIChldmVudCkgewogICAgICAgICAgICAgICAgICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7CgogICAgICAgICAgICAgICAgICAgIHZhciBwID0gdGhpcy5wYXJlbnROb2RlOwogICAgICAgICAgICAgICAgICAgIHAuc3R5bGUuZGlzcGxheSA9ICdub25lJzsKICAgICAgICAgICAgICAgICAgICAocC5wcmV2aW91c0VsZW1lbnRTaWJsaW5nIHx8IHAucHJldmlvdXNTaWJsaW5nKS5zdHlsZS5kaXNwbGF5ID0gJ25vbmUnOwogICAgICAgICAgICAgICAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdzZk1pbmlUb29sYmFyLScgKyB0b2tlbikuc3R5bGUuZGlzcGxheSA9ICdibG9jayc7CiAgICAgICAgICAgICAgICAgICAgc2V0UHJlZmVyZW5jZSgndG9vbGJhci9kaXNwbGF5U3RhdGUnLCAnbm9uZScpOwogICAgICAgICAgICAgICAgfSk7CgogICAgICAgICAgICAgICAgdmFyIHNob3dCdXR0b24gPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnc2ZUb29sYmFyTWluaVRvZ2dsZXItJyArIHRva2VuKTsKICAgICAgICAgICAgICAgIHZhciBzaG93QnV0dG9uU3ZnID0gc2hvd0J1dHRvbi5xdWVyeVNlbGVjdG9yKCdzdmcnKTsKICAgICAgICAgICAgICAgIHNob3dCdXR0b25Tdmcuc2V0QXR0cmlidXRlKCdhcmlhLWhpZGRlbicsICd0cnVlJyk7CiAgICAgICAgICAgICAgICBzaG93QnV0dG9uU3ZnLnNldEF0dHJpYnV0ZSgnZm9jdXNhYmxlJywgJ2ZhbHNlJyk7CiAgICAgICAgICAgICAgICBhZGRFdmVudExpc3RlbmVyKHNob3dCdXR0b24sICdjbGljaycsIGZ1bmN0aW9uIChldmVudCkgewogICAgICAgICAgICAgICAgICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7CgogICAgICAgICAgICAgICAgICAgIHZhciBlbGVtID0gdGhpcy5wYXJlbnROb2RlOwogICAgICAgICAgICAgICAgICAgIGlmIChlbGVtLnN0eWxlLmRpc3BsYXkgPT0gJ25vbmUnKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdzZlRvb2xiYXJNYWluQ29udGVudC0nICsgdG9rZW4pLnN0eWxlLmRpc3BsYXkgPSAnbm9uZSc7CiAgICAgICAgICAgICAgICAgICAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdzZlRvb2xiYXJDbGVhcmVyLScgKyB0b2tlbikuc3R5bGUuZGlzcGxheSA9ICdub25lJzsKICAgICAgICAgICAgICAgICAgICAgICAgZWxlbS5zdHlsZS5kaXNwbGF5ID0gJ2Jsb2NrJzsKICAgICAgICAgICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgICAgICAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnc2ZUb29sYmFyTWFpbkNvbnRlbnQtJyArIHRva2VuKS5zdHlsZS5kaXNwbGF5ID0gJ2Jsb2NrJzsKICAgICAgICAgICAgICAgICAgICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3NmVG9vbGJhckNsZWFyZXItJyArIHRva2VuKS5zdHlsZS5kaXNwbGF5ID0gJ2Jsb2NrJzsKICAgICAgICAgICAgICAgICAgICAgICAgZWxlbS5zdHlsZS5kaXNwbGF5ID0gJ25vbmUnCiAgICAgICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgICAgICBzZXRQcmVmZXJlbmNlKCd0b29sYmFyL2Rpc3BsYXlTdGF0ZScsICdibG9jaycpOwogICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgIH0sCgogICAgICAgICAgICBsb2FkVG9vbGJhcjogZnVuY3Rpb24odG9rZW4sIG5ld1Rva2VuKSB7CiAgICAgICAgICAgICAgICB2YXIgdGhhdCA9IHRoaXM7CiAgICAgICAgICAgICAgICB2YXIgdHJpZXNDb3VudGVyID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3NmTG9hZENvdW50ZXItJyArIHRva2VuKTsKCiAgICAgICAgICAgICAgICB2YXIgb3B0aW9ucyA9IHsKICAgICAgICAgICAgICAgICAgICByZXRyeTogdHJ1ZSwKICAgICAgICAgICAgICAgICAgICBvblNlbmQ6IGZ1bmN0aW9uIChjb3VudCkgewogICAgICAgICAgICAgICAgICAgICAgICBpZiAoY291bnQgPT09IDMpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoYXQuaW5pdFRvb2xiYXIodG9rZW4pOwogICAgICAgICAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgICAgICAgICBpZiAodHJpZXNDb3VudGVyKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0cmllc0NvdW50ZXIudGV4dENvbnRlbnQgPSBjb3VudDsKICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIH0sCiAgICAgICAgICAgICAgICB9OwoKICAgICAgICAgICAgICAgIHZhciBjYW5jZWxCdXR0b24gPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnc2ZMb2FkQ2FuY2VsLScgKyB0b2tlbik7CiAgICAgICAgICAgICAgICBpZiAoY2FuY2VsQnV0dG9uKSB7CiAgICAgICAgICAgICAgICAgICAgYWRkRXZlbnRMaXN0ZW5lcihjYW5jZWxCdXR0b24sICdjbGljaycsIGZ1bmN0aW9uIChldmVudCkgewogICAgICAgICAgICAgICAgICAgICAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpOwoKICAgICAgICAgICAgICAgICAgICAgICAgb3B0aW9ucy5zdG9wID0gdHJ1ZTsKICAgICAgICAgICAgICAgICAgICAgICAgdGhhdC5oaWRlVG9vbGJhcih0b2tlbik7CiAgICAgICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgbmV3VG9rZW4gPSAobmV3VG9rZW4gfHwgdG9rZW4pOwoKICAgICAgICAgICAgICAgIHRoaXMubG9hZCgKICAgICAgICAgICAgICAgICAgICAnc2Z3ZHQnICsgdG9rZW4sCiAgICAgICAgICAgICAgICAgICAgJyI7CiAgICAgICAgLy8gbGluZSA1NDAKICAgICAgICBlY2hvIHR3aWdfZXNjYXBlX2ZpbHRlcigkdGhpcy0+ZW52LCB0d2lnX2VzY2FwZV9maWx0ZXIoJHRoaXMtPmVudiwgJHRoaXMtPmV4dGVuc2lvbnNbJ1N5bWZvbnlcQnJpZGdlXFR3aWdcRXh0ZW5zaW9uXFJvdXRpbmdFeHRlbnNpb24nXS0+Z2V0VXJsKCJfd2R0IiwgWyJ0b2tlbiIgPT4gInh4eHh4eCJdKSwgImpzIiksICJodG1sIiwgbnVsbCwgdHJ1ZSk7CiAgICAgICAgZWNobyAiJy5yZXBsYWNlKC94eHh4eHgvLCBuZXdUb2tlbiksCiAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24oeGhyLCBlbCkgewogICAgICAgICAgICAgICAgICAgICAgICAvKiBEbyBub3RoaW5nIGluIHRoZSBlZGdlIGNhc2Ugd2hlcmUgdGhlIHRvb2xiYXIgaGFzIGFscmVhZHkgYmVlbiByZXBsYWNlZCB3aXRoIGEgbmV3IG9uZSAqLwogICAgICAgICAgICAgICAgICAgICAgICBpZiAoIWRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdzZlRvb2xiYXJNYWluQ29udGVudC0nICsgbmV3VG9rZW4pKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm47CiAgICAgICAgICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICAgICAgICAgIC8qIEV2YWx1YXRlIGluIGdsb2JhbCBzY29wZSBzY3JpcHRzIGVtYmVkZGVkIGluc2lkZSB0aGUgdG9vbGJhciAqLwogICAgICAgICAgICAgICAgICAgICAgICB2YXIgaSwgc2NyaXB0cyA9IFtdLnNsaWNlLmNhbGwoZWwucXVlcnlTZWxlY3RvckFsbCgnc2NyaXB0JykpOwogICAgICAgICAgICAgICAgICAgICAgICBmb3IgKGkgPSAwOyBpIDwgc2NyaXB0cy5sZW5ndGg7ICsraSkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgZXZhbC5jYWxsKHt9LCBzY3JpcHRzW2ldLmZpcnN0Q2hpbGQubm9kZVZhbHVlKTsKICAgICAgICAgICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgICAgICAgICAgZWwuc3R5bGUuZGlzcGxheSA9IC0xICE9PSB4aHIucmVzcG9uc2VUZXh0LmluZGV4T2YoJ3NmLXRvb2xiYXJyZXNldCcpID8gJ2Jsb2NrJyA6ICdub25lJzsKCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChlbC5zdHlsZS5kaXNwbGF5ID09ICdub25lJykgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuOwogICAgICAgICAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgICAgICAgICB0aGF0LmluaXRUb29sYmFyKG5ld1Rva2VuKTsKCiAgICAgICAgICAgICAgICAgICAgICAgIC8qIEhhbmRsZSB0b29sYmFyLWluZm8gcG9zaXRpb24gKi8KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHRvb2xiYXJCbG9ja3MgPSBbXS5zbGljZS5jYWxsKGVsLnF1ZXJ5U2VsZWN0b3JBbGwoJy5zZi10b29sYmFyLWJsb2NrJykpOwogICAgICAgICAgICAgICAgICAgICAgICBmb3IgKGkgPSAwOyBpIDwgdG9vbGJhckJsb2Nrcy5sZW5ndGg7ICsraSkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgdG9vbGJhckJsb2Nrc1tpXS5vbm1vdXNlb3ZlciA9IGZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgdG9vbGJhckluZm8gPSB0aGlzLnF1ZXJ5U2VsZWN0b3JBbGwoJy5zZi10b29sYmFyLWluZm8nKVswXTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgcGFnZVdpZHRoID0gZG9jdW1lbnQuYm9keS5jbGllbnRXaWR0aDsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgZWxlbWVudFdpZHRoID0gdG9vbGJhckluZm8ub2Zmc2V0V2lkdGg7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGxlZnRWYWx1ZSA9IChlbGVtZW50V2lkdGggKyB0aGlzLm9mZnNldExlZnQpIC0gcGFnZVdpZHRoOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciByaWdodFZhbHVlID0gKGVsZW1lbnRXaWR0aCArIChwYWdlV2lkdGggLSB0aGlzLm9mZnNldExlZnQpKSAtIHBhZ2VXaWR0aDsKCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLyogUmVzZXQgcmlnaHQgYW5kIGxlZnQgdmFsdWUsIHVzZWZ1bCBvbiB3aW5kb3cgcmVzaXplICovCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdG9vbGJhckluZm8uc3R5bGUucmlnaHQgPSAnJzsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0b29sYmFySW5mby5zdHlsZS5sZWZ0ID0gJyc7CgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChlbGVtZW50V2lkdGggPiBwYWdlV2lkdGgpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdG9vbGJhckluZm8uc3R5bGUubGVmdCA9IDA7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVsc2UgaWYgKGxlZnRWYWx1ZSA+IDAgJiYgcmlnaHRWYWx1ZSA+IDApIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdG9vbGJhckluZm8uc3R5bGUucmlnaHQgPSAocmlnaHRWYWx1ZSAqIC0xKSArICdweCc7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmIChsZWZ0VmFsdWUgPCAwKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRvb2xiYXJJbmZvLnN0eWxlLmxlZnQgPSAwOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRvb2xiYXJJbmZvLnN0eWxlLnJpZ2h0ID0gJzBweCc7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfTsKICAgICAgICAgICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgICAgICAgICAgcmVuZGVyQWpheFJlcXVlc3RzKCk7CiAgICAgICAgICAgICAgICAgICAgICAgIGFkZEV2ZW50TGlzdGVuZXIoZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLnNmLXRvb2xiYXItYWpheC1jbGVhcicpLCAnY2xpY2snLCBmdW5jdGlvbigpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlcXVlc3RTdGFjayA9IFtdOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVuZGVyQWpheFJlcXVlc3RzKCk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdWNjZXNzU3RyZWFrID0gNDsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5zZi10b29sYmFyLWFqYXgtcmVxdWVzdC1saXN0JykuaW5uZXJIVE1MID0gJyc7CiAgICAgICAgICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgICAgICAgICBhZGRFdmVudExpc3RlbmVyKGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5zZi10b29sYmFyLWJsb2NrLWFqYXgnKSwgJ21vdXNlZW50ZXInLCBmdW5jdGlvbiAoZXZlbnQpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBlbGVtID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLnNmLXRvb2xiYXItYmxvY2stYWpheCAuc2YtdG9vbGJhci1pbmZvJyk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbGVtLnNjcm9sbFRvcCA9IGVsZW0uc2Nyb2xsSGVpZ2h0OwogICAgICAgICAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgICAgICAgICAgYWRkRXZlbnRMaXN0ZW5lcihkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuc2YtdG9vbGJhci1ibG9jay1hamF4ID4gLnNmLXRvb2xiYXItaWNvbicpLCAnY2xpY2snLCBmdW5jdGlvbiAoZXZlbnQpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7CgogICAgICAgICAgICAgICAgICAgICAgICAgICAgdG9nZ2xlQ2xhc3ModGhpcy5wYXJlbnROb2RlLCAnaG92ZXInKTsKICAgICAgICAgICAgICAgICAgICAgICAgfSk7CgogICAgICAgICAgICAgICAgICAgICAgICB2YXIgZHVtcEluZm8gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuc2YtdG9vbGJhci1ibG9jay1kdW1wIC5zZi10b29sYmFyLWluZm8nKTsKICAgICAgICAgICAgICAgICAgICAgICAgaWYgKG51bGwgIT09IGR1bXBJbmZvKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhZGRFdmVudExpc3RlbmVyKGR1bXBJbmZvLCAnc2ZiZWZvcmVkdW1wY29sbGFwc2UnLCBmdW5jdGlvbiAoKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZHVtcEluZm8uc3R5bGUubWluSGVpZ2h0ID0gZHVtcEluZm8uZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCkuaGVpZ2h0KydweCc7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFkZEV2ZW50TGlzdGVuZXIoZHVtcEluZm8sICdtb3VzZWxlYXZlJywgZnVuY3Rpb24gKCkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGR1bXBJbmZvLnN0eWxlLm1pbkhlaWdodCA9ICcnOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICB9LAogICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uKHhocikgewogICAgICAgICAgICAgICAgICAgICAgICBpZiAoeGhyLnN0YXR1cyAhPT0gMCAmJiAhb3B0aW9ucy5zdG9wKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgc2Z3ZHQgPSB0aGF0LmdldFNmd2R0KHRva2VuKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNmd2R0LmlubmVySFRNTCA9ICdcXAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9XCJzZi10b29sYmFycmVzZXRcIj5cXAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPVwic2YtdG9vbGJhci1pY29uXCI+PHN2ZyB3aWR0aD1cIjI2XCIgaGVpZ2h0PVwiMjhcIiB4bWxucz1cImh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnXCIgdmVyc2lvbj1cIjEuMVwiIHg9XCIwcHhcIiB5PVwiMHB4XCIgdmlld0JveD1cIjAgMCAyNiAyOFwiIGVuYWJsZS1iYWNrZ3JvdW5kPVwibmV3IDAgMCAyNiAyOFwiIHhtbDpzcGFjZT1cInByZXNlcnZlXCI+PHBhdGggZmlsbD1cIiNGRkZGRkZcIiBkPVwiTTEzIDBDNS44IDAgMCA1LjggMCAxM2MwIDcuMiA1LjggMTMgMTMgMTNjNy4yIDAgMTMtNS44IDEzLTEzQzI2IDUuOCAyMC4yIDAgMTMgMHogTTIwIDcuNSBjLTAuNiAwLTEtMC4zLTEtMC45YzAtMC4yIDAtMC40IDAuMi0wLjZjMC4xLTAuMyAwLjItMC4zIDAuMi0wLjRjMC0wLjMtMC41LTAuNC0wLjctMC40Yy0yIDAuMS0yLjUgMi43LTIuOSA0LjhsLTAuMiAxLjEgYzEuMSAwLjIgMS45IDAgMi40LTAuM2MwLjYtMC40LTAuMi0wLjgtMC4xLTEuM0MxOCA5LjIgMTguNCA5IDE4LjcgOC45YzAuNSAwIDAuOCAwLjUgMC44IDFjMCAwLjgtMS4xIDItMy4zIDEuOSBjLTAuMyAwLTAuNSAwLTAuNy0wLjFMMTUgMTQuMWMtMC40IDEuNy0wLjkgNC4xLTIuNiA2LjJjLTEuNSAxLjgtMy4xIDIuMS0zLjggMi4xYy0xLjMgMC0yLjEtMC42LTIuMi0xLjZjMC0wLjkgMC44LTEuNCAxLjMtMS40IGMwLjcgMCAxLjIgMC41IDEuMiAxLjFjMCAwLjUtMC4yIDAuNi0wLjQgMC43Yy0wLjEgMC4xLTAuMyAwLjItMC4zIDAuNGMwIDAuMSAwLjEgMC4zIDAuNCAwLjNjMC41IDAgMC45LTAuMyAxLjItMC41IGMxLjMtMSAxLjctMi45IDIuNC02LjJsMC4xLTAuOGMwLjItMS4xIDAuNS0yLjMgMC44LTMuNWMtMC45LTAuNy0xLjQtMS41LTIuNi0xLjhjLTAuOC0wLjItMS4zIDAtMS43IDAuNEM4LjQgMTAgOC42IDEwLjcgOSAxMS4xIGwwLjcgMC43YzAuOCAwLjkgMS4zIDEuNyAxLjEgMi43Yy0wLjMgMS42LTIuMSAyLjgtNC4zIDIuMWMtMS45LTAuNi0yLjItMS45LTItMi43YzAuMi0wLjYgMC43LTAuOCAxLjItMC42IGMwLjUgMC4yIDAuNyAwLjggMC42IDEuM2MwIDAuMSAwIDAuMS0wLjEgMC4zQzYgMTUgNS45IDE1LjIgNS45IDE1LjNjLTAuMSAwLjQgMC40IDAuNyAwLjggMC44YzAuOCAwLjMgMS43LTAuMiAxLjktMC45IGMwLjItMC42LTAuMi0xLjEtMC40LTEuMmwtMC44LTAuOWMtMC40LTAuNC0xLjItMS41LTAuOC0yLjhjMC4yLTAuNSAwLjUtMSAwLjktMS40YzEtMC43IDItMC44IDMtMC42YzEuMyAwLjQgMS45IDEuMiAyLjggMS45IGMwLjUtMS4zIDEuMS0yLjYgMi0zLjhjMC45LTEgMi0xLjcgMy4zLTEuOEMyMCA0LjggMjEgNS40IDIxIDYuM0MyMSA2LjcgMjAuOCA3LjUgMjAgNy41elwiLz48L3N2Zz48L2Rpdj5cXAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBBbiBlcnJvciBvY2N1cnJlZCB3aGlsZSBsb2FkaW5nIHRoZSB3ZWIgZGVidWcgdG9vbGJhci4gPGEgaHJlZj1cIiI7CiAgICAgICAgLy8gbGluZSA2MjEKICAgICAgICBlY2hvIHR3aWdfZXNjYXBlX2ZpbHRlcigkdGhpcy0+ZW52LCB0d2lnX2VzY2FwZV9maWx0ZXIoJHRoaXMtPmVudiwgJHRoaXMtPmV4dGVuc2lvbnNbJ1N5bWZvbnlcQnJpZGdlXFR3aWdcRXh0ZW5zaW9uXFJvdXRpbmdFeHRlbnNpb24nXS0+Z2V0VXJsKCJfcHJvZmlsZXJfaG9tZSIpLCAianMiKSwgImh0bWwiLCBudWxsLCB0cnVlKTsKICAgICAgICBlY2hvICInICsgbmV3VG9rZW4gKyAnXCI+T3BlbiB0aGUgd2ViIHByb2ZpbGVyLjwvYT5cXAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDwvZGl2PlxcCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAnOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgc2Z3ZHQuc2V0QXR0cmlidXRlKCdjbGFzcycsICdzZi10b29sYmFyIHNmLWVycm9yLXRvb2xiYXInKTsKICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIH0sCiAgICAgICAgICAgICAgICAgICAgb3B0aW9ucwogICAgICAgICAgICAgICAgKTsKCiAgICAgICAgICAgICAgICByZXR1cm4gdGhpczsKICAgICAgICAgICAgfSwKCiAgICAgICAgICAgIHRvZ2dsZTogZnVuY3Rpb24oc2VsZWN0b3IsIGVsT24sIGVsT2ZmKSB7CiAgICAgICAgICAgICAgICB2YXIgdG1wID0gZWxPbi5zdHlsZS5kaXNwbGF5LAogICAgICAgICAgICAgICAgICAgIGVsID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoc2VsZWN0b3IpOwoKICAgICAgICAgICAgICAgIGVsT24uc3R5bGUuZGlzcGxheSA9IGVsT2ZmLnN0eWxlLmRpc3BsYXk7CiAgICAgICAgICAgICAgICBlbE9mZi5zdHlsZS5kaXNwbGF5ID0gdG1wOwoKICAgICAgICAgICAgICAgIGlmIChlbCkgewogICAgICAgICAgICAgICAgICAgIGVsLnN0eWxlLmRpc3BsYXkgPSAnbm9uZScgPT09IHRtcCA/ICdub25lJyA6ICdibG9jayc7CiAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgcmV0dXJuIHRoaXM7CiAgICAgICAgICAgIH0sCgogICAgICAgICAgICBjcmVhdGVUYWJzOiBmdW5jdGlvbigpIHsKICAgICAgICAgICAgICAgIHZhciB0YWJHcm91cHMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCcuc2YtdGFiczpub3QoW2RhdGEtcHJvY2Vzc2VkPXRydWVdKScpOwoKICAgICAgICAgICAgICAgIC8qIGNyZWF0ZSB0aGUgdGFiIG5hdmlnYXRpb24gZm9yIGVhY2ggZ3JvdXAgb2YgdGFicyAqLwogICAgICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCB0YWJHcm91cHMubGVuZ3RoOyBpKyspIHsKICAgICAgICAgICAgICAgICAgICB2YXIgdGFicyA9IHRhYkdyb3Vwc1tpXS5xdWVyeVNlbGVjdG9yQWxsKCc6c2NvcGUgPiAudGFiJyk7CiAgICAgICAgICAgICAgICAgICAgdmFyIHRhYk5hdmlnYXRpb24gPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCd1bCcpOwogICAgICAgICAgICAgICAgICAgIHRhYk5hdmlnYXRpb24uY2xhc3NOYW1lID0gJ3RhYi1uYXZpZ2F0aW9uJzsKCiAgICAgICAgICAgICAgICAgICAgdmFyIHNlbGVjdGVkVGFiSWQgPSAndGFiLScgKyBpICsgJy0wJzsgLyogc2VsZWN0IHRoZSBmaXJzdCB0YWIgYnkgZGVmYXVsdCAqLwogICAgICAgICAgICAgICAgICAgIGZvciAodmFyIGogPSAwOyBqIDwgdGFicy5sZW5ndGg7IGorKykgewogICAgICAgICAgICAgICAgICAgICAgICB2YXIgdGFiSWQgPSAndGFiLScgKyBpICsgJy0nICsgajsKICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHRhYlRpdGxlID0gdGFic1tqXS5xdWVyeVNlbGVjdG9yKCcudGFiLXRpdGxlJykuaW5uZXJIVE1MOwoKICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHRhYk5hdmlnYXRpb25JdGVtID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnbGknKTsKICAgICAgICAgICAgICAgICAgICAgICAgdGFiTmF2aWdhdGlvbkl0ZW0uc2V0QXR0cmlidXRlKCdkYXRhLXRhYi1pZCcsIHRhYklkKTsKICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGhhc0NsYXNzKHRhYnNbal0sICdhY3RpdmUnKSkgeyBzZWxlY3RlZFRhYklkID0gdGFiSWQ7IH0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGhhc0NsYXNzKHRhYnNbal0sICdkaXNhYmxlZCcpKSB7IGFkZENsYXNzKHRhYk5hdmlnYXRpb25JdGVtLCAnZGlzYWJsZWQnKTsgfQogICAgICAgICAgICAgICAgICAgICAgICB0YWJOYXZpZ2F0aW9uSXRlbS5pbm5lckhUTUwgPSB0YWJUaXRsZTsKICAgICAgICAgICAgICAgICAgICAgICAgdGFiTmF2aWdhdGlvbi5hcHBlbmRDaGlsZCh0YWJOYXZpZ2F0aW9uSXRlbSk7CgogICAgICAgICAgICAgICAgICAgICAgICB2YXIgdGFiQ29udGVudCA9IHRhYnNbal0ucXVlcnlTZWxlY3RvcignLnRhYi1jb250ZW50Jyk7CiAgICAgICAgICAgICAgICAgICAgICAgIHRhYkNvbnRlbnQucGFyZW50RWxlbWVudC5zZXRBdHRyaWJ1dGUoJ2lkJywgdGFiSWQpOwogICAgICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICAgICAgdGFiR3JvdXBzW2ldLmluc2VydEJlZm9yZSh0YWJOYXZpZ2F0aW9uLCB0YWJHcm91cHNbaV0uZmlyc3RDaGlsZCk7CiAgICAgICAgICAgICAgICAgICAgYWRkQ2xhc3MoZG9jdW1lbnQucXVlcnlTZWxlY3RvcignW2RhdGEtdGFiLWlkPVwiJyArIHNlbGVjdGVkVGFiSWQgKyAnXCJdJyksICdhY3RpdmUnKTsKICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICAvKiBkaXNwbGF5IHRoZSBhY3RpdmUgdGFiIGFuZCBhZGQgdGhlICdjbGljaycgZXZlbnQgbGlzdGVuZXJzICovCiAgICAgICAgICAgICAgICBmb3IgKGkgPSAwOyBpIDwgdGFiR3JvdXBzLmxlbmd0aDsgaSsrKSB7CiAgICAgICAgICAgICAgICAgICAgdGFiTmF2aWdhdGlvbiA9IHRhYkdyb3Vwc1tpXS5xdWVyeVNlbGVjdG9yQWxsKCc6c2NvcGUgPiAudGFiLW5hdmlnYXRpb24gbGknKTsKCiAgICAgICAgICAgICAgICAgICAgZm9yIChqID0gMDsgaiA8IHRhYk5hdmlnYXRpb24ubGVuZ3RoOyBqKyspIHsKICAgICAgICAgICAgICAgICAgICAgICAgdGFiSWQgPSB0YWJOYXZpZ2F0aW9uW2pdLmdldEF0dHJpYnV0ZSgnZGF0YS10YWItaWQnKTsKICAgICAgICAgICAgICAgICAgICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQodGFiSWQpLnF1ZXJ5U2VsZWN0b3IoJy50YWItdGl0bGUnKS5jbGFzc05hbWUgPSAnaGlkZGVuJzsKCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChoYXNDbGFzcyh0YWJOYXZpZ2F0aW9uW2pdLCAnYWN0aXZlJykpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKHRhYklkKS5jbGFzc05hbWUgPSAnYmxvY2snOwogICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQodGFiSWQpLmNsYXNzTmFtZSA9ICdoaWRkZW4nOwogICAgICAgICAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgICAgICAgICB0YWJOYXZpZ2F0aW9uW2pdLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgZnVuY3Rpb24oZSkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGFjdGl2ZVRhYiA9IGUudGFyZ2V0IHx8IGUuc3JjRWxlbWVudDsKCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvKiBuZWVkZWQgYmVjYXVzZSB3aGVuIHRoZSB0YWIgY29udGFpbnMgSFRNTCBjb250ZW50cywgdXNlciBjYW4gY2xpY2sgKi8KICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8qIG9uIGFueSBvZiB0aG9zZSBlbGVtZW50cyBpbnN0ZWFkIG9mIHRoZWlyIHBhcmVudCAnPGxpPicgZWxlbWVudCAqLwogICAgICAgICAgICAgICAgICAgICAgICAgICAgd2hpbGUgKGFjdGl2ZVRhYi50YWdOYW1lLnRvTG93ZXJDYXNlKCkgIT09ICdsaScpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhY3RpdmVUYWIgPSBhY3RpdmVUYWIucGFyZW50Tm9kZTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvKiBnZXQgdGhlIGZ1bGwgbGlzdCBvZiB0YWJzIHRocm91Z2ggdGhlIHBhcmVudCBvZiB0aGUgYWN0aXZlIHRhYiBlbGVtZW50ICovCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgdGFiTmF2aWdhdGlvbiA9IGFjdGl2ZVRhYi5wYXJlbnROb2RlLmNoaWxkcmVuOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgZm9yICh2YXIgayA9IDA7IGsgPCB0YWJOYXZpZ2F0aW9uLmxlbmd0aDsgaysrKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHRhYklkID0gdGFiTmF2aWdhdGlvbltrXS5nZXRBdHRyaWJ1dGUoJ2RhdGEtdGFiLWlkJyk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQodGFiSWQpLmNsYXNzTmFtZSA9ICdoaWRkZW4nOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlbW92ZUNsYXNzKHRhYk5hdmlnYXRpb25ba10sICdhY3RpdmUnKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhZGRDbGFzcyhhY3RpdmVUYWIsICdhY3RpdmUnKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBhY3RpdmVUYWJJZCA9IGFjdGl2ZVRhYi5nZXRBdHRyaWJ1dGUoJ2RhdGEtdGFiLWlkJyk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChhY3RpdmVUYWJJZCkuY2xhc3NOYW1lID0gJ2Jsb2NrJzsKICAgICAgICAgICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgICAgICB0YWJHcm91cHNbaV0uc2V0QXR0cmlidXRlKCdkYXRhLXByb2Nlc3NlZCcsICd0cnVlJyk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0sCgogICAgICAgICAgICBjcmVhdGVUb2dnbGVzOiBmdW5jdGlvbigpIHsKICAgICAgICAgICAgICAgIHZhciB0b2dnbGVzID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnLnNmLXRvZ2dsZTpub3QoW2RhdGEtcHJvY2Vzc2VkPXRydWVdKScpOwoKICAgICAgICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgdG9nZ2xlcy5sZW5ndGg7IGkrKykgewogICAgICAgICAgICAgICAgICAgIHZhciBlbGVtZW50U2VsZWN0b3IgPSB0b2dnbGVzW2ldLmdldEF0dHJpYnV0ZSgnZGF0YS10b2dnbGUtc2VsZWN0b3InKTsKICAgICAgICAgICAgICAgICAgICB2YXIgZWxlbWVudCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoZWxlbWVudFNlbGVjdG9yKTsKCiAgICAgICAgICAgICAgICAgICAgYWRkQ2xhc3MoZWxlbWVudCwgJ3NmLXRvZ2dsZS1jb250ZW50Jyk7CgogICAgICAgICAgICAgICAgICAgIGlmICh0b2dnbGVzW2ldLmhhc0F0dHJpYnV0ZSgnZGF0YS10b2dnbGUtaW5pdGlhbCcpICYmIHRvZ2dsZXNbaV0uZ2V0QXR0cmlidXRlKCdkYXRhLXRvZ2dsZS1pbml0aWFsJykgPT0gJ2Rpc3BsYXknKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIGFkZENsYXNzKHRvZ2dsZXNbaV0sICdzZi10b2dnbGUtb24nKTsKICAgICAgICAgICAgICAgICAgICAgICAgYWRkQ2xhc3MoZWxlbWVudCwgJ3NmLXRvZ2dsZS12aXNpYmxlJyk7CiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgICAgICAgICAgYWRkQ2xhc3ModG9nZ2xlc1tpXSwgJ3NmLXRvZ2dsZS1vZmYnKTsKICAgICAgICAgICAgICAgICAgICAgICAgYWRkQ2xhc3MoZWxlbWVudCwgJ3NmLXRvZ2dsZS1oaWRkZW4nKTsKICAgICAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgICAgIGFkZEV2ZW50TGlzdGVuZXIodG9nZ2xlc1tpXSwgJ2NsaWNrJywgZnVuY3Rpb24oZSkgewogICAgICAgICAgICAgICAgICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7CgogICAgICAgICAgICAgICAgICAgICAgICBpZiAoJycgIT09IHdpbmRvdy5nZXRTZWxlY3Rpb24oKS50b1N0cmluZygpKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvKiBEb24ndCBkbyBhbnl0aGluZyBvbiB0ZXh0IHNlbGVjdGlvbiAqLwogICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuOwogICAgICAgICAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgICAgICAgICB2YXIgdG9nZ2xlID0gZS50YXJnZXQgfHwgZS5zcmNFbGVtZW50OwoKICAgICAgICAgICAgICAgICAgICAgICAgLyogbmVlZGVkIGJlY2F1c2Ugd2hlbiB0aGUgdG9nZ2xlIGNvbnRhaW5zIEhUTUwgY29udGVudHMsIHVzZXIgY2FuIGNsaWNrICovCiAgICAgICAgICAgICAgICAgICAgICAgIC8qIG9uIGFueSBvZiB0aG9zZSBlbGVtZW50cyBpbnN0ZWFkIG9mIHRoZWlyIHBhcmVudCAnLnNmLXRvZ2dsZScgZWxlbWVudCAqLwogICAgICAgICAgICAgICAgICAgICAgICB3aGlsZSAoIWhhc0NsYXNzKHRvZ2dsZSwgJ3NmLXRvZ2dsZScpKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0b2dnbGUgPSB0b2dnbGUucGFyZW50Tm9kZTsKICAgICAgICAgICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGVsZW1lbnQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKHRvZ2dsZS5nZXRBdHRyaWJ1dGUoJ2RhdGEtdG9nZ2xlLXNlbGVjdG9yJykpOwoKICAgICAgICAgICAgICAgICAgICAgICAgdG9nZ2xlQ2xhc3ModG9nZ2xlLCAnc2YtdG9nZ2xlLW9uJyk7CiAgICAgICAgICAgICAgICAgICAgICAgIHRvZ2dsZUNsYXNzKHRvZ2dsZSwgJ3NmLXRvZ2dsZS1vZmYnKTsKICAgICAgICAgICAgICAgICAgICAgICAgdG9nZ2xlQ2xhc3MoZWxlbWVudCwgJ3NmLXRvZ2dsZS1oaWRkZW4nKTsKICAgICAgICAgICAgICAgICAgICAgICAgdG9nZ2xlQ2xhc3MoZWxlbWVudCwgJ3NmLXRvZ2dsZS12aXNpYmxlJyk7CgogICAgICAgICAgICAgICAgICAgICAgICAvKiB0aGUgdG9nZ2xlIGRvZXNuJ3QgY2hhbmdlIGl0cyBjb250ZW50cyB3aGVuIGNsaWNraW5nIG9uIGl0ICovCiAgICAgICAgICAgICAgICAgICAgICAgIGlmICghdG9nZ2xlLmhhc0F0dHJpYnV0ZSgnZGF0YS10b2dnbGUtYWx0LWNvbnRlbnQnKSkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuOwogICAgICAgICAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgICAgICAgICBpZiAoIXRvZ2dsZS5oYXNBdHRyaWJ1dGUoJ2RhdGEtdG9nZ2xlLW9yaWdpbmFsLWNvbnRlbnQnKSkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgdG9nZ2xlLnNldEF0dHJpYnV0ZSgnZGF0YS10b2dnbGUtb3JpZ2luYWwtY29udGVudCcsIHRvZ2dsZS5pbm5lckhUTUwpOwogICAgICAgICAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgICAgICAgICB2YXIgY3VycmVudENvbnRlbnQgPSB0b2dnbGUuaW5uZXJIVE1MOwogICAgICAgICAgICAgICAgICAgICAgICB2YXIgb3JpZ2luYWxDb250ZW50ID0gdG9nZ2xlLmdldEF0dHJpYnV0ZSgnZGF0YS10b2dnbGUtb3JpZ2luYWwtY29udGVudCcpOwogICAgICAgICAgICAgICAgICAgICAgICB2YXIgYWx0Q29udGVudCA9IHRvZ2dsZS5nZXRBdHRyaWJ1dGUoJ2RhdGEtdG9nZ2xlLWFsdC1jb250ZW50Jyk7CiAgICAgICAgICAgICAgICAgICAgICAgIHRvZ2dsZS5pbm5lckhUTUwgPSBjdXJyZW50Q29udGVudCAhPT0gYWx0Q29udGVudCA/IGFsdENvbnRlbnQgOiBvcmlnaW5hbENvbnRlbnQ7CiAgICAgICAgICAgICAgICAgICAgfSk7CgogICAgICAgICAgICAgICAgICAgIC8qIFByZXZlbnRzIGZyb20gZGlzYWxsb3dpbmcgY2xpY2tzIG9uIGxpbmtzIGluc2lkZSB0b2dnbGVzICovCiAgICAgICAgICAgICAgICAgICAgdmFyIHRvZ2dsZUxpbmtzID0gdG9nZ2xlc1tpXS5xdWVyeVNlbGVjdG9yQWxsKCdhJyk7CiAgICAgICAgICAgICAgICAgICAgZm9yICh2YXIgaiA9IDA7IGogPCB0b2dnbGVMaW5rcy5sZW5ndGg7IGorKykgewogICAgICAgICAgICAgICAgICAgICAgICBhZGRFdmVudExpc3RlbmVyKHRvZ2dsZUxpbmtzW2pdLCAnY2xpY2snLCBmdW5jdGlvbihlKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBlLnN0b3BQcm9wYWdhdGlvbigpOwogICAgICAgICAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgICAgIC8qIFByZXZlbnRzIGZyb20gZGlzYWxsb3dpbmcgY2xpY2tzIG9uIFwiY29weSB0byBjbGlwYm9hcmRcIiBlbGVtZW50cyBpbnNpZGUgdG9nZ2xlcyAqLwogICAgICAgICAgICAgICAgICAgIHZhciBjb3B5VG9DbGlwYm9hcmRFbGVtZW50cyA9IHRvZ2dsZXNbaV0ucXVlcnlTZWxlY3RvckFsbCgnc3BhbltkYXRhLWNsaXBib2FyZC10ZXh0XScpOwogICAgICAgICAgICAgICAgICAgIGZvciAodmFyIGsgPSAwOyBrIDwgY29weVRvQ2xpcGJvYXJkRWxlbWVudHMubGVuZ3RoOyBrKyspIHsKICAgICAgICAgICAgICAgICAgICAgICAgYWRkRXZlbnRMaXN0ZW5lcihjb3B5VG9DbGlwYm9hcmRFbGVtZW50c1trXSwgJ2NsaWNrJywgZnVuY3Rpb24oZSkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgZS5zdG9wUHJvcGFnYXRpb24oKTsKICAgICAgICAgICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgICAgICB0b2dnbGVzW2ldLnNldEF0dHJpYnV0ZSgnZGF0YS1wcm9jZXNzZWQnLCAndHJ1ZScpOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9LAoKICAgICAgICAgICAgaW5pdGlhbGl6ZUxvZ3NUYWJsZTogZnVuY3Rpb24oKSB7CiAgICAgICAgICAgICAgICBTZmpzLnVwZGF0ZUxvZ3NUYWJsZSgpOwoKICAgICAgICAgICAgICAgIGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJy5sb2ctZmlsdGVyIGlucHV0JykuZm9yRWFjaCgoaW5wdXQpID0+IHsKICAgICAgICAgICAgICAgICAgICBpbnB1dC5hZGRFdmVudExpc3RlbmVyKCdjaGFuZ2UnLCAoKSA9PiB7IFNmanMudXBkYXRlTG9nc1RhYmxlKCk7IH0pOwogICAgICAgICAgICAgICAgfSk7CgogICAgICAgICAgICAgICAgZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnLmZpbHRlci1zZWxlY3QtYWxsLW9yLW5vbmUgYnV0dG9uJykuZm9yRWFjaCgobGluaykgPT4gewogICAgICAgICAgICAgICAgICAgIGxpbmsuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoKSA9PiB7CiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IHNlbGVjdEFsbCA9IGxpbmsuY2xhc3NMaXN0LmNvbnRhaW5zKCdzZWxlY3QtYWxsJyk7CiAgICAgICAgICAgICAgICAgICAgICAgIGxpbmsuY2xvc2VzdCgnLmxvZy1maWx0ZXItY29udGVudCcpLnF1ZXJ5U2VsZWN0b3JBbGwoJ2lucHV0JykuZm9yRWFjaCgoaW5wdXQpID0+IHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlucHV0LmNoZWNrZWQgPSBzZWxlY3RBbGw7CiAgICAgICAgICAgICAgICAgICAgICAgIH0pOwoKICAgICAgICAgICAgICAgICAgICAgICAgU2Zqcy51cGRhdGVMb2dzVGFibGUoKTsKICAgICAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgIH0pOwoKICAgICAgICAgICAgICAgIGRvY3VtZW50LmJvZHkuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoZXZlbnQpID0+IHsKICAgICAgICAgICAgICAgICAgICBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCdkZXRhaWxzLmxvZy1maWx0ZXInKS5mb3JFYWNoKChmaWx0ZXJFbGVtZW50KSA9PiB7CiAgICAgICAgICAgICAgICAgICAgICAgIGlmICghZmlsdGVyRWxlbWVudC5jb250YWlucyhldmVudC50YXJnZXQpICYmIGZpbHRlckVsZW1lbnQub3BlbikgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgZmlsdGVyRWxlbWVudC5vcGVuID0gZmFsc2U7CiAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICB9LAoKICAgICAgICAgICAgdXBkYXRlTG9nc1RhYmxlOiBmdW5jdGlvbigpIHsKICAgICAgICAgICAgICAgIGNvbnN0IHNlbGVjdGVkVHlwZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJyNsb2ctZmlsdGVyLXR5cGUgaW5wdXQ6Y2hlY2tlZCcpLnZhbHVlOwogICAgICAgICAgICAgICAgY29uc3QgcHJpb3JpdGllcyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJyNsb2ctZmlsdGVyLXByaW9yaXR5IGlucHV0Jyk7CiAgICAgICAgICAgICAgICBjb25zdCBhbGxQcmlvcml0aWVzID0gQXJyYXkuZnJvbShwcmlvcml0aWVzKS5tYXAoKGlucHV0KSA9PiBpbnB1dC52YWx1ZSk7CiAgICAgICAgICAgICAgICBjb25zdCBzZWxlY3RlZFByaW9yaXRpZXMgPSBBcnJheS5mcm9tKHByaW9yaXRpZXMpLmZpbHRlcigoaW5wdXQpID0+IGlucHV0LmNoZWNrZWQpLm1hcCgoaW5wdXQpID0+IGlucHV0LnZhbHVlKTsKICAgICAgICAgICAgICAgIGNvbnN0IGNoYW5uZWxzID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnI2xvZy1maWx0ZXItY2hhbm5lbCBpbnB1dCcpOwogICAgICAgICAgICAgICAgY29uc3Qgc2VsZWN0ZWRDaGFubmVscyA9IEFycmF5LmZyb20oY2hhbm5lbHMpLmZpbHRlcigoaW5wdXQpID0+IGlucHV0LmNoZWNrZWQpLm1hcCgoaW5wdXQpID0+IGlucHV0LnZhbHVlKTsKCiAgICAgICAgICAgICAgICBjb25zdCBsb2dzID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcigndGFibGUubG9ncycpOwogICAgICAgICAgICAgICAgaWYgKG51bGwgPT09IGxvZ3MpIHsKICAgICAgICAgICAgICAgICAgICByZXR1cm47CiAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgLyogaGlkZSByb3dzIHRoYXQgZG9uJ3QgbWF0Y2ggdGhlIGN1cnJlbnQgZmlsdGVycyAqLwogICAgICAgICAgICAgICAgbGV0IG51bVZpc2libGVSb3dzID0gMDsKICAgICAgICAgICAgICAgIGxvZ3MucXVlcnlTZWxlY3RvckFsbCgndGJvZHkgdHInKS5mb3JFYWNoKChyb3cpID0+IHsKICAgICAgICAgICAgICAgICAgICBpZiAoJ2FsbCcgIT09IHNlbGVjdGVkVHlwZSAmJiBzZWxlY3RlZFR5cGUgIT09IHJvdy5nZXRBdHRyaWJ1dGUoJ2RhdGEtdHlwZScpKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIHJvdy5zdHlsZS5kaXNwbGF5ID0gJ25vbmUnOwogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm47CiAgICAgICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgICAgICBjb25zdCBwcmlvcml0eSA9IHJvdy5nZXRBdHRyaWJ1dGUoJ2RhdGEtcHJpb3JpdHknKTsKICAgICAgICAgICAgICAgICAgICBpZiAoZmFsc2UgPT09IHNlbGVjdGVkUHJpb3JpdGllcy5pbmNsdWRlcyhwcmlvcml0eSkgJiYgdHJ1ZSA9PT0gYWxsUHJpb3JpdGllcy5pbmNsdWRlcyhwcmlvcml0eSkpIHsKICAgICAgICAgICAgICAgICAgICAgICAgcm93LnN0eWxlLmRpc3BsYXkgPSAnbm9uZSc7CiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybjsKICAgICAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgICAgIGlmICgnJyAhPT0gcm93LmdldEF0dHJpYnV0ZSgnZGF0YS1jaGFubmVsJykgJiYgZmFsc2UgPT09IHNlbGVjdGVkQ2hhbm5lbHMuaW5jbHVkZXMocm93LmdldEF0dHJpYnV0ZSgnZGF0YS1jaGFubmVsJykpKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIHJvdy5zdHlsZS5kaXNwbGF5ID0gJ25vbmUnOwogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm47CiAgICAgICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgICAgICByb3cuc3R5bGUuZGlzcGxheSA9ICd0YWJsZS1yb3cnOwogICAgICAgICAgICAgICAgICAgIG51bVZpc2libGVSb3dzKys7CiAgICAgICAgICAgICAgICB9KTsKCiAgICAgICAgICAgICAgICBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCd0YWJsZS5sb2dzJykuc3R5bGUuZGlzcGxheSA9IDAgPT09IG51bVZpc2libGVSb3dzID8gJ25vbmUnIDogJ3RhYmxlJzsKICAgICAgICAgICAgICAgIGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5uby1sb2dzLW1lc3NhZ2UnKS5zdHlsZS5kaXNwbGF5ID0gMCA9PT0gbnVtVmlzaWJsZVJvd3MgPyAnYmxvY2snIDogJ25vbmUnOwoKICAgICAgICAgICAgICAgIC8qIHVwZGF0ZSB0aGUgc2VsZWN0ZWQgdG90YWxzIG9mIGFsbCBmaWx0ZXJzICovCiAgICAgICAgICAgICAgICBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcjbG9nLWZpbHRlci1wcmlvcml0eSAuZmlsdGVyLWFjdGl2ZS1udW0nKS5pbm5lclRleHQgPSAocHJpb3JpdGllcy5sZW5ndGggPT09IHNlbGVjdGVkUHJpb3JpdGllcy5sZW5ndGgpID8gJ0FsbCcgOiBzZWxlY3RlZFByaW9yaXRpZXMubGVuZ3RoOwogICAgICAgICAgICAgICAgZG9jdW1lbnQucXVlcnlTZWxlY3RvcignI2xvZy1maWx0ZXItY2hhbm5lbCAuZmlsdGVyLWFjdGl2ZS1udW0nKS5pbm5lclRleHQgPSAoY2hhbm5lbHMubGVuZ3RoID09PSBzZWxlY3RlZENoYW5uZWxzLmxlbmd0aCkgPyAnQWxsJyA6IHNlbGVjdGVkQ2hhbm5lbHMubGVuZ3RoOwoKICAgICAgICAgICAgICAgIC8qIHVwZGF0ZSB0aGUgY3VycmVudGx5IHNlbGVjdGVkIFwibG9nIHR5cGVcIiB0YWIgKi8KICAgICAgICAgICAgICAgIGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJyNsb2ctZmlsdGVyLXR5cGUgbGknKS5mb3JFYWNoKCh0YWIpID0+IHRhYi5jbGFzc0xpc3QucmVtb3ZlKCdhY3RpdmUnKSk7CiAgICAgICAgICAgICAgICBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKGAjbG9nLWZpbHRlci10eXBlIGlucHV0W3ZhbHVlPVwiXCR7c2VsZWN0ZWRUeXBlfVwiXWApLnBhcmVudEVsZW1lbnQuY2xhc3NMaXN0LmFkZCgnYWN0aXZlJyk7CiAgICAgICAgICAgIH0sCiAgICAgICAgfTsKICAgIH0pKCk7CgogICAgU2Zqcy5hZGRFdmVudExpc3RlbmVyKGRvY3VtZW50LCAnRE9NQ29udGVudExvYWRlZCcsIGZ1bmN0aW9uKCkgewogICAgICAgIFNmanMuY3JlYXRlVGFicygpOwogICAgICAgIFNmanMuY3JlYXRlVG9nZ2xlcygpOwogICAgfSk7Cn0KLypdXT4qLzwvc2NyaXB0PgoiOwogICAgICAgIAogICAgICAgICRfX2ludGVybmFsXzVhMjdhOGJhMjFjYTc5YjYxOTMyMzc2YjJmYTkyMmQyLT5sZWF2ZSgkX19pbnRlcm5hbF81YTI3YThiYTIxY2E3OWI2MTkzMjM3NmIyZmE5MjJkMl9wcm9mKTsKCiAgICAgICAgCiAgICAgICAgJF9faW50ZXJuYWxfNmY0N2JiZTk5ODNhZjgxZjFlNzQ1MGU5YTNlMzc2OGYtPmxlYXZlKCRfX2ludGVybmFsXzZmNDdiYmU5OTgzYWY4MWYxZTc0NTBlOWEzZTM3NjhmX3Byb2YpOwoKICAgIH0KCiAgICAvKioKICAgICAqIEBjb2RlQ292ZXJhZ2VJZ25vcmUKICAgICAqLwogICAgcHVibGljIGZ1bmN0aW9uIGdldFRlbXBsYXRlTmFtZSgpCiAgICB7CiAgICAgICAgcmV0dXJuICJAV2ViUHJvZmlsZXIvUHJvZmlsZXIvYmFzZV9qcy5odG1sLnR3aWciOwogICAgfQoKICAgIC8qKgogICAgICogQGNvZGVDb3ZlcmFnZUlnbm9yZQogICAgICovCiAgICBwdWJsaWMgZnVuY3Rpb24gaXNUcmFpdGFibGUoKQogICAgewogICAgICAgIHJldHVybiBmYWxzZTsKICAgIH0KCiAgICAvKioKICAgICAqIEBjb2RlQ292ZXJhZ2VJZ25vcmUKICAgICAqLwogICAgcHVibGljIGZ1bmN0aW9uIGdldERlYnVnSW5mbygpCiAgICB7CiAgICAgICAgcmV0dXJuIGFycmF5ICggIDY5NCA9PiA2MjEsICA2MTAgPT4gNTQwLCAgNDYwID0+IDM5MiwgIDQyOCA9PiAzNjMsICA0MjIgPT4gMzYwLCAgNDE4ID0+IDM1OSwgIDQxMiA9PiAzNTYsICA0MDggPT4gMzU1LCAgMzYyID0+IDMxMiwgIDM0MSA9PiAyOTMsICAzMzkgPT4gMjkyLCAgNTIgPT4gNywgIDQzID0+IDMsKTsKICAgIH0KCiAgICBwdWJsaWMgZnVuY3Rpb24gZ2V0U291cmNlQ29udGV4dCgpCiAgICB7CiAgICAgICAgcmV0dXJuIG5ldyBTb3VyY2UoInsjIFRoaXMgZmlsZSBpcyBwYXJ0aWFsbHkgZHVwbGljYXRlZCBpbiBzcmMvU3ltZm9ueS9Db21wb25lbnQvRXJyb3JIYW5kbGVyL1Jlc291cmNlcy9hc3NldHMvanMvZXhjZXB0aW9uLmpzLgogICBJZiB5b3UgbWFrZSBhbnkgY2hhbmdlIGluIHRoaXMgZmlsZSwgdmVyaWZ5IHRoZSBzYW1lIGNoYW5nZSBpcyBuZWVkZWQgaW4gdGhlIG90aGVyIGZpbGUuICN9CjxzY3JpcHR7JSBpZiBjc3Bfc2NyaXB0X25vbmNlIGlzIGRlZmluZWQgYW5kIGNzcF9zY3JpcHRfbm9uY2UgJX0gbm9uY2U9XCJ7eyBjc3Bfc2NyaXB0X25vbmNlIH19XCJ7JSBlbmRpZiAlfT4vKjwhW0NEQVRBWyovCiAgICB7IyBDYXV0aW9uOiB0aGUgY29udGVudHMgb2YgdGhpcyBmaWxlIGFyZSBwcm9jZXNzZWQgYnkgVHdpZyBiZWZvcmUgbG9hZGluZwogICAgICAgICAgICAgICAgdGhlbSBhcyBKYXZhU2NyaXB0IHNvdXJjZSBjb2RlLiBBbHdheXMgdXNlICcvKicgY29tbWVudHMgaW5zdGVhZAogICAgICAgICAgICAgICAgb2YgJy8vJyBjb21tZW50cyB0byBhdm9pZCBpbXBvc3NpYmxlLXRvLWRlYnVnIHNpZGUtZWZmZWN0cyAjfQoKaWYgKHR5cGVvZiBTZmpzID09PSAndW5kZWZpbmVkJyB8fCB0eXBlb2YgU2Zqcy5sb2FkVG9vbGJhciA9PT0gJ3VuZGVmaW5lZCcpIHsKICAgIFNmanMgPSAoZnVuY3Rpb24oKSB7CiAgICAgICAgXCJ1c2Ugc3RyaWN0XCI7CgogICAgICAgIGlmICgnY2xhc3NMaXN0JyBpbiBkb2N1bWVudC5kb2N1bWVudEVsZW1lbnQpIHsKICAgICAgICAgICAgdmFyIGhhc0NsYXNzID0gZnVuY3Rpb24gKGVsLCBjc3NDbGFzcykgeyByZXR1cm4gZWwuY2xhc3NMaXN0LmNvbnRhaW5zKGNzc0NsYXNzKTsgfTsKICAgICAgICAgICAgdmFyIHJlbW92ZUNsYXNzID0gZnVuY3Rpb24oZWwsIGNzc0NsYXNzKSB7IGVsLmNsYXNzTGlzdC5yZW1vdmUoY3NzQ2xhc3MpOyB9OwogICAgICAgICAgICB2YXIgYWRkQ2xhc3MgPSBmdW5jdGlvbihlbCwgY3NzQ2xhc3MpIHsgZWwuY2xhc3NMaXN0LmFkZChjc3NDbGFzcyk7IH07CiAgICAgICAgICAgIHZhciB0b2dnbGVDbGFzcyA9IGZ1bmN0aW9uKGVsLCBjc3NDbGFzcykgeyBlbC5jbGFzc0xpc3QudG9nZ2xlKGNzc0NsYXNzKTsgfTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgICB2YXIgaGFzQ2xhc3MgPSBmdW5jdGlvbiAoZWwsIGNzc0NsYXNzKSB7IHJldHVybiBlbC5jbGFzc05hbWUubWF0Y2gobmV3IFJlZ0V4cCgnXFxcXGInICsgY3NzQ2xhc3MgKyAnXFxcXGInKSk7IH07CiAgICAgICAgICAgIHZhciByZW1vdmVDbGFzcyA9IGZ1bmN0aW9uKGVsLCBjc3NDbGFzcykgeyBlbC5jbGFzc05hbWUgPSBlbC5jbGFzc05hbWUucmVwbGFjZShuZXcgUmVnRXhwKCdcXFxcYicgKyBjc3NDbGFzcyArICdcXFxcYicpLCAnICcpOyB9OwogICAgICAgICAgICB2YXIgYWRkQ2xhc3MgPSBmdW5jdGlvbihlbCwgY3NzQ2xhc3MpIHsgaWYgKCFoYXNDbGFzcyhlbCwgY3NzQ2xhc3MpKSB7IGVsLmNsYXNzTmFtZSArPSBcIiBcIiArIGNzc0NsYXNzOyB9IH07CiAgICAgICAgICAgIHZhciB0b2dnbGVDbGFzcyA9IGZ1bmN0aW9uKGVsLCBjc3NDbGFzcykgeyBoYXNDbGFzcyhlbCwgY3NzQ2xhc3MpID8gcmVtb3ZlQ2xhc3MoZWwsIGNzc0NsYXNzKSA6IGFkZENsYXNzKGVsLCBjc3NDbGFzcyk7IH07CiAgICAgICAgfQoKICAgICAgICB2YXIgbm9vcCA9IGZ1bmN0aW9uKCkge307CgogICAgICAgIHZhciBwcm9maWxlclN0b3JhZ2VLZXkgPSAnc3ltZm9ueS9wcm9maWxlci8nOwoKICAgICAgICB2YXIgYWRkRXZlbnRMaXN0ZW5lcjsKCiAgICAgICAgdmFyIGVsID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7CiAgICAgICAgaWYgKCEoJ2FkZEV2ZW50TGlzdGVuZXInIGluIGVsKSkgewogICAgICAgICAgICBhZGRFdmVudExpc3RlbmVyID0gZnVuY3Rpb24gKGVsZW1lbnQsIGV2ZW50TmFtZSwgY2FsbGJhY2spIHsKICAgICAgICAgICAgICAgIGVsZW1lbnQuYXR0YWNoRXZlbnQoJ29uJyArIGV2ZW50TmFtZSwgY2FsbGJhY2spOwogICAgICAgICAgICB9OwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIGFkZEV2ZW50TGlzdGVuZXIgPSBmdW5jdGlvbiAoZWxlbWVudCwgZXZlbnROYW1lLCBjYWxsYmFjaykgewogICAgICAgICAgICAgICAgZWxlbWVudC5hZGRFdmVudExpc3RlbmVyKGV2ZW50TmFtZSwgY2FsbGJhY2ssIGZhbHNlKTsKICAgICAgICAgICAgfTsKICAgICAgICB9CgogICAgICAgIGlmIChuYXZpZ2F0b3IuY2xpcGJvYXJkKSB7CiAgICAgICAgICAgIGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJ1tkYXRhLWNsaXBib2FyZC10ZXh0XScpLmZvckVhY2goZnVuY3Rpb24oZWxlbWVudCkgewogICAgICAgICAgICAgICAgcmVtb3ZlQ2xhc3MoZWxlbWVudCwgJ2hpZGRlbicpOwogICAgICAgICAgICAgICAgZWxlbWVudC5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIGZ1bmN0aW9uKCkgewogICAgICAgICAgICAgICAgICAgIG5hdmlnYXRvci5jbGlwYm9hcmQud3JpdGVUZXh0KGVsZW1lbnQuZ2V0QXR0cmlidXRlKCdkYXRhLWNsaXBib2FyZC10ZXh0JykpOwogICAgICAgICAgICAgICAgfSkKICAgICAgICAgICAgfSk7CiAgICAgICAgfQoKICAgICAgICB2YXIgcmVxdWVzdCA9IGZ1bmN0aW9uKHVybCwgb25TdWNjZXNzLCBvbkVycm9yLCBwYXlsb2FkLCBvcHRpb25zLCB0cmllcykgewogICAgICAgICAgICB2YXIgeGhyID0gd2luZG93LlhNTEh0dHBSZXF1ZXN0ID8gbmV3IFhNTEh0dHBSZXF1ZXN0KCkgOiBuZXcgQWN0aXZlWE9iamVjdCgnTWljcm9zb2Z0LlhNTEhUVFAnKTsKICAgICAgICAgICAgb3B0aW9ucyA9IG9wdGlvbnMgfHwge307CiAgICAgICAgICAgIG9wdGlvbnMucmV0cnkgPSBvcHRpb25zLnJldHJ5IHx8IGZhbHNlOwogICAgICAgICAgICB0cmllcyA9IHRyaWVzIHx8IDE7CiAgICAgICAgICAgIC8qIHRoaXMgZGVsYXlzIGZvciAxMjUsIDM3NSwgNjI1LCA4NzUsIGFuZCAxMDAwLCAuLi4gKi8KICAgICAgICAgICAgdmFyIGRlbGF5ID0gdHJpZXMgPCA1ID8gKHRyaWVzIC0gMC41KSAqIDI1MCA6IDEwMDA7CgogICAgICAgICAgICB4aHIub3BlbihvcHRpb25zLm1ldGhvZCB8fCAnR0VUJywgdXJsLCB0cnVlKTsKICAgICAgICAgICAgeGhyLnNldFJlcXVlc3RIZWFkZXIoJ1gtUmVxdWVzdGVkLVdpdGgnLCAnWE1MSHR0cFJlcXVlc3QnKTsKICAgICAgICAgICAgeGhyLm9ucmVhZHlzdGF0ZWNoYW5nZSA9IGZ1bmN0aW9uKHN0YXRlKSB7CiAgICAgICAgICAgICAgICBpZiAoNCAhPT0geGhyLnJlYWR5U3RhdGUpIHsKICAgICAgICAgICAgICAgICAgICByZXR1cm4gbnVsbDsKICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICBpZiAoeGhyLnN0YXR1cyA9PSA0MDQgJiYgb3B0aW9ucy5yZXRyeSAmJiAhb3B0aW9ucy5zdG9wKSB7CiAgICAgICAgICAgICAgICAgICAgc2V0VGltZW91dChmdW5jdGlvbigpIHsKICAgICAgICAgICAgICAgICAgICAgICAgaWYgKG9wdGlvbnMuc3RvcCkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuOwogICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgIHJlcXVlc3QodXJsLCBvblN1Y2Nlc3MsIG9uRXJyb3IsIHBheWxvYWQsIG9wdGlvbnMsIHRyaWVzICsgMSk7CiAgICAgICAgICAgICAgICAgICAgfSwgZGVsYXkpOwoKICAgICAgICAgICAgICAgICAgICByZXR1cm4gbnVsbDsKICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICBpZiAoMjAwID09PSB4aHIuc3RhdHVzKSB7CiAgICAgICAgICAgICAgICAgICAgKG9uU3VjY2VzcyB8fCBub29wKSh4aHIpOwogICAgICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgICAgICAob25FcnJvciB8fCBub29wKSh4aHIpOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9OwoKICAgICAgICAgICAgaWYgKG9wdGlvbnMub25TZW5kKSB7CiAgICAgICAgICAgICAgICBvcHRpb25zLm9uU2VuZCh0cmllcyk7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIHhoci5zZW5kKHBheWxvYWQgfHwgJycpOwogICAgICAgIH07CgogICAgICAgIHZhciBnZXRQcmVmZXJlbmNlID0gZnVuY3Rpb24obmFtZSkgewogICAgICAgICAgICBpZiAoIXdpbmRvdy5sb2NhbFN0b3JhZ2UpIHsKICAgICAgICAgICAgICAgIHJldHVybiBudWxsOwogICAgICAgICAgICB9CgogICAgICAgICAgICByZXR1cm4gbG9jYWxTdG9yYWdlLmdldEl0ZW0ocHJvZmlsZXJTdG9yYWdlS2V5ICsgbmFtZSk7CiAgICAgICAgfTsKCiAgICAgICAgdmFyIHNldFByZWZlcmVuY2UgPSBmdW5jdGlvbihuYW1lLCB2YWx1ZSkgewogICAgICAgICAgICBpZiAoIXdpbmRvdy5sb2NhbFN0b3JhZ2UpIHsKICAgICAgICAgICAgICAgIHJldHVybiBudWxsOwogICAgICAgICAgICB9CgogICAgICAgICAgICBsb2NhbFN0b3JhZ2Uuc2V0SXRlbShwcm9maWxlclN0b3JhZ2VLZXkgKyBuYW1lLCB2YWx1ZSk7CiAgICAgICAgfTsKCiAgICAgICAgdmFyIHJlcXVlc3RTdGFjayA9IFtdOwoKICAgICAgICB2YXIgZXh0cmFjdEhlYWRlcnMgPSBmdW5jdGlvbih4aHIsIHN0YWNrRWxlbWVudCkgewogICAgICAgICAgICAvKiBIZXJlIHdlIGF2b2lkIHRvIGNhbGwgeGhyLmdldFJlc3BvbnNlSGVhZGVyIGluIG9yZGVyIHRvICovCiAgICAgICAgICAgIC8qIHByZXZlbnQgcG9sbHV0aW5nIHRoZSBjb25zb2xlIHdpdGggQ09SUyBzZWN1cml0eSBlcnJvcnMgKi8KICAgICAgICAgICAgdmFyIGFsbEhlYWRlcnMgPSB4aHIuZ2V0QWxsUmVzcG9uc2VIZWFkZXJzKCk7CiAgICAgICAgICAgIHZhciByZXQ7CgogICAgICAgICAgICBpZiAocmV0ID0gYWxsSGVhZGVycy5tYXRjaCgvXngtZGVidWctdG9rZW46XFxzKyguKilcJC9pbSkpIHsKICAgICAgICAgICAgICAgIHN0YWNrRWxlbWVudC5wcm9maWxlID0gcmV0WzFdOwogICAgICAgICAgICB9CiAgICAgICAgICAgIGlmIChyZXQgPSBhbGxIZWFkZXJzLm1hdGNoKC9eeC1kZWJ1Zy10b2tlbi1saW5rOlxccysoLiopXCQvaW0pKSB7CiAgICAgICAgICAgICAgICBzdGFja0VsZW1lbnQucHJvZmlsZXJVcmwgPSByZXRbMV07CiAgICAgICAgICAgIH0KICAgICAgICAgICAgaWYgKHJldCA9IGFsbEhlYWRlcnMubWF0Y2goL15TeW1mb255LURlYnVnLVRvb2xiYXItUmVwbGFjZTpcXHMrKC4qKVwkL2ltKSkgewogICAgICAgICAgICAgICAgc3RhY2tFbGVtZW50LnRvb2xiYXJSZXBsYWNlRmluaXNoZWQgPSBmYWxzZTsKICAgICAgICAgICAgICAgIHN0YWNrRWxlbWVudC50b29sYmFyUmVwbGFjZSA9ICcxJyA9PT0gcmV0WzFdOwogICAgICAgICAgICB9CiAgICAgICAgfTsKCiAgICAgICAgdmFyIHN1Y2Nlc3NTdHJlYWsgPSA0OwogICAgICAgIHZhciBwZW5kaW5nUmVxdWVzdHMgPSAwOwogICAgICAgIHZhciByZW5kZXJBamF4UmVxdWVzdHMgPSBmdW5jdGlvbigpIHsKICAgICAgICAgICAgdmFyIHJlcXVlc3RDb3VudGVyID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLnNmLXRvb2xiYXItYWpheC1yZXF1ZXN0LWNvdW50ZXInKTsKICAgICAgICAgICAgaWYgKCFyZXF1ZXN0Q291bnRlcikgewogICAgICAgICAgICAgICAgcmV0dXJuOwogICAgICAgICAgICB9CiAgICAgICAgICAgIHJlcXVlc3RDb3VudGVyLnRleHRDb250ZW50ID0gcmVxdWVzdFN0YWNrLmxlbmd0aDsKCiAgICAgICAgICAgIHZhciBpbmZvU3BhbiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuc2YtdG9vbGJhci1hamF4LWluZm9cIik7CiAgICAgICAgICAgIGlmIChpbmZvU3BhbikgewogICAgICAgICAgICAgICAgaW5mb1NwYW4udGV4dENvbnRlbnQgPSByZXF1ZXN0U3RhY2subGVuZ3RoICsgJyBBSkFYIHJlcXVlc3QnICsgKHJlcXVlc3RTdGFjay5sZW5ndGggIT09IDEgPyAncycgOiAnJyk7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIHZhciBhamF4VG9vbGJhclBhbmVsID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLnNmLXRvb2xiYXItYmxvY2stYWpheCcpOwogICAgICAgICAgICBpZiAocmVxdWVzdFN0YWNrLmxlbmd0aCkgewogICAgICAgICAgICAgICAgYWpheFRvb2xiYXJQYW5lbC5zdHlsZS5kaXNwbGF5ID0gJ2Jsb2NrJzsKICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgIGFqYXhUb29sYmFyUGFuZWwuc3R5bGUuZGlzcGxheSA9ICdub25lJzsKICAgICAgICAgICAgfQogICAgICAgICAgICBpZiAocGVuZGluZ1JlcXVlc3RzID4gMCkgewogICAgICAgICAgICAgICAgYWRkQ2xhc3MoYWpheFRvb2xiYXJQYW5lbCwgJ3NmLWFqYXgtcmVxdWVzdC1sb2FkaW5nJyk7CiAgICAgICAgICAgIH0gZWxzZSBpZiAoc3VjY2Vzc1N0cmVhayA8IDQpIHsKICAgICAgICAgICAgICAgIGFkZENsYXNzKGFqYXhUb29sYmFyUGFuZWwsICdzZi10b29sYmFyLXN0YXR1cy1yZWQnKTsKICAgICAgICAgICAgICAgIHJlbW92ZUNsYXNzKGFqYXhUb29sYmFyUGFuZWwsICdzZi1hamF4LXJlcXVlc3QtbG9hZGluZycpOwogICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgcmVtb3ZlQ2xhc3MoYWpheFRvb2xiYXJQYW5lbCwgJ3NmLWFqYXgtcmVxdWVzdC1sb2FkaW5nJyk7CiAgICAgICAgICAgICAgICByZW1vdmVDbGFzcyhhamF4VG9vbGJhclBhbmVsLCAnc2YtdG9vbGJhci1zdGF0dXMtcmVkJyk7CiAgICAgICAgICAgIH0KICAgICAgICB9OwoKICAgICAgICB2YXIgc3RhcnRBamF4UmVxdWVzdCA9IGZ1bmN0aW9uKGluZGV4KSB7CiAgICAgICAgICAgIHZhciB0Ym9keSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5zZi10b29sYmFyLWFqYXgtcmVxdWVzdC1saXN0Jyk7CiAgICAgICAgICAgIGlmICghdGJvZHkpIHsKICAgICAgICAgICAgICAgIHJldHVybjsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgdmFyIG5iT2ZBamF4UmVxdWVzdCA9IHRib2R5LnJvd3MubGVuZ3RoOwogICAgICAgICAgICBpZiAobmJPZkFqYXhSZXF1ZXN0ID49IDEwMCkgewogICAgICAgICAgICAgICAgdGJvZHkuZGVsZXRlUm93KDApOwogICAgICAgICAgICB9CgogICAgICAgICAgICB2YXIgcmVxdWVzdCA9IHJlcXVlc3RTdGFja1tpbmRleF07CiAgICAgICAgICAgIHBlbmRpbmdSZXF1ZXN0cysrOwogICAgICAgICAgICB2YXIgcm93ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgndHInKTsKICAgICAgICAgICAgcmVxdWVzdC5ET01Ob2RlID0gcm93OwoKICAgICAgICAgICAgdmFyIHJlcXVlc3ROdW1iZXJDZWxsID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgndGQnKTsKICAgICAgICAgICAgcmVxdWVzdE51bWJlckNlbGwudGV4dENvbnRlbnQgPSBpbmRleCArIDE7CiAgICAgICAgICAgIHJvdy5hcHBlbmRDaGlsZChyZXF1ZXN0TnVtYmVyQ2VsbCk7CgogICAgICAgICAgICB2YXIgcHJvZmlsZXJDZWxsID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgndGQnKTsKICAgICAgICAgICAgcHJvZmlsZXJDZWxsLnRleHRDb250ZW50ID0gJ24vYSc7CiAgICAgICAgICAgIHJvdy5hcHBlbmRDaGlsZChwcm9maWxlckNlbGwpOwoKICAgICAgICAgICAgdmFyIG1ldGhvZENlbGwgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCd0ZCcpOwogICAgICAgICAgICBtZXRob2RDZWxsLnRleHRDb250ZW50ID0gcmVxdWVzdC5tZXRob2Q7CiAgICAgICAgICAgIHJvdy5hcHBlbmRDaGlsZChtZXRob2RDZWxsKTsKCiAgICAgICAgICAgIHZhciB0eXBlQ2VsbCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3RkJyk7CiAgICAgICAgICAgIHR5cGVDZWxsLnRleHRDb250ZW50ID0gcmVxdWVzdC50eXBlOwogICAgICAgICAgICByb3cuYXBwZW5kQ2hpbGQodHlwZUNlbGwpOwoKICAgICAgICAgICAgdmFyIHN0YXR1c0NvZGVDZWxsID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgndGQnKTsKICAgICAgICAgICAgdmFyIHN0YXR1c0NvZGUgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdzcGFuJyk7CiAgICAgICAgICAgIHN0YXR1c0NvZGUudGV4dENvbnRlbnQgPSAnbi9hJzsKICAgICAgICAgICAgc3RhdHVzQ29kZUNlbGwuYXBwZW5kQ2hpbGQoc3RhdHVzQ29kZSk7CiAgICAgICAgICAgIHJvdy5hcHBlbmRDaGlsZChzdGF0dXNDb2RlQ2VsbCk7CgogICAgICAgICAgICB2YXIgcGF0aENlbGwgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCd0ZCcpOwogICAgICAgICAgICBwYXRoQ2VsbC5jbGFzc05hbWUgPSAnc2YtYWpheC1yZXF1ZXN0LXVybCc7CiAgICAgICAgICAgIGlmICgnR0VUJyA9PT0gcmVxdWVzdC5tZXRob2QpIHsKICAgICAgICAgICAgICAgIHZhciBwYXRoTGluayA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2EnKTsKICAgICAgICAgICAgICAgIHBhdGhMaW5rLnNldEF0dHJpYnV0ZSgnaHJlZicsIHJlcXVlc3QudXJsKTsKICAgICAgICAgICAgICAgIHBhdGhMaW5rLnRleHRDb250ZW50ID0gcmVxdWVzdC51cmw7CiAgICAgICAgICAgICAgICBwYXRoQ2VsbC5hcHBlbmRDaGlsZChwYXRoTGluayk7CiAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICBwYXRoQ2VsbC50ZXh0Q29udGVudCA9IHJlcXVlc3QudXJsOwogICAgICAgICAgICB9CiAgICAgICAgICAgIHBhdGhDZWxsLnNldEF0dHJpYnV0ZSgndGl0bGUnLCByZXF1ZXN0LnVybCk7CiAgICAgICAgICAgIHJvdy5hcHBlbmRDaGlsZChwYXRoQ2VsbCk7CgogICAgICAgICAgICB2YXIgZHVyYXRpb25DZWxsID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgndGQnKTsKICAgICAgICAgICAgZHVyYXRpb25DZWxsLmNsYXNzTmFtZSA9ICdzZi1hamF4LXJlcXVlc3QtZHVyYXRpb24nOwogICAgICAgICAgICBkdXJhdGlvbkNlbGwudGV4dENvbnRlbnQgPSAnbi9hJzsKICAgICAgICAgICAgcm93LmFwcGVuZENoaWxkKGR1cmF0aW9uQ2VsbCk7CgogICAgICAgICAgICByZXF1ZXN0LmxpdmVEdXJhdGlvbkhhbmRsZSA9IHNldEludGVydmFsKGZ1bmN0aW9uKCkgewogICAgICAgICAgICAgICAgZHVyYXRpb25DZWxsLnRleHRDb250ZW50ID0gKG5ldyBEYXRlKCkgLSByZXF1ZXN0LnN0YXJ0KSArICcgbXMnOwogICAgICAgICAgICB9LCAxMDApOwoKICAgICAgICAgICAgcm93LmNsYXNzTmFtZSA9ICdzZi1hamF4LXJlcXVlc3Qgc2YtYWpheC1yZXF1ZXN0LWxvYWRpbmcnOwogICAgICAgICAgICB0Ym9keS5pbnNlcnRCZWZvcmUocm93LCBudWxsKTsKCiAgICAgICAgICAgIHZhciB0b29sYmFySW5mbyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5zZi10b29sYmFyLWJsb2NrLWFqYXggLnNmLXRvb2xiYXItaW5mbycpOwogICAgICAgICAgICB0b29sYmFySW5mby5zY3JvbGxUb3AgPSB0b29sYmFySW5mby5zY3JvbGxIZWlnaHQ7CgogICAgICAgICAgICByZW5kZXJBamF4UmVxdWVzdHMoKTsKICAgICAgICB9OwoKICAgICAgICB2YXIgZmluaXNoQWpheFJlcXVlc3QgPSBmdW5jdGlvbihpbmRleCkgewogICAgICAgICAgICB2YXIgcmVxdWVzdCA9IHJlcXVlc3RTdGFja1tpbmRleF07CiAgICAgICAgICAgIGNsZWFySW50ZXJ2YWwocmVxdWVzdC5saXZlRHVyYXRpb25IYW5kbGUpOwoKICAgICAgICAgICAgaWYgKCFyZXF1ZXN0LkRPTU5vZGUpIHsKICAgICAgICAgICAgICAgIHJldHVybjsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgaWYgKHJlcXVlc3QudG9vbGJhclJlcGxhY2UgJiYgIXJlcXVlc3QudG9vbGJhclJlcGxhY2VGaW5pc2hlZCAmJiByZXF1ZXN0LnByb2ZpbGUpIHsKICAgICAgICAgICAgICAgIC8qIEZsYWcgYXMgY29tcGxldGUgYmVjYXVzZSBmaW5pc2hBamF4UmVxdWVzdCBjYW4gYmUgY2FsbGVkIG11bHRpcGxlIHRpbWVzLiAqLwogICAgICAgICAgICAgICAgcmVxdWVzdC50b29sYmFyUmVwbGFjZUZpbmlzaGVkID0gdHJ1ZTsKICAgICAgICAgICAgICAgIC8qIFNlYXJjaCB1cCB0aHJvdWdoIHRoZSBET00gdG8gZmluZCB0aGUgdG9vbGJhcidzIGNvbnRhaW5lciBJRC4gKi8KICAgICAgICAgICAgICAgIGZvciAodmFyIGVsZW0gPSByZXF1ZXN0LkRPTU5vZGU7IGVsZW0gJiYgZWxlbSAhPT0gZG9jdW1lbnQ7IGVsZW0gPSBlbGVtLnBhcmVudE5vZGUpIHsKICAgICAgICAgICAgICAgICAgICBpZiAoZWxlbS5pZC5tYXRjaCgvXnNmd2R0LykpIHsKICAgICAgICAgICAgICAgICAgICAgICAgU2Zqcy5sb2FkVG9vbGJhcihlbGVtLmlkLnJlcGxhY2UoL15zZndkdC8sICcnKSwgcmVxdWVzdC5wcm9maWxlKTsKICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CgogICAgICAgICAgICBwZW5kaW5nUmVxdWVzdHMtLTsKICAgICAgICAgICAgdmFyIHJvdyA9IHJlcXVlc3QuRE9NTm9kZTsKICAgICAgICAgICAgLyogVW5wYWNrIHRoZSBjaGlsZHJlbiBmcm9tIHRoZSByb3cgKi8KICAgICAgICAgICAgdmFyIHByb2ZpbGVyQ2VsbCA9IHJvdy5jaGlsZHJlblsxXTsKICAgICAgICAgICAgdmFyIG1ldGhvZENlbGwgPSByb3cuY2hpbGRyZW5bMl07CiAgICAgICAgICAgIHZhciBzdGF0dXNDb2RlQ2VsbCA9IHJvdy5jaGlsZHJlbls0XTsKICAgICAgICAgICAgdmFyIHN0YXR1c0NvZGVFbGVtID0gc3RhdHVzQ29kZUNlbGwuY2hpbGRyZW5bMF07CiAgICAgICAgICAgIHZhciBkdXJhdGlvbkNlbGwgPSByb3cuY2hpbGRyZW5bNl07CgogICAgICAgICAgICBpZiAocmVxdWVzdC5lcnJvcikgewogICAgICAgICAgICAgICAgcm93LmNsYXNzTmFtZSA9ICdzZi1hamF4LXJlcXVlc3Qgc2YtYWpheC1yZXF1ZXN0LWVycm9yJzsKICAgICAgICAgICAgICAgIG1ldGhvZENlbGwuY2xhc3NOYW1lID0gJ3NmLWFqYXgtcmVxdWVzdC1lcnJvcic7CiAgICAgICAgICAgICAgICBzdWNjZXNzU3RyZWFrID0gMDsKICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgIHJvdy5jbGFzc05hbWUgPSAnc2YtYWpheC1yZXF1ZXN0IHNmLWFqYXgtcmVxdWVzdC1vayc7CiAgICAgICAgICAgICAgICBzdWNjZXNzU3RyZWFrKys7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIGlmIChyZXF1ZXN0LnN0YXR1c0NvZGUpIHsKICAgICAgICAgICAgICAgIGlmIChyZXF1ZXN0LnN0YXR1c0NvZGUgPCAzMDApIHsKICAgICAgICAgICAgICAgICAgICBzdGF0dXNDb2RlRWxlbS5zZXRBdHRyaWJ1dGUoJ2NsYXNzJywgJ3NmLXRvb2xiYXItc3RhdHVzJyk7CiAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKHJlcXVlc3Quc3RhdHVzQ29kZSA8IDQwMCkgewogICAgICAgICAgICAgICAgICAgIHN0YXR1c0NvZGVFbGVtLnNldEF0dHJpYnV0ZSgnY2xhc3MnLCAnc2YtdG9vbGJhci1zdGF0dXMgc2YtdG9vbGJhci1zdGF0dXMteWVsbG93Jyk7CiAgICAgICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgICAgIHN0YXR1c0NvZGVFbGVtLnNldEF0dHJpYnV0ZSgnY2xhc3MnLCAnc2YtdG9vbGJhci1zdGF0dXMgc2YtdG9vbGJhci1zdGF0dXMtcmVkJyk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICBzdGF0dXNDb2RlRWxlbS50ZXh0Q29udGVudCA9IHJlcXVlc3Quc3RhdHVzQ29kZTsKICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgIHN0YXR1c0NvZGVFbGVtLnNldEF0dHJpYnV0ZSgnY2xhc3MnLCAnc2YtdG9vbGJhci1zdGF0dXMgc2YtdG9vbGJhci1zdGF0dXMtcmVkJyk7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIGlmIChyZXF1ZXN0LmR1cmF0aW9uKSB7CiAgICAgICAgICAgICAgICBkdXJhdGlvbkNlbGwudGV4dENvbnRlbnQgPSByZXF1ZXN0LmR1cmF0aW9uICsgJyBtcyc7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIGlmIChyZXF1ZXN0LnByb2ZpbGVyVXJsKSB7CiAgICAgICAgICAgICAgICBwcm9maWxlckNlbGwudGV4dENvbnRlbnQgPSAnJzsKICAgICAgICAgICAgICAgIHZhciBwcm9maWxlckxpbmsgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdhJyk7CiAgICAgICAgICAgICAgICBwcm9maWxlckxpbmsuc2V0QXR0cmlidXRlKCdocmVmJywgcmVxdWVzdC5wcm9maWxlclVybCk7CiAgICAgICAgICAgICAgICBwcm9maWxlckxpbmsudGV4dENvbnRlbnQgPSByZXF1ZXN0LnByb2ZpbGU7CiAgICAgICAgICAgICAgICBwcm9maWxlckNlbGwuYXBwZW5kQ2hpbGQocHJvZmlsZXJMaW5rKTsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgcmVuZGVyQWpheFJlcXVlc3RzKCk7CiAgICAgICAgfTsKCiAgICAgICAgeyUgaWYgZXhjbHVkZWRfYWpheF9wYXRocyBpcyBkZWZpbmVkICV9CiAgICAgICAgICAgIGlmICh3aW5kb3cuZmV0Y2ggJiYgd2luZG93LmZldGNoLnBvbHlmaWxsID09PSB1bmRlZmluZWQpIHsKICAgICAgICAgICAgICAgIHZhciBvbGRGZXRjaCA9IHdpbmRvdy5mZXRjaDsKICAgICAgICAgICAgICAgIHdpbmRvdy5mZXRjaCA9IGZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgICAgICAgICB2YXIgcHJvbWlzZSA9IG9sZEZldGNoLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7CiAgICAgICAgICAgICAgICAgICAgdmFyIHVybCA9IGFyZ3VtZW50c1swXTsKICAgICAgICAgICAgICAgICAgICB2YXIgcGFyYW1zID0gYXJndW1lbnRzWzFdOwogICAgICAgICAgICAgICAgICAgIHZhciBwYXJhbVR5cGUgPSBPYmplY3QucHJvdG90eXBlLnRvU3RyaW5nLmNhbGwoYXJndW1lbnRzWzBdKTsKICAgICAgICAgICAgICAgICAgICBpZiAocGFyYW1UeXBlID09PSAnW29iamVjdCBSZXF1ZXN0XScpIHsKICAgICAgICAgICAgICAgICAgICAgICAgdXJsID0gYXJndW1lbnRzWzBdLnVybDsKICAgICAgICAgICAgICAgICAgICAgICAgcGFyYW1zID0gewogICAgICAgICAgICAgICAgICAgICAgICAgICAgbWV0aG9kOiBhcmd1bWVudHNbMF0ubWV0aG9kLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgY3JlZGVudGlhbHM6IGFyZ3VtZW50c1swXS5jcmVkZW50aWFscywKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGhlYWRlcnM6IGFyZ3VtZW50c1swXS5oZWFkZXJzLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgbW9kZTogYXJndW1lbnRzWzBdLm1vZGUsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZWRpcmVjdDogYXJndW1lbnRzWzBdLnJlZGlyZWN0CiAgICAgICAgICAgICAgICAgICAgICAgIH07CiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgICAgICAgICAgdXJsID0gU3RyaW5nKHVybCk7CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIGlmICghdXJsLm1hdGNoKG5ldyBSZWdFeHAoe3sgZXhjbHVkZWRfYWpheF9wYXRoc3xqc29uX2VuY29kZXxyYXcgfX0pKSkgewogICAgICAgICAgICAgICAgICAgICAgICB2YXIgbWV0aG9kID0gJ0dFVCc7CiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChwYXJhbXMgJiYgcGFyYW1zLm1ldGhvZCAhPT0gdW5kZWZpbmVkKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBtZXRob2QgPSBwYXJhbXMubWV0aG9kOwogICAgICAgICAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgICAgICAgICB2YXIgc3RhY2tFbGVtZW50ID0gewogICAgICAgICAgICAgICAgICAgICAgICAgICAgZXJyb3I6IGZhbHNlLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgdXJsOiB1cmwsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBtZXRob2Q6IG1ldGhvZCwKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHR5cGU6ICdmZXRjaCcsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdGFydDogbmV3IERhdGUoKQogICAgICAgICAgICAgICAgICAgICAgICB9OwoKICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGlkeCA9IHJlcXVlc3RTdGFjay5wdXNoKHN0YWNrRWxlbWVudCkgLSAxOwogICAgICAgICAgICAgICAgICAgICAgICBwcm9taXNlLnRoZW4oZnVuY3Rpb24gKHIpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN0YWNrRWxlbWVudC5kdXJhdGlvbiA9IG5ldyBEYXRlKCkgLSBzdGFja0VsZW1lbnQuc3RhcnQ7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdGFja0VsZW1lbnQuZXJyb3IgPSByLnN0YXR1cyA8IDIwMCB8fCByLnN0YXR1cyA+PSA0MDA7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdGFja0VsZW1lbnQuc3RhdHVzQ29kZSA9IHIuc3RhdHVzOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgc3RhY2tFbGVtZW50LnByb2ZpbGUgPSByLmhlYWRlcnMuZ2V0KCd4LWRlYnVnLXRva2VuJyk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdGFja0VsZW1lbnQucHJvZmlsZXJVcmwgPSByLmhlYWRlcnMuZ2V0KCd4LWRlYnVnLXRva2VuLWxpbmsnKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN0YWNrRWxlbWVudC50b29sYmFyUmVwbGFjZUZpbmlzaGVkID0gZmFsc2U7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdGFja0VsZW1lbnQudG9vbGJhclJlcGxhY2UgPSAnMScgPT09IHIuaGVhZGVycy5nZXQoJ1N5bWZvbnktRGVidWctVG9vbGJhci1SZXBsYWNlJyk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBmaW5pc2hBamF4UmVxdWVzdChpZHgpOwogICAgICAgICAgICAgICAgICAgICAgICB9LCBmdW5jdGlvbiAoZSl7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdGFja0VsZW1lbnQuZXJyb3IgPSB0cnVlOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgZmluaXNoQWpheFJlcXVlc3QoaWR4KTsKICAgICAgICAgICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgICAgICAgICAgIHN0YXJ0QWpheFJlcXVlc3QoaWR4KTsKICAgICAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgICAgIHJldHVybiBwcm9taXNlOwogICAgICAgICAgICAgICAgfTsKICAgICAgICAgICAgfQogICAgICAgICAgICBpZiAod2luZG93LlhNTEh0dHBSZXF1ZXN0ICYmIFhNTEh0dHBSZXF1ZXN0LnByb3RvdHlwZS5hZGRFdmVudExpc3RlbmVyKSB7CiAgICAgICAgICAgICAgICB2YXIgcHJveGllZCA9IFhNTEh0dHBSZXF1ZXN0LnByb3RvdHlwZS5vcGVuOwoKICAgICAgICAgICAgICAgIFhNTEh0dHBSZXF1ZXN0LnByb3RvdHlwZS5vcGVuID0gZnVuY3Rpb24obWV0aG9kLCB1cmwsIGFzeW5jLCB1c2VyLCBwYXNzKSB7CiAgICAgICAgICAgICAgICAgICAgdmFyIHNlbGYgPSB0aGlzOwoKICAgICAgICAgICAgICAgICAgICAvKiBwcmV2ZW50IGxvZ2dpbmcgQUpBWCBjYWxscyB0byBzdGF0aWMgYW5kIGlubGluZSBmaWxlcywgbGlrZSB0ZW1wbGF0ZXMgKi8KICAgICAgICAgICAgICAgICAgICB2YXIgcGF0aCA9IHVybDsKICAgICAgICAgICAgICAgICAgICBpZiAodXJsLnNsaWNlKDAsIDEpID09PSAnLycpIHsKICAgICAgICAgICAgICAgICAgICAgICAgaWYgKDAgPT09IHVybC5pbmRleE9mKCd7eyByZXF1ZXN0LmJhc2VQYXRofGUoJ2pzJykgfX0nKSkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgcGF0aCA9IHVybC5zbGljZSh7eyByZXF1ZXN0LmJhc2VQYXRofGxlbmd0aCB9fSk7CiAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgZWxzZSBpZiAoMCA9PT0gdXJsLmluZGV4T2YoJ3t7IChyZXF1ZXN0LnNjaGVtZUFuZEh0dHBIb3N0IH4gcmVxdWVzdC5iYXNlUGF0aCl8ZSgnanMnKSB9fScpKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIHBhdGggPSB1cmwuc2xpY2Uoe3sgKHJlcXVlc3Quc2NoZW1lQW5kSHR0cEhvc3QgfiByZXF1ZXN0LmJhc2VQYXRoKXxsZW5ndGggfX0pOwogICAgICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICAgICAgaWYgKCFwYXRoLm1hdGNoKG5ldyBSZWdFeHAoe3sgZXhjbHVkZWRfYWpheF9wYXRoc3xqc29uX2VuY29kZXxyYXcgfX0pKSkgewogICAgICAgICAgICAgICAgICAgICAgICB2YXIgc3RhY2tFbGVtZW50ID0gewogICAgICAgICAgICAgICAgICAgICAgICAgICAgZXJyb3I6IGZhbHNlLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgdXJsOiB1cmwsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBtZXRob2Q6IG1ldGhvZCwKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHR5cGU6ICd4aHInLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgc3RhcnQ6IG5ldyBEYXRlKCkKICAgICAgICAgICAgICAgICAgICAgICAgfTsKCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBpZHggPSByZXF1ZXN0U3RhY2sucHVzaChzdGFja0VsZW1lbnQpIC0gMTsKCiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuYWRkRXZlbnRMaXN0ZW5lcigncmVhZHlzdGF0ZWNoYW5nZScsIGZ1bmN0aW9uKCkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHNlbGYucmVhZHlTdGF0ZSA9PSA0KSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3RhY2tFbGVtZW50LmR1cmF0aW9uID0gbmV3IERhdGUoKSAtIHN0YWNrRWxlbWVudC5zdGFydDsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdGFja0VsZW1lbnQuZXJyb3IgPSBzZWxmLnN0YXR1cyA8IDIwMCB8fCBzZWxmLnN0YXR1cyA+PSA0MDA7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3RhY2tFbGVtZW50LnN0YXR1c0NvZGUgPSBzZWxmLnN0YXR1czsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBleHRyYWN0SGVhZGVycyhzZWxmLCBzdGFja0VsZW1lbnQpOwoKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmaW5pc2hBamF4UmVxdWVzdChpZHgpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICB9LCBmYWxzZSk7CgogICAgICAgICAgICAgICAgICAgICAgICBzdGFydEFqYXhSZXF1ZXN0KGlkeCk7CiAgICAgICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgICAgICBwcm94aWVkLmFwcGx5KHRoaXMsIEFycmF5LnByb3RvdHlwZS5zbGljZS5jYWxsKGFyZ3VtZW50cykpOwogICAgICAgICAgICAgICAgfTsKICAgICAgICAgICAgfQogICAgICAgIHslIGVuZGlmICV9CgogICAgICAgIHJldHVybiB7CiAgICAgICAgICAgIGhhc0NsYXNzOiBoYXNDbGFzcywKCiAgICAgICAgICAgIHJlbW92ZUNsYXNzOiByZW1vdmVDbGFzcywKCiAgICAgICAgICAgIGFkZENsYXNzOiBhZGRDbGFzcywKCiAgICAgICAgICAgIHRvZ2dsZUNsYXNzOiB0b2dnbGVDbGFzcywKCiAgICAgICAgICAgIGdldFByZWZlcmVuY2U6IGdldFByZWZlcmVuY2UsCgogICAgICAgICAgICBzZXRQcmVmZXJlbmNlOiBzZXRQcmVmZXJlbmNlLAoKICAgICAgICAgICAgYWRkRXZlbnRMaXN0ZW5lcjogYWRkRXZlbnRMaXN0ZW5lciwKCiAgICAgICAgICAgIHJlcXVlc3Q6IHJlcXVlc3QsCgogICAgICAgICAgICByZW5kZXJBamF4UmVxdWVzdHM6IHJlbmRlckFqYXhSZXF1ZXN0cywKCiAgICAgICAgICAgIGdldFNmd2R0OiBmdW5jdGlvbih0b2tlbikgewogICAgICAgICAgICAgICAgaWYgKCF0aGlzLnNmd2R0KSB7CiAgICAgICAgICAgICAgICAgICAgdGhpcy5zZndkdCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdzZndkdCcgKyB0b2tlbik7CiAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuc2Z3ZHQ7CiAgICAgICAgICAgIH0sCgogICAgICAgICAgICBsb2FkOiBmdW5jdGlvbihzZWxlY3RvciwgdXJsLCBvblN1Y2Nlc3MsIG9uRXJyb3IsIG9wdGlvbnMpIHsKICAgICAgICAgICAgICAgIHZhciBlbCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKHNlbGVjdG9yKTsKCiAgICAgICAgICAgICAgICBpZiAoZWwgJiYgZWwuZ2V0QXR0cmlidXRlKCdkYXRhLXNmdXJsJykgIT09IHVybCkgewogICAgICAgICAgICAgICAgICAgIHJlcXVlc3QoCiAgICAgICAgICAgICAgICAgICAgICAgIHVybCwKICAgICAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24oeGhyKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbC5pbm5lckhUTUwgPSB4aHIucmVzcG9uc2VUZXh0OwogICAgICAgICAgICAgICAgICAgICAgICAgICAgZWwuc2V0QXR0cmlidXRlKCdkYXRhLXNmdXJsJywgdXJsKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlbW92ZUNsYXNzKGVsLCAnbG9hZGluZycpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHBlbmRpbmcgPSBwZW5kaW5nUmVxdWVzdHM7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHJlcXVlc3RTdGFjay5sZW5ndGg7IGkrKykgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN0YXJ0QWpheFJlcXVlc3QoaSk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHJlcXVlc3RTdGFja1tpXS5kdXJhdGlvbikgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmaW5pc2hBamF4UmVxdWVzdChpKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvKiBSZXZlcnQgdGhlIHBlbmRpbmcgc3RhdGUgaW4gY2FzZSB0aGVyZSB3YXMgYSBzdGFydCBjYWxsZWQgd2l0aG91dCBhIGZpbmlzaCBhYm92ZS4gKi8KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBlbmRpbmdSZXF1ZXN0cyA9IHBlbmRpbmc7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAob25TdWNjZXNzIHx8IG5vb3ApKHhociwgZWwpOwogICAgICAgICAgICAgICAgICAgICAgICB9LAogICAgICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbih4aHIpIHsgKG9uRXJyb3IgfHwgbm9vcCkoeGhyLCBlbCk7IH0sCiAgICAgICAgICAgICAgICAgICAgICAgICcnLAogICAgICAgICAgICAgICAgICAgICAgICBvcHRpb25zCiAgICAgICAgICAgICAgICAgICAgKTsKICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICByZXR1cm4gdGhpczsKICAgICAgICAgICAgfSwKCiAgICAgICAgICAgIHNob3dUb29sYmFyOiBmdW5jdGlvbih0b2tlbikgewogICAgICAgICAgICAgICAgdmFyIHNmd2R0ID0gdGhpcy5nZXRTZndkdCh0b2tlbik7CiAgICAgICAgICAgICAgICByZW1vdmVDbGFzcyhzZndkdCwgJ3NmLWRpc3BsYXktbm9uZScpOwoKICAgICAgICAgICAgICAgIGlmIChnZXRQcmVmZXJlbmNlKCd0b29sYmFyL2Rpc3BsYXlTdGF0ZScpID09ICdub25lJykgewogICAgICAgICAgICAgICAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdzZlRvb2xiYXJNYWluQ29udGVudC0nICsgdG9rZW4pLnN0eWxlLmRpc3BsYXkgPSAnbm9uZSc7CiAgICAgICAgICAgICAgICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3NmVG9vbGJhckNsZWFyZXItJyArIHRva2VuKS5zdHlsZS5kaXNwbGF5ID0gJ25vbmUnOwogICAgICAgICAgICAgICAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdzZk1pbmlUb29sYmFyLScgKyB0b2tlbikuc3R5bGUuZGlzcGxheSA9ICdibG9jayc7CiAgICAgICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdzZlRvb2xiYXJNYWluQ29udGVudC0nICsgdG9rZW4pLnN0eWxlLmRpc3BsYXkgPSAnYmxvY2snOwogICAgICAgICAgICAgICAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdzZlRvb2xiYXJDbGVhcmVyLScgKyB0b2tlbikuc3R5bGUuZGlzcGxheSA9ICdibG9jayc7CiAgICAgICAgICAgICAgICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3NmTWluaVRvb2xiYXItJyArIHRva2VuKS5zdHlsZS5kaXNwbGF5ID0gJ25vbmUnOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9LAoKICAgICAgICAgICAgaGlkZVRvb2xiYXI6IGZ1bmN0aW9uKHRva2VuKSB7CiAgICAgICAgICAgICAgICB2YXIgc2Z3ZHQgPSB0aGlzLmdldFNmd2R0KHRva2VuKTsKICAgICAgICAgICAgICAgIGFkZENsYXNzKHNmd2R0LCAnc2YtZGlzcGxheS1ub25lJyk7CiAgICAgICAgICAgIH0sCgogICAgICAgICAgICBpbml0VG9vbGJhcjogZnVuY3Rpb24odG9rZW4pIHsKICAgICAgICAgICAgICAgIHRoaXMuc2hvd1Rvb2xiYXIodG9rZW4pOwoKICAgICAgICAgICAgICAgIHZhciBoaWRlQnV0dG9uID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3NmVG9vbGJhckhpZGVCdXR0b24tJyArIHRva2VuKTsKICAgICAgICAgICAgICAgIHZhciBoaWRlQnV0dG9uU3ZnID0gaGlkZUJ1dHRvbi5xdWVyeVNlbGVjdG9yKCdzdmcnKTsKICAgICAgICAgICAgICAgIGhpZGVCdXR0b25Tdmcuc2V0QXR0cmlidXRlKCdhcmlhLWhpZGRlbicsICd0cnVlJyk7CiAgICAgICAgICAgICAgICBoaWRlQnV0dG9uU3ZnLnNldEF0dHJpYnV0ZSgnZm9jdXNhYmxlJywgJ2ZhbHNlJyk7CiAgICAgICAgICAgICAgICBhZGRFdmVudExpc3RlbmVyKGhpZGVCdXR0b24sICdjbGljaycsIGZ1bmN0aW9uIChldmVudCkgewogICAgICAgICAgICAgICAgICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7CgogICAgICAgICAgICAgICAgICAgIHZhciBwID0gdGhpcy5wYXJlbnROb2RlOwogICAgICAgICAgICAgICAgICAgIHAuc3R5bGUuZGlzcGxheSA9ICdub25lJzsKICAgICAgICAgICAgICAgICAgICAocC5wcmV2aW91c0VsZW1lbnRTaWJsaW5nIHx8IHAucHJldmlvdXNTaWJsaW5nKS5zdHlsZS5kaXNwbGF5ID0gJ25vbmUnOwogICAgICAgICAgICAgICAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdzZk1pbmlUb29sYmFyLScgKyB0b2tlbikuc3R5bGUuZGlzcGxheSA9ICdibG9jayc7CiAgICAgICAgICAgICAgICAgICAgc2V0UHJlZmVyZW5jZSgndG9vbGJhci9kaXNwbGF5U3RhdGUnLCAnbm9uZScpOwogICAgICAgICAgICAgICAgfSk7CgogICAgICAgICAgICAgICAgdmFyIHNob3dCdXR0b24gPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnc2ZUb29sYmFyTWluaVRvZ2dsZXItJyArIHRva2VuKTsKICAgICAgICAgICAgICAgIHZhciBzaG93QnV0dG9uU3ZnID0gc2hvd0J1dHRvbi5xdWVyeVNlbGVjdG9yKCdzdmcnKTsKICAgICAgICAgICAgICAgIHNob3dCdXR0b25Tdmcuc2V0QXR0cmlidXRlKCdhcmlhLWhpZGRlbicsICd0cnVlJyk7CiAgICAgICAgICAgICAgICBzaG93QnV0dG9uU3ZnLnNldEF0dHJpYnV0ZSgnZm9jdXNhYmxlJywgJ2ZhbHNlJyk7CiAgICAgICAgICAgICAgICBhZGRFdmVudExpc3RlbmVyKHNob3dCdXR0b24sICdjbGljaycsIGZ1bmN0aW9uIChldmVudCkgewogICAgICAgICAgICAgICAgICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7CgogICAgICAgICAgICAgICAgICAgIHZhciBlbGVtID0gdGhpcy5wYXJlbnROb2RlOwogICAgICAgICAgICAgICAgICAgIGlmIChlbGVtLnN0eWxlLmRpc3BsYXkgPT0gJ25vbmUnKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdzZlRvb2xiYXJNYWluQ29udGVudC0nICsgdG9rZW4pLnN0eWxlLmRpc3BsYXkgPSAnbm9uZSc7CiAgICAgICAgICAgICAgICAgICAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdzZlRvb2xiYXJDbGVhcmVyLScgKyB0b2tlbikuc3R5bGUuZGlzcGxheSA9ICdub25lJzsKICAgICAgICAgICAgICAgICAgICAgICAgZWxlbS5zdHlsZS5kaXNwbGF5ID0gJ2Jsb2NrJzsKICAgICAgICAgICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgICAgICAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnc2ZUb29sYmFyTWFpbkNvbnRlbnQtJyArIHRva2VuKS5zdHlsZS5kaXNwbGF5ID0gJ2Jsb2NrJzsKICAgICAgICAgICAgICAgICAgICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3NmVG9vbGJhckNsZWFyZXItJyArIHRva2VuKS5zdHlsZS5kaXNwbGF5ID0gJ2Jsb2NrJzsKICAgICAgICAgICAgICAgICAgICAgICAgZWxlbS5zdHlsZS5kaXNwbGF5ID0gJ25vbmUnCiAgICAgICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgICAgICBzZXRQcmVmZXJlbmNlKCd0b29sYmFyL2Rpc3BsYXlTdGF0ZScsICdibG9jaycpOwogICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgIH0sCgogICAgICAgICAgICBsb2FkVG9vbGJhcjogZnVuY3Rpb24odG9rZW4sIG5ld1Rva2VuKSB7CiAgICAgICAgICAgICAgICB2YXIgdGhhdCA9IHRoaXM7CiAgICAgICAgICAgICAgICB2YXIgdHJpZXNDb3VudGVyID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3NmTG9hZENvdW50ZXItJyArIHRva2VuKTsKCiAgICAgICAgICAgICAgICB2YXIgb3B0aW9ucyA9IHsKICAgICAgICAgICAgICAgICAgICByZXRyeTogdHJ1ZSwKICAgICAgICAgICAgICAgICAgICBvblNlbmQ6IGZ1bmN0aW9uIChjb3VudCkgewogICAgICAgICAgICAgICAgICAgICAgICBpZiAoY291bnQgPT09IDMpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoYXQuaW5pdFRvb2xiYXIodG9rZW4pOwogICAgICAgICAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgICAgICAgICBpZiAodHJpZXNDb3VudGVyKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0cmllc0NvdW50ZXIudGV4dENvbnRlbnQgPSBjb3VudDsKICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIH0sCiAgICAgICAgICAgICAgICB9OwoKICAgICAgICAgICAgICAgIHZhciBjYW5jZWxCdXR0b24gPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnc2ZMb2FkQ2FuY2VsLScgKyB0b2tlbik7CiAgICAgICAgICAgICAgICBpZiAoY2FuY2VsQnV0dG9uKSB7CiAgICAgICAgICAgICAgICAgICAgYWRkRXZlbnRMaXN0ZW5lcihjYW5jZWxCdXR0b24sICdjbGljaycsIGZ1bmN0aW9uIChldmVudCkgewogICAgICAgICAgICAgICAgICAgICAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpOwoKICAgICAgICAgICAgICAgICAgICAgICAgb3B0aW9ucy5zdG9wID0gdHJ1ZTsKICAgICAgICAgICAgICAgICAgICAgICAgdGhhdC5oaWRlVG9vbGJhcih0b2tlbik7CiAgICAgICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgbmV3VG9rZW4gPSAobmV3VG9rZW4gfHwgdG9rZW4pOwoKICAgICAgICAgICAgICAgIHRoaXMubG9hZCgKICAgICAgICAgICAgICAgICAgICAnc2Z3ZHQnICsgdG9rZW4sCiAgICAgICAgICAgICAgICAgICAgJ3t7IHVybChcIl93ZHRcIiwgeyBcInRva2VuXCI6IFwieHh4eHh4XCIgfSl8ZXNjYXBlKCdqcycpIH19Jy5yZXBsYWNlKC94eHh4eHgvLCBuZXdUb2tlbiksCiAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24oeGhyLCBlbCkgewogICAgICAgICAgICAgICAgICAgICAgICAvKiBEbyBub3RoaW5nIGluIHRoZSBlZGdlIGNhc2Ugd2hlcmUgdGhlIHRvb2xiYXIgaGFzIGFscmVhZHkgYmVlbiByZXBsYWNlZCB3aXRoIGEgbmV3IG9uZSAqLwogICAgICAgICAgICAgICAgICAgICAgICBpZiAoIWRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdzZlRvb2xiYXJNYWluQ29udGVudC0nICsgbmV3VG9rZW4pKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm47CiAgICAgICAgICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICAgICAgICAgIC8qIEV2YWx1YXRlIGluIGdsb2JhbCBzY29wZSBzY3JpcHRzIGVtYmVkZGVkIGluc2lkZSB0aGUgdG9vbGJhciAqLwogICAgICAgICAgICAgICAgICAgICAgICB2YXIgaSwgc2NyaXB0cyA9IFtdLnNsaWNlLmNhbGwoZWwucXVlcnlTZWxlY3RvckFsbCgnc2NyaXB0JykpOwogICAgICAgICAgICAgICAgICAgICAgICBmb3IgKGkgPSAwOyBpIDwgc2NyaXB0cy5sZW5ndGg7ICsraSkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgZXZhbC5jYWxsKHt9LCBzY3JpcHRzW2ldLmZpcnN0Q2hpbGQubm9kZVZhbHVlKTsKICAgICAgICAgICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgICAgICAgICAgZWwuc3R5bGUuZGlzcGxheSA9IC0xICE9PSB4aHIucmVzcG9uc2VUZXh0LmluZGV4T2YoJ3NmLXRvb2xiYXJyZXNldCcpID8gJ2Jsb2NrJyA6ICdub25lJzsKCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChlbC5zdHlsZS5kaXNwbGF5ID09ICdub25lJykgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuOwogICAgICAgICAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgICAgICAgICB0aGF0LmluaXRUb29sYmFyKG5ld1Rva2VuKTsKCiAgICAgICAgICAgICAgICAgICAgICAgIC8qIEhhbmRsZSB0b29sYmFyLWluZm8gcG9zaXRpb24gKi8KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHRvb2xiYXJCbG9ja3MgPSBbXS5zbGljZS5jYWxsKGVsLnF1ZXJ5U2VsZWN0b3JBbGwoJy5zZi10b29sYmFyLWJsb2NrJykpOwogICAgICAgICAgICAgICAgICAgICAgICBmb3IgKGkgPSAwOyBpIDwgdG9vbGJhckJsb2Nrcy5sZW5ndGg7ICsraSkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgdG9vbGJhckJsb2Nrc1tpXS5vbm1vdXNlb3ZlciA9IGZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgdG9vbGJhckluZm8gPSB0aGlzLnF1ZXJ5U2VsZWN0b3JBbGwoJy5zZi10b29sYmFyLWluZm8nKVswXTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgcGFnZVdpZHRoID0gZG9jdW1lbnQuYm9keS5jbGllbnRXaWR0aDsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgZWxlbWVudFdpZHRoID0gdG9vbGJhckluZm8ub2Zmc2V0V2lkdGg7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGxlZnRWYWx1ZSA9IChlbGVtZW50V2lkdGggKyB0aGlzLm9mZnNldExlZnQpIC0gcGFnZVdpZHRoOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciByaWdodFZhbHVlID0gKGVsZW1lbnRXaWR0aCArIChwYWdlV2lkdGggLSB0aGlzLm9mZnNldExlZnQpKSAtIHBhZ2VXaWR0aDsKCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLyogUmVzZXQgcmlnaHQgYW5kIGxlZnQgdmFsdWUsIHVzZWZ1bCBvbiB3aW5kb3cgcmVzaXplICovCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdG9vbGJhckluZm8uc3R5bGUucmlnaHQgPSAnJzsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0b29sYmFySW5mby5zdHlsZS5sZWZ0ID0gJyc7CgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChlbGVtZW50V2lkdGggPiBwYWdlV2lkdGgpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdG9vbGJhckluZm8uc3R5bGUubGVmdCA9IDA7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVsc2UgaWYgKGxlZnRWYWx1ZSA+IDAgJiYgcmlnaHRWYWx1ZSA+IDApIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdG9vbGJhckluZm8uc3R5bGUucmlnaHQgPSAocmlnaHRWYWx1ZSAqIC0xKSArICdweCc7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmIChsZWZ0VmFsdWUgPCAwKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRvb2xiYXJJbmZvLnN0eWxlLmxlZnQgPSAwOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRvb2xiYXJJbmZvLnN0eWxlLnJpZ2h0ID0gJzBweCc7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfTsKICAgICAgICAgICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgICAgICAgICAgcmVuZGVyQWpheFJlcXVlc3RzKCk7CiAgICAgICAgICAgICAgICAgICAgICAgIGFkZEV2ZW50TGlzdGVuZXIoZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLnNmLXRvb2xiYXItYWpheC1jbGVhcicpLCAnY2xpY2snLCBmdW5jdGlvbigpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlcXVlc3RTdGFjayA9IFtdOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVuZGVyQWpheFJlcXVlc3RzKCk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdWNjZXNzU3RyZWFrID0gNDsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5zZi10b29sYmFyLWFqYXgtcmVxdWVzdC1saXN0JykuaW5uZXJIVE1MID0gJyc7CiAgICAgICAgICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgICAgICAgICBhZGRFdmVudExpc3RlbmVyKGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5zZi10b29sYmFyLWJsb2NrLWFqYXgnKSwgJ21vdXNlZW50ZXInLCBmdW5jdGlvbiAoZXZlbnQpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBlbGVtID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLnNmLXRvb2xiYXItYmxvY2stYWpheCAuc2YtdG9vbGJhci1pbmZvJyk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbGVtLnNjcm9sbFRvcCA9IGVsZW0uc2Nyb2xsSGVpZ2h0OwogICAgICAgICAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgICAgICAgICAgYWRkRXZlbnRMaXN0ZW5lcihkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuc2YtdG9vbGJhci1ibG9jay1hamF4ID4gLnNmLXRvb2xiYXItaWNvbicpLCAnY2xpY2snLCBmdW5jdGlvbiAoZXZlbnQpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7CgogICAgICAgICAgICAgICAgICAgICAgICAgICAgdG9nZ2xlQ2xhc3ModGhpcy5wYXJlbnROb2RlLCAnaG92ZXInKTsKICAgICAgICAgICAgICAgICAgICAgICAgfSk7CgogICAgICAgICAgICAgICAgICAgICAgICB2YXIgZHVtcEluZm8gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuc2YtdG9vbGJhci1ibG9jay1kdW1wIC5zZi10b29sYmFyLWluZm8nKTsKICAgICAgICAgICAgICAgICAgICAgICAgaWYgKG51bGwgIT09IGR1bXBJbmZvKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhZGRFdmVudExpc3RlbmVyKGR1bXBJbmZvLCAnc2ZiZWZvcmVkdW1wY29sbGFwc2UnLCBmdW5jdGlvbiAoKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZHVtcEluZm8uc3R5bGUubWluSGVpZ2h0ID0gZHVtcEluZm8uZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCkuaGVpZ2h0KydweCc7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFkZEV2ZW50TGlzdGVuZXIoZHVtcEluZm8sICdtb3VzZWxlYXZlJywgZnVuY3Rpb24gKCkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGR1bXBJbmZvLnN0eWxlLm1pbkhlaWdodCA9ICcnOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICB9LAogICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uKHhocikgewogICAgICAgICAgICAgICAgICAgICAgICBpZiAoeGhyLnN0YXR1cyAhPT0gMCAmJiAhb3B0aW9ucy5zdG9wKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgc2Z3ZHQgPSB0aGF0LmdldFNmd2R0KHRva2VuKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNmd2R0LmlubmVySFRNTCA9ICdcXAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9XCJzZi10b29sYmFycmVzZXRcIj5cXAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPVwic2YtdG9vbGJhci1pY29uXCI+PHN2ZyB3aWR0aD1cIjI2XCIgaGVpZ2h0PVwiMjhcIiB4bWxucz1cImh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnXCIgdmVyc2lvbj1cIjEuMVwiIHg9XCIwcHhcIiB5PVwiMHB4XCIgdmlld0JveD1cIjAgMCAyNiAyOFwiIGVuYWJsZS1iYWNrZ3JvdW5kPVwibmV3IDAgMCAyNiAyOFwiIHhtbDpzcGFjZT1cInByZXNlcnZlXCI+PHBhdGggZmlsbD1cIiNGRkZGRkZcIiBkPVwiTTEzIDBDNS44IDAgMCA1LjggMCAxM2MwIDcuMiA1LjggMTMgMTMgMTNjNy4yIDAgMTMtNS44IDEzLTEzQzI2IDUuOCAyMC4yIDAgMTMgMHogTTIwIDcuNSBjLTAuNiAwLTEtMC4zLTEtMC45YzAtMC4yIDAtMC40IDAuMi0wLjZjMC4xLTAuMyAwLjItMC4zIDAuMi0wLjRjMC0wLjMtMC41LTAuNC0wLjctMC40Yy0yIDAuMS0yLjUgMi43LTIuOSA0LjhsLTAuMiAxLjEgYzEuMSAwLjIgMS45IDAgMi40LTAuM2MwLjYtMC40LTAuMi0wLjgtMC4xLTEuM0MxOCA5LjIgMTguNCA5IDE4LjcgOC45YzAuNSAwIDAuOCAwLjUgMC44IDFjMCAwLjgtMS4xIDItMy4zIDEuOSBjLTAuMyAwLTAuNSAwLTAuNy0wLjFMMTUgMTQuMWMtMC40IDEuNy0wLjkgNC4xLTIuNiA2LjJjLTEuNSAxLjgtMy4xIDIuMS0zLjggMi4xYy0xLjMgMC0yLjEtMC42LTIuMi0xLjZjMC0wLjkgMC44LTEuNCAxLjMtMS40IGMwLjcgMCAxLjIgMC41IDEuMiAxLjFjMCAwLjUtMC4yIDAuNi0wLjQgMC43Yy0wLjEgMC4xLTAuMyAwLjItMC4zIDAuNGMwIDAuMSAwLjEgMC4zIDAuNCAwLjNjMC41IDAgMC45LTAuMyAxLjItMC41IGMxLjMtMSAxLjctMi45IDIuNC02LjJsMC4xLTAuOGMwLjItMS4xIDAuNS0yLjMgMC44LTMuNWMtMC45LTAuNy0xLjQtMS41LTIuNi0xLjhjLTAuOC0wLjItMS4zIDAtMS43IDAuNEM4LjQgMTAgOC42IDEwLjcgOSAxMS4xIGwwLjcgMC43YzAuOCAwLjkgMS4zIDEuNyAxLjEgMi43Yy0wLjMgMS42LTIuMSAyLjgtNC4zIDIuMWMtMS45LTAuNi0yLjItMS45LTItMi43YzAuMi0wLjYgMC43LTAuOCAxLjItMC42IGMwLjUgMC4yIDAuNyAwLjggMC42IDEuM2MwIDAuMSAwIDAuMS0wLjEgMC4zQzYgMTUgNS45IDE1LjIgNS45IDE1LjNjLTAuMSAwLjQgMC40IDAuNyAwLjggMC44YzAuOCAwLjMgMS43LTAuMiAxLjktMC45IGMwLjItMC42LTAuMi0xLjEtMC40LTEuMmwtMC44LTAuOWMtMC40LTAuNC0xLjItMS41LTAuOC0yLjhjMC4yLTAuNSAwLjUtMSAwLjktMS40YzEtMC43IDItMC44IDMtMC42YzEuMyAwLjQgMS45IDEuMiAyLjggMS45IGMwLjUtMS4zIDEuMS0yLjYgMi0zLjhjMC45LTEgMi0xLjcgMy4zLTEuOEMyMCA0LjggMjEgNS40IDIxIDYuM0MyMSA2LjcgMjAuOCA3LjUgMjAgNy41elwiLz48L3N2Zz48L2Rpdj5cXAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBBbiBlcnJvciBvY2N1cnJlZCB3aGlsZSBsb2FkaW5nIHRoZSB3ZWIgZGVidWcgdG9vbGJhci4gPGEgaHJlZj1cInt7IHVybChcIl9wcm9maWxlcl9ob21lXCIpfGVzY2FwZSgnanMnKSB9fScgKyBuZXdUb2tlbiArICdcIj5PcGVuIHRoZSB3ZWIgcHJvZmlsZXIuPC9hPlxcCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPC9kaXY+XFwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICc7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzZndkdC5zZXRBdHRyaWJ1dGUoJ2NsYXNzJywgJ3NmLXRvb2xiYXIgc2YtZXJyb3ItdG9vbGJhcicpOwogICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgICAgICAgICBvcHRpb25zCiAgICAgICAgICAgICAgICApOwoKICAgICAgICAgICAgICAgIHJldHVybiB0aGlzOwogICAgICAgICAgICB9LAoKICAgICAgICAgICAgdG9nZ2xlOiBmdW5jdGlvbihzZWxlY3RvciwgZWxPbiwgZWxPZmYpIHsKICAgICAgICAgICAgICAgIHZhciB0bXAgPSBlbE9uLnN0eWxlLmRpc3BsYXksCiAgICAgICAgICAgICAgICAgICAgZWwgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChzZWxlY3Rvcik7CgogICAgICAgICAgICAgICAgZWxPbi5zdHlsZS5kaXNwbGF5ID0gZWxPZmYuc3R5bGUuZGlzcGxheTsKICAgICAgICAgICAgICAgIGVsT2ZmLnN0eWxlLmRpc3BsYXkgPSB0bXA7CgogICAgICAgICAgICAgICAgaWYgKGVsKSB7CiAgICAgICAgICAgICAgICAgICAgZWwuc3R5bGUuZGlzcGxheSA9ICdub25lJyA9PT0gdG1wID8gJ25vbmUnIDogJ2Jsb2NrJzsKICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICByZXR1cm4gdGhpczsKICAgICAgICAgICAgfSwKCiAgICAgICAgICAgIGNyZWF0ZVRhYnM6IGZ1bmN0aW9uKCkgewogICAgICAgICAgICAgICAgdmFyIHRhYkdyb3VwcyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJy5zZi10YWJzOm5vdChbZGF0YS1wcm9jZXNzZWQ9dHJ1ZV0pJyk7CgogICAgICAgICAgICAgICAgLyogY3JlYXRlIHRoZSB0YWIgbmF2aWdhdGlvbiBmb3IgZWFjaCBncm91cCBvZiB0YWJzICovCiAgICAgICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHRhYkdyb3Vwcy5sZW5ndGg7IGkrKykgewogICAgICAgICAgICAgICAgICAgIHZhciB0YWJzID0gdGFiR3JvdXBzW2ldLnF1ZXJ5U2VsZWN0b3JBbGwoJzpzY29wZSA+IC50YWInKTsKICAgICAgICAgICAgICAgICAgICB2YXIgdGFiTmF2aWdhdGlvbiA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3VsJyk7CiAgICAgICAgICAgICAgICAgICAgdGFiTmF2aWdhdGlvbi5jbGFzc05hbWUgPSAndGFiLW5hdmlnYXRpb24nOwoKICAgICAgICAgICAgICAgICAgICB2YXIgc2VsZWN0ZWRUYWJJZCA9ICd0YWItJyArIGkgKyAnLTAnOyAvKiBzZWxlY3QgdGhlIGZpcnN0IHRhYiBieSBkZWZhdWx0ICovCiAgICAgICAgICAgICAgICAgICAgZm9yICh2YXIgaiA9IDA7IGogPCB0YWJzLmxlbmd0aDsgaisrKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIHZhciB0YWJJZCA9ICd0YWItJyArIGkgKyAnLScgKyBqOwogICAgICAgICAgICAgICAgICAgICAgICB2YXIgdGFiVGl0bGUgPSB0YWJzW2pdLnF1ZXJ5U2VsZWN0b3IoJy50YWItdGl0bGUnKS5pbm5lckhUTUw7CgogICAgICAgICAgICAgICAgICAgICAgICB2YXIgdGFiTmF2aWdhdGlvbkl0ZW0gPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdsaScpOwogICAgICAgICAgICAgICAgICAgICAgICB0YWJOYXZpZ2F0aW9uSXRlbS5zZXRBdHRyaWJ1dGUoJ2RhdGEtdGFiLWlkJywgdGFiSWQpOwogICAgICAgICAgICAgICAgICAgICAgICBpZiAoaGFzQ2xhc3ModGFic1tqXSwgJ2FjdGl2ZScpKSB7IHNlbGVjdGVkVGFiSWQgPSB0YWJJZDsgfQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoaGFzQ2xhc3ModGFic1tqXSwgJ2Rpc2FibGVkJykpIHsgYWRkQ2xhc3ModGFiTmF2aWdhdGlvbkl0ZW0sICdkaXNhYmxlZCcpOyB9CiAgICAgICAgICAgICAgICAgICAgICAgIHRhYk5hdmlnYXRpb25JdGVtLmlubmVySFRNTCA9IHRhYlRpdGxlOwogICAgICAgICAgICAgICAgICAgICAgICB0YWJOYXZpZ2F0aW9uLmFwcGVuZENoaWxkKHRhYk5hdmlnYXRpb25JdGVtKTsKCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciB0YWJDb250ZW50ID0gdGFic1tqXS5xdWVyeVNlbGVjdG9yKCcudGFiLWNvbnRlbnQnKTsKICAgICAgICAgICAgICAgICAgICAgICAgdGFiQ29udGVudC5wYXJlbnRFbGVtZW50LnNldEF0dHJpYnV0ZSgnaWQnLCB0YWJJZCk7CiAgICAgICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgICAgICB0YWJHcm91cHNbaV0uaW5zZXJ0QmVmb3JlKHRhYk5hdmlnYXRpb24sIHRhYkdyb3Vwc1tpXS5maXJzdENoaWxkKTsKICAgICAgICAgICAgICAgICAgICBhZGRDbGFzcyhkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCdbZGF0YS10YWItaWQ9XCInICsgc2VsZWN0ZWRUYWJJZCArICdcIl0nKSwgJ2FjdGl2ZScpOwogICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgIC8qIGRpc3BsYXkgdGhlIGFjdGl2ZSB0YWIgYW5kIGFkZCB0aGUgJ2NsaWNrJyBldmVudCBsaXN0ZW5lcnMgKi8KICAgICAgICAgICAgICAgIGZvciAoaSA9IDA7IGkgPCB0YWJHcm91cHMubGVuZ3RoOyBpKyspIHsKICAgICAgICAgICAgICAgICAgICB0YWJOYXZpZ2F0aW9uID0gdGFiR3JvdXBzW2ldLnF1ZXJ5U2VsZWN0b3JBbGwoJzpzY29wZSA+IC50YWItbmF2aWdhdGlvbiBsaScpOwoKICAgICAgICAgICAgICAgICAgICBmb3IgKGogPSAwOyBqIDwgdGFiTmF2aWdhdGlvbi5sZW5ndGg7IGorKykgewogICAgICAgICAgICAgICAgICAgICAgICB0YWJJZCA9IHRhYk5hdmlnYXRpb25bal0uZ2V0QXR0cmlidXRlKCdkYXRhLXRhYi1pZCcpOwogICAgICAgICAgICAgICAgICAgICAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCh0YWJJZCkucXVlcnlTZWxlY3RvcignLnRhYi10aXRsZScpLmNsYXNzTmFtZSA9ICdoaWRkZW4nOwoKICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGhhc0NsYXNzKHRhYk5hdmlnYXRpb25bal0sICdhY3RpdmUnKSkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQodGFiSWQpLmNsYXNzTmFtZSA9ICdibG9jayc7CiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCh0YWJJZCkuY2xhc3NOYW1lID0gJ2hpZGRlbic7CiAgICAgICAgICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICAgICAgICAgIHRhYk5hdmlnYXRpb25bal0uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBmdW5jdGlvbihlKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgYWN0aXZlVGFiID0gZS50YXJnZXQgfHwgZS5zcmNFbGVtZW50OwoKICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8qIG5lZWRlZCBiZWNhdXNlIHdoZW4gdGhlIHRhYiBjb250YWlucyBIVE1MIGNvbnRlbnRzLCB1c2VyIGNhbiBjbGljayAqLwogICAgICAgICAgICAgICAgICAgICAgICAgICAgLyogb24gYW55IG9mIHRob3NlIGVsZW1lbnRzIGluc3RlYWQgb2YgdGhlaXIgcGFyZW50ICc8bGk+JyBlbGVtZW50ICovCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB3aGlsZSAoYWN0aXZlVGFiLnRhZ05hbWUudG9Mb3dlckNhc2UoKSAhPT0gJ2xpJykgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFjdGl2ZVRhYiA9IGFjdGl2ZVRhYi5wYXJlbnROb2RlOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8qIGdldCB0aGUgZnVsbCBsaXN0IG9mIHRhYnMgdGhyb3VnaCB0aGUgcGFyZW50IG9mIHRoZSBhY3RpdmUgdGFiIGVsZW1lbnQgKi8KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciB0YWJOYXZpZ2F0aW9uID0gYWN0aXZlVGFiLnBhcmVudE5vZGUuY2hpbGRyZW47CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBmb3IgKHZhciBrID0gMDsgayA8IHRhYk5hdmlnYXRpb24ubGVuZ3RoOyBrKyspIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgdGFiSWQgPSB0YWJOYXZpZ2F0aW9uW2tdLmdldEF0dHJpYnV0ZSgnZGF0YS10YWItaWQnKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCh0YWJJZCkuY2xhc3NOYW1lID0gJ2hpZGRlbic7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVtb3ZlQ2xhc3ModGFiTmF2aWdhdGlvbltrXSwgJ2FjdGl2ZScpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFkZENsYXNzKGFjdGl2ZVRhYiwgJ2FjdGl2ZScpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGFjdGl2ZVRhYklkID0gYWN0aXZlVGFiLmdldEF0dHJpYnV0ZSgnZGF0YS10YWItaWQnKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKGFjdGl2ZVRhYklkKS5jbGFzc05hbWUgPSAnYmxvY2snOwogICAgICAgICAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgICAgIHRhYkdyb3Vwc1tpXS5zZXRBdHRyaWJ1dGUoJ2RhdGEtcHJvY2Vzc2VkJywgJ3RydWUnKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfSwKCiAgICAgICAgICAgIGNyZWF0ZVRvZ2dsZXM6IGZ1bmN0aW9uKCkgewogICAgICAgICAgICAgICAgdmFyIHRvZ2dsZXMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCcuc2YtdG9nZ2xlOm5vdChbZGF0YS1wcm9jZXNzZWQ9dHJ1ZV0pJyk7CgogICAgICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCB0b2dnbGVzLmxlbmd0aDsgaSsrKSB7CiAgICAgICAgICAgICAgICAgICAgdmFyIGVsZW1lbnRTZWxlY3RvciA9IHRvZ2dsZXNbaV0uZ2V0QXR0cmlidXRlKCdkYXRhLXRvZ2dsZS1zZWxlY3RvcicpOwogICAgICAgICAgICAgICAgICAgIHZhciBlbGVtZW50ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihlbGVtZW50U2VsZWN0b3IpOwoKICAgICAgICAgICAgICAgICAgICBhZGRDbGFzcyhlbGVtZW50LCAnc2YtdG9nZ2xlLWNvbnRlbnQnKTsKCiAgICAgICAgICAgICAgICAgICAgaWYgKHRvZ2dsZXNbaV0uaGFzQXR0cmlidXRlKCdkYXRhLXRvZ2dsZS1pbml0aWFsJykgJiYgdG9nZ2xlc1tpXS5nZXRBdHRyaWJ1dGUoJ2RhdGEtdG9nZ2xlLWluaXRpYWwnKSA9PSAnZGlzcGxheScpIHsKICAgICAgICAgICAgICAgICAgICAgICAgYWRkQ2xhc3ModG9nZ2xlc1tpXSwgJ3NmLXRvZ2dsZS1vbicpOwogICAgICAgICAgICAgICAgICAgICAgICBhZGRDbGFzcyhlbGVtZW50LCAnc2YtdG9nZ2xlLXZpc2libGUnKTsKICAgICAgICAgICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgICAgICAgICBhZGRDbGFzcyh0b2dnbGVzW2ldLCAnc2YtdG9nZ2xlLW9mZicpOwogICAgICAgICAgICAgICAgICAgICAgICBhZGRDbGFzcyhlbGVtZW50LCAnc2YtdG9nZ2xlLWhpZGRlbicpOwogICAgICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICAgICAgYWRkRXZlbnRMaXN0ZW5lcih0b2dnbGVzW2ldLCAnY2xpY2snLCBmdW5jdGlvbihlKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIGUucHJldmVudERlZmF1bHQoKTsKCiAgICAgICAgICAgICAgICAgICAgICAgIGlmICgnJyAhPT0gd2luZG93LmdldFNlbGVjdGlvbigpLnRvU3RyaW5nKCkpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8qIERvbid0IGRvIGFueXRoaW5nIG9uIHRleHQgc2VsZWN0aW9uICovCiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm47CiAgICAgICAgICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciB0b2dnbGUgPSBlLnRhcmdldCB8fCBlLnNyY0VsZW1lbnQ7CgogICAgICAgICAgICAgICAgICAgICAgICAvKiBuZWVkZWQgYmVjYXVzZSB3aGVuIHRoZSB0b2dnbGUgY29udGFpbnMgSFRNTCBjb250ZW50cywgdXNlciBjYW4gY2xpY2sgKi8KICAgICAgICAgICAgICAgICAgICAgICAgLyogb24gYW55IG9mIHRob3NlIGVsZW1lbnRzIGluc3RlYWQgb2YgdGhlaXIgcGFyZW50ICcuc2YtdG9nZ2xlJyBlbGVtZW50ICovCiAgICAgICAgICAgICAgICAgICAgICAgIHdoaWxlICghaGFzQ2xhc3ModG9nZ2xlLCAnc2YtdG9nZ2xlJykpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRvZ2dsZSA9IHRvZ2dsZS5wYXJlbnROb2RlOwogICAgICAgICAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgICAgICAgICB2YXIgZWxlbWVudCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IodG9nZ2xlLmdldEF0dHJpYnV0ZSgnZGF0YS10b2dnbGUtc2VsZWN0b3InKSk7CgogICAgICAgICAgICAgICAgICAgICAgICB0b2dnbGVDbGFzcyh0b2dnbGUsICdzZi10b2dnbGUtb24nKTsKICAgICAgICAgICAgICAgICAgICAgICAgdG9nZ2xlQ2xhc3ModG9nZ2xlLCAnc2YtdG9nZ2xlLW9mZicpOwogICAgICAgICAgICAgICAgICAgICAgICB0b2dnbGVDbGFzcyhlbGVtZW50LCAnc2YtdG9nZ2xlLWhpZGRlbicpOwogICAgICAgICAgICAgICAgICAgICAgICB0b2dnbGVDbGFzcyhlbGVtZW50LCAnc2YtdG9nZ2xlLXZpc2libGUnKTsKCiAgICAgICAgICAgICAgICAgICAgICAgIC8qIHRoZSB0b2dnbGUgZG9lc24ndCBjaGFuZ2UgaXRzIGNvbnRlbnRzIHdoZW4gY2xpY2tpbmcgb24gaXQgKi8KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCF0b2dnbGUuaGFzQXR0cmlidXRlKCdkYXRhLXRvZ2dsZS1hbHQtY29udGVudCcpKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm47CiAgICAgICAgICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICAgICAgICAgIGlmICghdG9nZ2xlLmhhc0F0dHJpYnV0ZSgnZGF0YS10b2dnbGUtb3JpZ2luYWwtY29udGVudCcpKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0b2dnbGUuc2V0QXR0cmlidXRlKCdkYXRhLXRvZ2dsZS1vcmlnaW5hbC1jb250ZW50JywgdG9nZ2xlLmlubmVySFRNTCk7CiAgICAgICAgICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBjdXJyZW50Q29udGVudCA9IHRvZ2dsZS5pbm5lckhUTUw7CiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBvcmlnaW5hbENvbnRlbnQgPSB0b2dnbGUuZ2V0QXR0cmlidXRlKCdkYXRhLXRvZ2dsZS1vcmlnaW5hbC1jb250ZW50Jyk7CiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBhbHRDb250ZW50ID0gdG9nZ2xlLmdldEF0dHJpYnV0ZSgnZGF0YS10b2dnbGUtYWx0LWNvbnRlbnQnKTsKICAgICAgICAgICAgICAgICAgICAgICAgdG9nZ2xlLmlubmVySFRNTCA9IGN1cnJlbnRDb250ZW50ICE9PSBhbHRDb250ZW50ID8gYWx0Q29udGVudCA6IG9yaWdpbmFsQ29udGVudDsKICAgICAgICAgICAgICAgICAgICB9KTsKCiAgICAgICAgICAgICAgICAgICAgLyogUHJldmVudHMgZnJvbSBkaXNhbGxvd2luZyBjbGlja3Mgb24gbGlua3MgaW5zaWRlIHRvZ2dsZXMgKi8KICAgICAgICAgICAgICAgICAgICB2YXIgdG9nZ2xlTGlua3MgPSB0b2dnbGVzW2ldLnF1ZXJ5U2VsZWN0b3JBbGwoJ2EnKTsKICAgICAgICAgICAgICAgICAgICBmb3IgKHZhciBqID0gMDsgaiA8IHRvZ2dsZUxpbmtzLmxlbmd0aDsgaisrKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIGFkZEV2ZW50TGlzdGVuZXIodG9nZ2xlTGlua3Nbal0sICdjbGljaycsIGZ1bmN0aW9uKGUpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGUuc3RvcFByb3BhZ2F0aW9uKCk7CiAgICAgICAgICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICAgICAgLyogUHJldmVudHMgZnJvbSBkaXNhbGxvd2luZyBjbGlja3Mgb24gXCJjb3B5IHRvIGNsaXBib2FyZFwiIGVsZW1lbnRzIGluc2lkZSB0b2dnbGVzICovCiAgICAgICAgICAgICAgICAgICAgdmFyIGNvcHlUb0NsaXBib2FyZEVsZW1lbnRzID0gdG9nZ2xlc1tpXS5xdWVyeVNlbGVjdG9yQWxsKCdzcGFuW2RhdGEtY2xpcGJvYXJkLXRleHRdJyk7CiAgICAgICAgICAgICAgICAgICAgZm9yICh2YXIgayA9IDA7IGsgPCBjb3B5VG9DbGlwYm9hcmRFbGVtZW50cy5sZW5ndGg7IGsrKykgewogICAgICAgICAgICAgICAgICAgICAgICBhZGRFdmVudExpc3RlbmVyKGNvcHlUb0NsaXBib2FyZEVsZW1lbnRzW2tdLCAnY2xpY2snLCBmdW5jdGlvbihlKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBlLnN0b3BQcm9wYWdhdGlvbigpOwogICAgICAgICAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgICAgIHRvZ2dsZXNbaV0uc2V0QXR0cmlidXRlKCdkYXRhLXByb2Nlc3NlZCcsICd0cnVlJyk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0sCgogICAgICAgICAgICBpbml0aWFsaXplTG9nc1RhYmxlOiBmdW5jdGlvbigpIHsKICAgICAgICAgICAgICAgIFNmanMudXBkYXRlTG9nc1RhYmxlKCk7CgogICAgICAgICAgICAgICAgZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnLmxvZy1maWx0ZXIgaW5wdXQnKS5mb3JFYWNoKChpbnB1dCkgPT4gewogICAgICAgICAgICAgICAgICAgIGlucHV0LmFkZEV2ZW50TGlzdGVuZXIoJ2NoYW5nZScsICgpID0+IHsgU2Zqcy51cGRhdGVMb2dzVGFibGUoKTsgfSk7CiAgICAgICAgICAgICAgICB9KTsKCiAgICAgICAgICAgICAgICBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCcuZmlsdGVyLXNlbGVjdC1hbGwtb3Itbm9uZSBidXR0b24nKS5mb3JFYWNoKChsaW5rKSA9PiB7CiAgICAgICAgICAgICAgICAgICAgbGluay5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsICgpID0+IHsKICAgICAgICAgICAgICAgICAgICAgICAgY29uc3Qgc2VsZWN0QWxsID0gbGluay5jbGFzc0xpc3QuY29udGFpbnMoJ3NlbGVjdC1hbGwnKTsKICAgICAgICAgICAgICAgICAgICAgICAgbGluay5jbG9zZXN0KCcubG9nLWZpbHRlci1jb250ZW50JykucXVlcnlTZWxlY3RvckFsbCgnaW5wdXQnKS5mb3JFYWNoKChpbnB1dCkgPT4gewogICAgICAgICAgICAgICAgICAgICAgICAgICAgaW5wdXQuY2hlY2tlZCA9IHNlbGVjdEFsbDsKICAgICAgICAgICAgICAgICAgICAgICAgfSk7CgogICAgICAgICAgICAgICAgICAgICAgICBTZmpzLnVwZGF0ZUxvZ3NUYWJsZSgpOwogICAgICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgfSk7CgogICAgICAgICAgICAgICAgZG9jdW1lbnQuYm9keS5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIChldmVudCkgPT4gewogICAgICAgICAgICAgICAgICAgIGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJ2RldGFpbHMubG9nLWZpbHRlcicpLmZvckVhY2goKGZpbHRlckVsZW1lbnQpID0+IHsKICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCFmaWx0ZXJFbGVtZW50LmNvbnRhaW5zKGV2ZW50LnRhcmdldCkgJiYgZmlsdGVyRWxlbWVudC5vcGVuKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBmaWx0ZXJFbGVtZW50Lm9wZW4gPSBmYWxzZTsKICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgIH0sCgogICAgICAgICAgICB1cGRhdGVMb2dzVGFibGU6IGZ1bmN0aW9uKCkgewogICAgICAgICAgICAgICAgY29uc3Qgc2VsZWN0ZWRUeXBlID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignI2xvZy1maWx0ZXItdHlwZSBpbnB1dDpjaGVja2VkJykudmFsdWU7CiAgICAgICAgICAgICAgICBjb25zdCBwcmlvcml0aWVzID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnI2xvZy1maWx0ZXItcHJpb3JpdHkgaW5wdXQnKTsKICAgICAgICAgICAgICAgIGNvbnN0IGFsbFByaW9yaXRpZXMgPSBBcnJheS5mcm9tKHByaW9yaXRpZXMpLm1hcCgoaW5wdXQpID0+IGlucHV0LnZhbHVlKTsKICAgICAgICAgICAgICAgIGNvbnN0IHNlbGVjdGVkUHJpb3JpdGllcyA9IEFycmF5LmZyb20ocHJpb3JpdGllcykuZmlsdGVyKChpbnB1dCkgPT4gaW5wdXQuY2hlY2tlZCkubWFwKChpbnB1dCkgPT4gaW5wdXQudmFsdWUpOwogICAgICAgICAgICAgICAgY29uc3QgY2hhbm5lbHMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCcjbG9nLWZpbHRlci1jaGFubmVsIGlucHV0Jyk7CiAgICAgICAgICAgICAgICBjb25zdCBzZWxlY3RlZENoYW5uZWxzID0gQXJyYXkuZnJvbShjaGFubmVscykuZmlsdGVyKChpbnB1dCkgPT4gaW5wdXQuY2hlY2tlZCkubWFwKChpbnB1dCkgPT4gaW5wdXQudmFsdWUpOwoKICAgICAgICAgICAgICAgIGNvbnN0IGxvZ3MgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCd0YWJsZS5sb2dzJyk7CiAgICAgICAgICAgICAgICBpZiAobnVsbCA9PT0gbG9ncykgewogICAgICAgICAgICAgICAgICAgIHJldHVybjsKICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICAvKiBoaWRlIHJvd3MgdGhhdCBkb24ndCBtYXRjaCB0aGUgY3VycmVudCBmaWx0ZXJzICovCiAgICAgICAgICAgICAgICBsZXQgbnVtVmlzaWJsZVJvd3MgPSAwOwogICAgICAgICAgICAgICAgbG9ncy5xdWVyeVNlbGVjdG9yQWxsKCd0Ym9keSB0cicpLmZvckVhY2goKHJvdykgPT4gewogICAgICAgICAgICAgICAgICAgIGlmICgnYWxsJyAhPT0gc2VsZWN0ZWRUeXBlICYmIHNlbGVjdGVkVHlwZSAhPT0gcm93LmdldEF0dHJpYnV0ZSgnZGF0YS10eXBlJykpIHsKICAgICAgICAgICAgICAgICAgICAgICAgcm93LnN0eWxlLmRpc3BsYXkgPSAnbm9uZSc7CiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybjsKICAgICAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgICAgIGNvbnN0IHByaW9yaXR5ID0gcm93LmdldEF0dHJpYnV0ZSgnZGF0YS1wcmlvcml0eScpOwogICAgICAgICAgICAgICAgICAgIGlmIChmYWxzZSA9PT0gc2VsZWN0ZWRQcmlvcml0aWVzLmluY2x1ZGVzKHByaW9yaXR5KSAmJiB0cnVlID09PSBhbGxQcmlvcml0aWVzLmluY2x1ZGVzKHByaW9yaXR5KSkgewogICAgICAgICAgICAgICAgICAgICAgICByb3cuc3R5bGUuZGlzcGxheSA9ICdub25lJzsKICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuOwogICAgICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICAgICAgaWYgKCcnICE9PSByb3cuZ2V0QXR0cmlidXRlKCdkYXRhLWNoYW5uZWwnKSAmJiBmYWxzZSA9PT0gc2VsZWN0ZWRDaGFubmVscy5pbmNsdWRlcyhyb3cuZ2V0QXR0cmlidXRlKCdkYXRhLWNoYW5uZWwnKSkpIHsKICAgICAgICAgICAgICAgICAgICAgICAgcm93LnN0eWxlLmRpc3BsYXkgPSAnbm9uZSc7CiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybjsKICAgICAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgICAgIHJvdy5zdHlsZS5kaXNwbGF5ID0gJ3RhYmxlLXJvdyc7CiAgICAgICAgICAgICAgICAgICAgbnVtVmlzaWJsZVJvd3MrKzsKICAgICAgICAgICAgICAgIH0pOwoKICAgICAgICAgICAgICAgIGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJ3RhYmxlLmxvZ3MnKS5zdHlsZS5kaXNwbGF5ID0gMCA9PT0gbnVtVmlzaWJsZVJvd3MgPyAnbm9uZScgOiAndGFibGUnOwogICAgICAgICAgICAgICAgZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLm5vLWxvZ3MtbWVzc2FnZScpLnN0eWxlLmRpc3BsYXkgPSAwID09PSBudW1WaXNpYmxlUm93cyA/ICdibG9jaycgOiAnbm9uZSc7CgogICAgICAgICAgICAgICAgLyogdXBkYXRlIHRoZSBzZWxlY3RlZCB0b3RhbHMgb2YgYWxsIGZpbHRlcnMgKi8KICAgICAgICAgICAgICAgIGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJyNsb2ctZmlsdGVyLXByaW9yaXR5IC5maWx0ZXItYWN0aXZlLW51bScpLmlubmVyVGV4dCA9IChwcmlvcml0aWVzLmxlbmd0aCA9PT0gc2VsZWN0ZWRQcmlvcml0aWVzLmxlbmd0aCkgPyAnQWxsJyA6IHNlbGVjdGVkUHJpb3JpdGllcy5sZW5ndGg7CiAgICAgICAgICAgICAgICBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcjbG9nLWZpbHRlci1jaGFubmVsIC5maWx0ZXItYWN0aXZlLW51bScpLmlubmVyVGV4dCA9IChjaGFubmVscy5sZW5ndGggPT09IHNlbGVjdGVkQ2hhbm5lbHMubGVuZ3RoKSA/ICdBbGwnIDogc2VsZWN0ZWRDaGFubmVscy5sZW5ndGg7CgogICAgICAgICAgICAgICAgLyogdXBkYXRlIHRoZSBjdXJyZW50bHkgc2VsZWN0ZWQgXCJsb2cgdHlwZVwiIHRhYiAqLwogICAgICAgICAgICAgICAgZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnI2xvZy1maWx0ZXItdHlwZSBsaScpLmZvckVhY2goKHRhYikgPT4gdGFiLmNsYXNzTGlzdC5yZW1vdmUoJ2FjdGl2ZScpKTsKICAgICAgICAgICAgICAgIGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoYCNsb2ctZmlsdGVyLXR5cGUgaW5wdXRbdmFsdWU9XCJcJHtzZWxlY3RlZFR5cGV9XCJdYCkucGFyZW50RWxlbWVudC5jbGFzc0xpc3QuYWRkKCdhY3RpdmUnKTsKICAgICAgICAgICAgfSwKICAgICAgICB9OwogICAgfSkoKTsKCiAgICBTZmpzLmFkZEV2ZW50TGlzdGVuZXIoZG9jdW1lbnQsICdET01Db250ZW50TG9hZGVkJywgZnVuY3Rpb24oKSB7CiAgICAgICAgU2Zqcy5jcmVhdGVUYWJzKCk7CiAgICAgICAgU2Zqcy5jcmVhdGVUb2dnbGVzKCk7CiAgICB9KTsKfQovKl1dPiovPC9zY3JpcHQ+CiIsICJAV2ViUHJvZmlsZXIvUHJvZmlsZXIvYmFzZV9qcy5odG1sLnR3aWciLCAiL0FwcGxpY2F0aW9ucy9YQU1QUC94YW1wcGZpbGVzL2h0ZG9jcy9tZWRpYXRla2Zvcm1hdGlvbi92ZW5kb3Ivc3ltZm9ueS93ZWItcHJvZmlsZXItYnVuZGxlL1Jlc291cmNlcy92aWV3cy9Qcm9maWxlci9iYXNlX2pzLmh0bWwudHdpZyIpOwogICAgfQp9CiI7czo0NToiAHBocERvY3VtZW50b3JcUmVmbGVjdGlvblxQaHBcRmlsZQBuYW1lc3BhY2VzIjthOjA6e31zOjQzOiIAcGhwRG9jdW1lbnRvclxSZWZsZWN0aW9uXFBocFxGaWxlAGluY2x1ZGVzIjthOjA6e31zOjQ0OiIAcGhwRG9jdW1lbnRvclxSZWZsZWN0aW9uXFBocFxGaWxlAGZ1bmN0aW9ucyI7YTowOnt9czo0NDoiAHBocERvY3VtZW50b3JcUmVmbGVjdGlvblxQaHBcRmlsZQBjb25zdGFudHMiO2E6MDp7fXM6NDI6IgBwaHBEb2N1bWVudG9yXFJlZmxlY3Rpb25cUGhwXEZpbGUAY2xhc3NlcyI7YToxOntzOjQ4OiJcX19Ud2lnVGVtcGxhdGVfNDljYjYxNmM3M2FkNGU2OWU5MmUzZDM2MzA2MDU1MGMiO086MzU6InBocERvY3VtZW50b3JcUmVmbGVjdGlvblxQaHBcQ2xhc3NfIjoxNDp7czo0MjoiAHBocERvY3VtZW50b3JcUmVmbGVjdGlvblxQaHBcQ2xhc3NfAGZxc2VuIjtPOjMwOiJwaHBEb2N1bWVudG9yXFJlZmxlY3Rpb25cRnFzZW4iOjI6e3M6Mzc6IgBwaHBEb2N1bWVudG9yXFJlZmxlY3Rpb25cRnFzZW4AZnFzZW4iO3M6NDg6IlxfX1R3aWdUZW1wbGF0ZV80OWNiNjE2YzczYWQ0ZTY5ZTkyZTNkMzYzMDYwNTUwYyI7czozNjoiAHBocERvY3VtZW50b3JcUmVmbGVjdGlvblxGcXNlbgBuYW1lIjtzOjQ3OiJfX1R3aWdUZW1wbGF0ZV80OWNiNjE2YzczYWQ0ZTY5ZTkyZTNkMzYzMDYwNTUwYyI7fXM6NDU6IgBwaHBEb2N1bWVudG9yXFJlZmxlY3Rpb25cUGhwXENsYXNzXwBkb2NCbG9jayI7TjtzOjQ1OiIAcGhwRG9jdW1lbnRvclxSZWZsZWN0aW9uXFBocFxDbGFzc18AcmVhZE9ubHkiO2I6MDtzOjQ1OiIAcGhwRG9jdW1lbnRvclxSZWZsZWN0aW9uXFBocFxDbGFzc18AYWJzdHJhY3QiO2I6MDtzOjQyOiIAcGhwRG9jdW1lbnRvclxSZWZsZWN0aW9uXFBocFxDbGFzc18AZmluYWwiO2I6MDtzOjQzOiIAcGhwRG9jdW1lbnRvclxSZWZsZWN0aW9uXFBocFxDbGFzc18AcGFyZW50IjtPOjMwOiJwaHBEb2N1bWVudG9yXFJlZmxlY3Rpb25cRnFzZW4iOjI6e3M6Mzc6IgBwaHBEb2N1bWVudG9yXFJlZmxlY3Rpb25cRnFzZW4AZnFzZW4iO3M6MTQ6IlxUd2lnXFRlbXBsYXRlIjtzOjM2OiIAcGhwRG9jdW1lbnRvclxSZWZsZWN0aW9uXEZxc2VuAG5hbWUiO3M6ODoiVGVtcGxhdGUiO31zOjQ3OiIAcGhwRG9jdW1lbnRvclxSZWZsZWN0aW9uXFBocFxDbGFzc18AaW1wbGVtZW50cyI7YTowOnt9czo0NjoiAHBocERvY3VtZW50b3JcUmVmbGVjdGlvblxQaHBcQ2xhc3NfAGNvbnN0YW50cyI7YTowOnt9czo0NzoiAHBocERvY3VtZW50b3JcUmVmbGVjdGlvblxQaHBcQ2xhc3NfAHByb3BlcnRpZXMiO2E6Mjp7czo1NzoiXF9fVHdpZ1RlbXBsYXRlXzQ5Y2I2MTZjNzNhZDRlNjllOTJlM2QzNjMwNjA1NTBjOjokc291cmNlIjtPOjM3OiJwaHBEb2N1bWVudG9yXFJlZmxlY3Rpb25cUGhwXFByb3BlcnR5IjoxMTp7czo0NDoiAHBocERvY3VtZW50b3JcUmVmbGVjdGlvblxQaHBcUHJvcGVydHkAZnFzZW4iO086MzA6InBocERvY3VtZW50b3JcUmVmbGVjdGlvblxGcXNlbiI6Mjp7czozNzoiAHBocERvY3VtZW50b3JcUmVmbGVjdGlvblxGcXNlbgBmcXNlbiI7czo1NzoiXF9fVHdpZ1RlbXBsYXRlXzQ5Y2I2MTZjNzNhZDRlNjllOTJlM2QzNjMwNjA1NTBjOjokc291cmNlIjtzOjM2OiIAcGhwRG9jdW1lbnRvclxSZWZsZWN0aW9uXEZxc2VuAG5hbWUiO3M6Njoic291cmNlIjt9czo0NzoiAHBocERvY3VtZW50b3JcUmVmbGVjdGlvblxQaHBcUHJvcGVydHkAZG9jQmxvY2siO047czo0NDoiAHBocERvY3VtZW50b3JcUmVmbGVjdGlvblxQaHBcUHJvcGVydHkAdHlwZXMiO2E6MDp7fXM6NDY6IgBwaHBEb2N1bWVudG9yXFJlZmxlY3Rpb25cUGhwXFByb3BlcnR5AGRlZmF1bHQiO047czo0NToiAHBocERvY3VtZW50b3JcUmVmbGVjdGlvblxQaHBcUHJvcGVydHkAc3RhdGljIjtiOjA7czo0OToiAHBocERvY3VtZW50b3JcUmVmbGVjdGlvblxQaHBcUHJvcGVydHkAdmlzaWJpbGl0eSI7TzozOToicGhwRG9jdW1lbnRvclxSZWZsZWN0aW9uXFBocFxWaXNpYmlsaXR5IjoxOntzOjUxOiIAcGhwRG9jdW1lbnRvclxSZWZsZWN0aW9uXFBocFxWaXNpYmlsaXR5AHZpc2liaWxpdHkiO3M6NzoicHJpdmF0ZSI7fXM6NDc6IgBwaHBEb2N1bWVudG9yXFJlZmxlY3Rpb25cUGhwXFByb3BlcnR5AGxvY2F0aW9uIjtPOjMzOiJwaHBEb2N1bWVudG9yXFJlZmxlY3Rpb25cTG9jYXRpb24iOjI6e3M6NDU6IgBwaHBEb2N1bWVudG9yXFJlZmxlY3Rpb25cTG9jYXRpb24AbGluZU51bWJlciI7aToxODtzOjQ3OiIAcGhwRG9jdW1lbnRvclxSZWZsZWN0aW9uXExvY2F0aW9uAGNvbHVtbk51bWJlciI7aTowO31zOjUwOiIAcGhwRG9jdW1lbnRvclxSZWZsZWN0aW9uXFBocFxQcm9wZXJ0eQBlbmRMb2NhdGlvbiI7TzozMzoicGhwRG9jdW1lbnRvclxSZWZsZWN0aW9uXExvY2F0aW9uIjoyOntzOjQ1OiIAcGhwRG9jdW1lbnRvclxSZWZsZWN0aW9uXExvY2F0aW9uAGxpbmVOdW1iZXIiO2k6MTg7czo0NzoiAHBocERvY3VtZW50b3JcUmVmbGVjdGlvblxMb2NhdGlvbgBjb2x1bW5OdW1iZXIiO2k6MDt9czo0MzoiAHBocERvY3VtZW50b3JcUmVmbGVjdGlvblxQaHBcUHJvcGVydHkAdHlwZSI7TjtzOjQ3OiIAcGhwRG9jdW1lbnRvclxSZWZsZWN0aW9uXFBocFxQcm9wZXJ0eQByZWFkT25seSI7YjowO3M6NDc6IgBwaHBEb2N1bWVudG9yXFJlZmxlY3Rpb25cUGhwXFByb3BlcnR5AG1ldGFkYXRhIjthOjA6e319czo1NzoiXF9fVHdpZ1RlbXBsYXRlXzQ5Y2I2MTZjNzNhZDRlNjllOTJlM2QzNjMwNjA1NTBjOjokbWFjcm9zIjtPOjM3OiJwaHBEb2N1bWVudG9yXFJlZmxlY3Rpb25cUGhwXFByb3BlcnR5IjoxMTp7czo0NDoiAHBocERvY3VtZW50b3JcUmVmbGVjdGlvblxQaHBcUHJvcGVydHkAZnFzZW4iO086MzA6InBocERvY3VtZW50b3JcUmVmbGVjdGlvblxGcXNlbiI6Mjp7czozNzoiAHBocERvY3VtZW50b3JcUmVmbGVjdGlvblxGcXNlbgBmcXNlbiI7czo1NzoiXF9fVHdpZ1RlbXBsYXRlXzQ5Y2I2MTZjNzNhZDRlNjllOTJlM2QzNjMwNjA1NTBjOjokbWFjcm9zIjtzOjM2OiIAcGhwRG9jdW1lbnRvclxSZWZsZWN0aW9uXEZxc2VuAG5hbWUiO3M6NjoibWFjcm9zIjt9czo0NzoiAHBocERvY3VtZW50b3JcUmVmbGVjdGlvblxQaHBcUHJvcGVydHkAZG9jQmxvY2siO047czo0NDoiAHBocERvY3VtZW50b3JcUmVmbGVjdGlvblxQaHBcUHJvcGVydHkAdHlwZXMiO2E6MDp7fXM6NDY6IgBwaHBEb2N1bWVudG9yXFJlZmxlY3Rpb25cUGhwXFByb3BlcnR5AGRlZmF1bHQiO3M6MjoiW10iO3M6NDU6IgBwaHBEb2N1bWVudG9yXFJlZmxlY3Rpb25cUGhwXFByb3BlcnR5AHN0YXRpYyI7YjowO3M6NDk6IgBwaHBEb2N1bWVudG9yXFJlZmxlY3Rpb25cUGhwXFByb3BlcnR5AHZpc2liaWxpdHkiO086Mzk6InBocERvY3VtZW50b3JcUmVmbGVjdGlvblxQaHBcVmlzaWJpbGl0eSI6MTp7czo1MToiAHBocERvY3VtZW50b3JcUmVmbGVjdGlvblxQaHBcVmlzaWJpbGl0eQB2aXNpYmlsaXR5IjtzOjc6InByaXZhdGUiO31zOjQ3OiIAcGhwRG9jdW1lbnRvclxSZWZsZWN0aW9uXFBocFxQcm9wZXJ0eQBsb2NhdGlvbiI7TzozMzoicGhwRG9jdW1lbnRvclxSZWZsZWN0aW9uXExvY2F0aW9uIjoyOntzOjQ1OiIAcGhwRG9jdW1lbnRvclxSZWZsZWN0aW9uXExvY2F0aW9uAGxpbmVOdW1iZXIiO2k6MTk7czo0NzoiAHBocERvY3VtZW50b3JcUmVmbGVjdGlvblxMb2NhdGlvbgBjb2x1bW5OdW1iZXIiO2k6MDt9czo1MDoiAHBocERvY3VtZW50b3JcUmVmbGVjdGlvblxQaHBcUHJvcGVydHkAZW5kTG9jYXRpb24iO086MzM6InBocERvY3VtZW50b3JcUmVmbGVjdGlvblxMb2NhdGlvbiI6Mjp7czo0NToiAHBocERvY3VtZW50b3JcUmVmbGVjdGlvblxMb2NhdGlvbgBsaW5lTnVtYmVyIjtpOjE5O3M6NDc6IgBwaHBEb2N1bWVudG9yXFJlZmxlY3Rpb25cTG9jYXRpb24AY29sdW1uTnVtYmVyIjtpOjA7fXM6NDM6IgBwaHBEb2N1bWVudG9yXFJlZmxlY3Rpb25cUGhwXFByb3BlcnR5AHR5cGUiO047czo0NzoiAHBocERvY3VtZW50b3JcUmVmbGVjdGlvblxQaHBcUHJvcGVydHkAcmVhZE9ubHkiO2I6MDtzOjQ3OiIAcGhwRG9jdW1lbnRvclxSZWZsZWN0aW9uXFBocFxQcm9wZXJ0eQBtZXRhZGF0YSI7YTowOnt9fX1zOjQ0OiIAcGhwRG9jdW1lbnRvclxSZWZsZWN0aW9uXFBocFxDbGFzc18AbWV0aG9kcyI7YTo2OntzOjYzOiJcX19Ud2lnVGVtcGxhdGVfNDljYjYxNmM3M2FkNGU2OWU5MmUzZDM2MzA2MDU1MGM6Ol9fY29uc3RydWN0KCkiO086MzU6InBocERvY3VtZW50b3JcUmVmbGVjdGlvblxQaHBcTWV0aG9kIjoxMjp7czo0NToiAHBocERvY3VtZW50b3JcUmVmbGVjdGlvblxQaHBcTWV0aG9kAGRvY0Jsb2NrIjtOO3M6NDI6IgBwaHBEb2N1bWVudG9yXFJlZmxlY3Rpb25cUGhwXE1ldGhvZABmcXNlbiI7TzozMDoicGhwRG9jdW1lbnRvclxSZWZsZWN0aW9uXEZxc2VuIjoyOntzOjM3OiIAcGhwRG9jdW1lbnRvclxSZWZsZWN0aW9uXEZxc2VuAGZxc2VuIjtzOjYzOiJcX19Ud2lnVGVtcGxhdGVfNDljYjYxNmM3M2FkNGU2OWU5MmUzZDM2MzA2MDU1MGM6Ol9fY29uc3RydWN0KCkiO3M6MzY6IgBwaHBEb2N1bWVudG9yXFJlZmxlY3Rpb25cRnFzZW4AbmFtZSI7czoxMToiX19jb25zdHJ1Y3QiO31zOjQ1OiIAcGhwRG9jdW1lbnRvclxSZWZsZWN0aW9uXFBocFxNZXRob2QAYWJzdHJhY3QiO2I6MDtzOjQyOiIAcGhwRG9jdW1lbnRvclxSZWZsZWN0aW9uXFBocFxNZXRob2QAZmluYWwiO2I6MDtzOjQzOiIAcGhwRG9jdW1lbnRvclxSZWZsZWN0aW9uXFBocFxNZXRob2QAc3RhdGljIjtiOjA7czo0NzoiAHBocERvY3VtZW50b3JcUmVmbGVjdGlvblxQaHBcTWV0aG9kAHZpc2liaWxpdHkiO086Mzk6InBocERvY3VtZW50b3JcUmVmbGVjdGlvblxQaHBcVmlzaWJpbGl0eSI6MTp7czo1MToiAHBocERvY3VtZW50b3JcUmVmbGVjdGlvblxQaHBcVmlzaWJpbGl0eQB2aXNpYmlsaXR5IjtzOjY6InB1YmxpYyI7fXM6NDY6IgBwaHBEb2N1bWVudG9yXFJlZmxlY3Rpb25cUGhwXE1ldGhvZABhcmd1bWVudHMiO2E6MTp7aTowO086Mzc6InBocERvY3VtZW50b3JcUmVmbGVjdGlvblxQaHBcQXJndW1lbnQiOjU6e3M6NDM6IgBwaHBEb2N1bWVudG9yXFJlZmxlY3Rpb25cUGhwXEFyZ3VtZW50AG5hbWUiO3M6MzoiZW52IjtzOjQzOiIAcGhwRG9jdW1lbnRvclxSZWZsZWN0aW9uXFBocFxBcmd1bWVudAB0eXBlIjtPOjM4OiJwaHBEb2N1bWVudG9yXFJlZmxlY3Rpb25cVHlwZXNcT2JqZWN0XyI6MTp7czo0NToiAHBocERvY3VtZW50b3JcUmVmbGVjdGlvblxUeXBlc1xPYmplY3RfAGZxc2VuIjtPOjMwOiJwaHBEb2N1bWVudG9yXFJlZmxlY3Rpb25cRnFzZW4iOjI6e3M6Mzc6IgBwaHBEb2N1bWVudG9yXFJlZmxlY3Rpb25cRnFzZW4AZnFzZW4iO3M6MTc6IlxUd2lnXEVudmlyb25tZW50IjtzOjM2OiIAcGhwRG9jdW1lbnRvclxSZWZsZWN0aW9uXEZxc2VuAG5hbWUiO3M6MTE6IkVudmlyb25tZW50Ijt9fXM6NDY6IgBwaHBEb2N1bWVudG9yXFJlZmxlY3Rpb25cUGhwXEFyZ3VtZW50AGRlZmF1bHQiO047czo1MDoiAHBocERvY3VtZW50b3JcUmVmbGVjdGlvblxQaHBcQXJndW1lbnQAYnlSZWZlcmVuY2UiO2I6MDtzOjQ5OiIAcGhwRG9jdW1lbnRvclxSZWZsZWN0aW9uXFBocFxBcmd1bWVudABpc1ZhcmlhZGljIjtiOjA7fX1zOjQ1OiIAcGhwRG9jdW1lbnRvclxSZWZsZWN0aW9uXFBocFxNZXRob2QAbG9jYXRpb24iO086MzM6InBocERvY3VtZW50b3JcUmVmbGVjdGlvblxMb2NhdGlvbiI6Mjp7czo0NToiAHBocERvY3VtZW50b3JcUmVmbGVjdGlvblxMb2NhdGlvbgBsaW5lTnVtYmVyIjtpOjIxO3M6NDc6IgBwaHBEb2N1bWVudG9yXFJlZmxlY3Rpb25cTG9jYXRpb24AY29sdW1uTnVtYmVyIjtpOjUyMzt9czo0ODoiAHBocERvY3VtZW50b3JcUmVmbGVjdGlvblxQaHBcTWV0aG9kAGVuZExvY2F0aW9uIjtPOjMzOiJwaHBEb2N1bWVudG9yXFJlZmxlY3Rpb25cTG9jYXRpb24iOjI6e3M6NDU6IgBwaHBEb2N1bWVudG9yXFJlZmxlY3Rpb25cTG9jYXRpb24AbGluZU51bWJlciI7aTozMTtzOjQ3OiIAcGhwRG9jdW1lbnRvclxSZWZsZWN0aW9uXExvY2F0aW9uAGNvbHVtbk51bWJlciI7aTo3MzY7fXM6NDc6IgBwaHBEb2N1bWVudG9yXFJlZmxlY3Rpb25cUGhwXE1ldGhvZAByZXR1cm5UeXBlIjtPOjM3OiJwaHBEb2N1bWVudG9yXFJlZmxlY3Rpb25cVHlwZXNcTWl4ZWRfIjowOnt9czo1NzoiAHBocERvY3VtZW50b3JcUmVmbGVjdGlvblxQaHBcTWV0aG9kAGhhc1JldHVybkJ5UmVmZXJlbmNlIjtiOjA7czo0NToiAHBocERvY3VtZW50b3JcUmVmbGVjdGlvblxQaHBcTWV0aG9kAG1ldGFkYXRhIjthOjA6e319czo2MToiXF9fVHdpZ1RlbXBsYXRlXzQ5Y2I2MTZjNzNhZDRlNjllOTJlM2QzNjMwNjA1NTBjOjpkb0Rpc3BsYXkoKSI7TzozNToicGhwRG9jdW1lbnRvclxSZWZsZWN0aW9uXFBocFxNZXRob2QiOjEyOntzOjQ1OiIAcGhwRG9jdW1lbnRvclxSZWZsZWN0aW9uXFBocFxNZXRob2QAZG9jQmxvY2siO047czo0MjoiAHBocERvY3VtZW50b3JcUmVmbGVjdGlvblxQaHBcTWV0aG9kAGZxc2VuIjtPOjMwOiJwaHBEb2N1bWVudG9yXFJlZmxlY3Rpb25cRnFzZW4iOjI6e3M6Mzc6IgBwaHBEb2N1bWVudG9yXFJlZmxlY3Rpb25cRnFzZW4AZnFzZW4iO3M6NjE6IlxfX1R3aWdUZW1wbGF0ZV80OWNiNjE2YzczYWQ0ZTY5ZTkyZTNkMzYzMDYwNTUwYzo6ZG9EaXNwbGF5KCkiO3M6MzY6IgBwaHBEb2N1bWVudG9yXFJlZmxlY3Rpb25cRnFzZW4AbmFtZSI7czo5OiJkb0Rpc3BsYXkiO31zOjQ1OiIAcGhwRG9jdW1lbnRvclxSZWZsZWN0aW9uXFBocFxNZXRob2QAYWJzdHJhY3QiO2I6MDtzOjQyOiIAcGhwRG9jdW1lbnRvclxSZWZsZWN0aW9uXFBocFxNZXRob2QAZmluYWwiO2I6MDtzOjQzOiIAcGhwRG9jdW1lbnRvclxSZWZsZWN0aW9uXFBocFxNZXRob2QAc3RhdGljIjtiOjA7czo0NzoiAHBocERvY3VtZW50b3JcUmVmbGVjdGlvblxQaHBcTWV0aG9kAHZpc2liaWxpdHkiO086Mzk6InBocERvY3VtZW50b3JcUmVmbGVjdGlvblxQaHBcVmlzaWJpbGl0eSI6MTp7czo1MToiAHBocERvY3VtZW50b3JcUmVmbGVjdGlvblxQaHBcVmlzaWJpbGl0eQB2aXNpYmlsaXR5IjtzOjk6InByb3RlY3RlZCI7fXM6NDY6IgBwaHBEb2N1bWVudG9yXFJlZmxlY3Rpb25cUGhwXE1ldGhvZABhcmd1bWVudHMiO2E6Mjp7aTowO086Mzc6InBocERvY3VtZW50b3JcUmVmbGVjdGlvblxQaHBcQXJndW1lbnQiOjU6e3M6NDM6IgBwaHBEb2N1bWVudG9yXFJlZmxlY3Rpb25cUGhwXEFyZ3VtZW50AG5hbWUiO3M6NzoiY29udGV4dCI7czo0MzoiAHBocERvY3VtZW50b3JcUmVmbGVjdGlvblxQaHBcQXJndW1lbnQAdHlwZSI7TzozNzoicGhwRG9jdW1lbnRvclxSZWZsZWN0aW9uXFR5cGVzXEFycmF5XyI6Mzp7czoxMjoiACoAdmFsdWVUeXBlIjtPOjM3OiJwaHBEb2N1bWVudG9yXFJlZmxlY3Rpb25cVHlwZXNcTWl4ZWRfIjowOnt9czoxMDoiACoAa2V5VHlwZSI7TjtzOjE3OiIAKgBkZWZhdWx0S2V5VHlwZSI7TzozOToicGhwRG9jdW1lbnRvclxSZWZsZWN0aW9uXFR5cGVzXENvbXBvdW5kIjoyOntzOjUyOiIAcGhwRG9jdW1lbnRvclxSZWZsZWN0aW9uXFR5cGVzXEFnZ3JlZ2F0ZWRUeXBlAHR5cGVzIjthOjI6e2k6MDtPOjM4OiJwaHBEb2N1bWVudG9yXFJlZmxlY3Rpb25cVHlwZXNcU3RyaW5nXyI6MDp7fWk6MTtPOjM4OiJwaHBEb2N1bWVudG9yXFJlZmxlY3Rpb25cVHlwZXNcSW50ZWdlciI6MDp7fX1zOjUyOiIAcGhwRG9jdW1lbnRvclxSZWZsZWN0aW9uXFR5cGVzXEFnZ3JlZ2F0ZWRUeXBlAHRva2VuIjtzOjE6InwiO319czo0NjoiAHBocERvY3VtZW50b3JcUmVmbGVjdGlvblxQaHBcQXJndW1lbnQAZGVmYXVsdCI7TjtzOjUwOiIAcGhwRG9jdW1lbnRvclxSZWZsZWN0aW9uXFBocFxBcmd1bWVudABieVJlZmVyZW5jZSI7YjowO3M6NDk6IgBwaHBEb2N1bWVudG9yXFJlZmxlY3Rpb25cUGhwXEFyZ3VtZW50AGlzVmFyaWFkaWMiO2I6MDt9aToxO086Mzc6InBocERvY3VtZW50b3JcUmVmbGVjdGlvblxQaHBcQXJndW1lbnQiOjU6e3M6NDM6IgBwaHBEb2N1bWVudG9yXFJlZmxlY3Rpb25cUGhwXEFyZ3VtZW50AG5hbWUiO3M6NjoiYmxvY2tzIjtzOjQzOiIAcGhwRG9jdW1lbnRvclxSZWZsZWN0aW9uXFBocFxBcmd1bWVudAB0eXBlIjtPOjM3OiJwaHBEb2N1bWVudG9yXFJlZmxlY3Rpb25cVHlwZXNcQXJyYXlfIjozOntzOjEyOiIAKgB2YWx1ZVR5cGUiO086Mzc6InBocERvY3VtZW50b3JcUmVmbGVjdGlvblxUeXBlc1xNaXhlZF8iOjA6e31zOjEwOiIAKgBrZXlUeXBlIjtOO3M6MTc6IgAqAGRlZmF1bHRLZXlUeXBlIjtPOjM5OiJwaHBEb2N1bWVudG9yXFJlZmxlY3Rpb25cVHlwZXNcQ29tcG91bmQiOjI6e3M6NTI6IgBwaHBEb2N1bWVudG9yXFJlZmxlY3Rpb25cVHlwZXNcQWdncmVnYXRlZFR5cGUAdHlwZXMiO2E6Mjp7aTowO086Mzg6InBocERvY3VtZW50b3JcUmVmbGVjdGlvblxUeXBlc1xTdHJpbmdfIjowOnt9aToxO086Mzg6InBocERvY3VtZW50b3JcUmVmbGVjdGlvblxUeXBlc1xJbnRlZ2VyIjowOnt9fXM6NTI6IgBwaHBEb2N1bWVudG9yXFJlZmxlY3Rpb25cVHlwZXNcQWdncmVnYXRlZFR5cGUAdG9rZW4iO3M6MToifCI7fX1zOjQ2OiIAcGhwRG9jdW1lbnRvclxSZWZsZWN0aW9uXFBocFxBcmd1bWVudABkZWZhdWx0IjtzOjI6IltdIjtzOjUwOiIAcGhwRG9jdW1lbnRvclxSZWZsZWN0aW9uXFBocFxBcmd1bWVudABieVJlZmVyZW5jZSI7YjowO3M6NDk6IgBwaHBEb2N1bWVudG9yXFJlZmxlY3Rpb25cUGhwXEFyZ3VtZW50AGlzVmFyaWFkaWMiO2I6MDt9fXM6NDU6IgBwaHBEb2N1bWVudG9yXFJlZmxlY3Rpb25cUGhwXE1ldGhvZABsb2NhdGlvbiI7TzozMzoicGhwRG9jdW1lbnRvclxSZWZsZWN0aW9uXExvY2F0aW9uIjoyOntzOjQ1OiIAcGhwRG9jdW1lbnRvclxSZWZsZWN0aW9uXExvY2F0aW9uAGxpbmVOdW1iZXIiO2k6MzM7czo0NzoiAHBocERvY3VtZW50b3JcUmVmbGVjdGlvblxMb2NhdGlvbgBjb2x1bW5OdW1iZXIiO2k6NzQzO31zOjQ4OiIAcGhwRG9jdW1lbnRvclxSZWZsZWN0aW9uXFBocFxNZXRob2QAZW5kTG9jYXRpb24iO086MzM6InBocERvY3VtZW50b3JcUmVmbGVjdGlvblxMb2NhdGlvbiI6Mjp7czo0NToiAHBocERvY3VtZW50b3JcUmVmbGVjdGlvblxMb2NhdGlvbgBsaW5lTnVtYmVyIjtpOjk1NjtzOjQ3OiIAcGhwRG9jdW1lbnRvclxSZWZsZWN0aW9uXExvY2F0aW9uAGNvbHVtbk51bWJlciI7aTo0NzA5NDt9czo0NzoiAHBocERvY3VtZW50b3JcUmVmbGVjdGlvblxQaHBcTWV0aG9kAHJldHVyblR5cGUiO086Mzc6InBocERvY3VtZW50b3JcUmVmbGVjdGlvblxUeXBlc1xNaXhlZF8iOjA6e31zOjU3OiIAcGhwRG9jdW1lbnRvclxSZWZsZWN0aW9uXFBocFxNZXRob2QAaGFzUmV0dXJuQnlSZWZlcmVuY2UiO2I6MDtzOjQ1OiIAcGhwRG9jdW1lbnRvclxSZWZsZWN0aW9uXFBocFxNZXRob2QAbWV0YWRhdGEiO2E6MDp7fX1zOjY3OiJcX19Ud2lnVGVtcGxhdGVfNDljYjYxNmM3M2FkNGU2OWU5MmUzZDM2MzA2MDU1MGM6OmdldFRlbXBsYXRlTmFtZSgpIjtPOjM1OiJwaHBEb2N1bWVudG9yXFJlZmxlY3Rpb25cUGhwXE1ldGhvZCI6MTI6e3M6NDU6IgBwaHBEb2N1bWVudG9yXFJlZmxlY3Rpb25cUGhwXE1ldGhvZABkb2NCbG9jayI7TzozMzoicGhwRG9jdW1lbnRvclxSZWZsZWN0aW9uXERvY0Jsb2NrIjo3OntzOjQyOiIAcGhwRG9jdW1lbnRvclxSZWZsZWN0aW9uXERvY0Jsb2NrAHN1bW1hcnkiO3M6MDoiIjtzOjQ2OiIAcGhwRG9jdW1lbnRvclxSZWZsZWN0aW9uXERvY0Jsb2NrAGRlc2NyaXB0aW9uIjtPOjQ1OiJwaHBEb2N1bWVudG9yXFJlZmxlY3Rpb25cRG9jQmxvY2tcRGVzY3JpcHRpb24iOjI6e3M6NTk6IgBwaHBEb2N1bWVudG9yXFJlZmxlY3Rpb25cRG9jQmxvY2tcRGVzY3JpcHRpb24AYm9keVRlbXBsYXRlIjtzOjA6IiI7czo1MToiAHBocERvY3VtZW50b3JcUmVmbGVjdGlvblxEb2NCbG9ja1xEZXNjcmlwdGlvbgB0YWdzIjthOjA6e319czozOToiAHBocERvY3VtZW50b3JcUmVmbGVjdGlvblxEb2NCbG9jawB0YWdzIjthOjE6e2k6MDtPOjQ2OiJwaHBEb2N1bWVudG9yXFJlZmxlY3Rpb25cRG9jQmxvY2tcVGFnc1xHZW5lcmljIjoyOntzOjc6IgAqAG5hbWUiO3M6MTg6ImNvZGVDb3ZlcmFnZUlnbm9yZSI7czoxNDoiACoAZGVzY3JpcHRpb24iO047fX1zOjQyOiIAcGhwRG9jdW1lbnRvclxSZWZsZWN0aW9uXERvY0Jsb2NrAGNvbnRleHQiO086Mzg6InBocERvY3VtZW50b3JcUmVmbGVjdGlvblxUeXBlc1xDb250ZXh0IjoyOntzOjQ5OiIAcGhwRG9jdW1lbnRvclxSZWZsZWN0aW9uXFR5cGVzXENvbnRleHQAbmFtZXNwYWNlIjtzOjA6IiI7czo1NjoiAHBocERvY3VtZW50b3JcUmVmbGVjdGlvblxUeXBlc1xDb250ZXh0AG5hbWVzcGFjZUFsaWFzZXMiO2E6MDp7fX1zOjQzOiIAcGhwRG9jdW1lbnRvclxSZWZsZWN0aW9uXERvY0Jsb2NrAGxvY2F0aW9uIjtOO3M6NTA6IgBwaHBEb2N1bWVudG9yXFJlZmxlY3Rpb25cRG9jQmxvY2sAaXNUZW1wbGF0ZVN0YXJ0IjtiOjA7czo0ODoiAHBocERvY3VtZW50b3JcUmVmbGVjdGlvblxEb2NCbG9jawBpc1RlbXBsYXRlRW5kIjtiOjA7fXM6NDI6IgBwaHBEb2N1bWVudG9yXFJlZmxlY3Rpb25cUGhwXE1ldGhvZABmcXNlbiI7TzozMDoicGhwRG9jdW1lbnRvclxSZWZsZWN0aW9uXEZxc2VuIjoyOntzOjM3OiIAcGhwRG9jdW1lbnRvclxSZWZsZWN0aW9uXEZxc2VuAGZxc2VuIjtzOjY3OiJcX19Ud2lnVGVtcGxhdGVfNDljYjYxNmM3M2FkNGU2OWU5MmUzZDM2MzA2MDU1MGM6OmdldFRlbXBsYXRlTmFtZSgpIjtzOjM2OiIAcGhwRG9jdW1lbnRvclxSZWZsZWN0aW9uXEZxc2VuAG5hbWUiO3M6MTU6ImdldFRlbXBsYXRlTmFtZSI7fXM6NDU6IgBwaHBEb2N1bWVudG9yXFJlZmxlY3Rpb25cUGhwXE1ldGhvZABhYnN0cmFjdCI7YjowO3M6NDI6IgBwaHBEb2N1bWVudG9yXFJlZmxlY3Rpb25cUGhwXE1ldGhvZABmaW5hbCI7YjowO3M6NDM6IgBwaHBEb2N1bWVudG9yXFJlZmxlY3Rpb25cUGhwXE1ldGhvZABzdGF0aWMiO2I6MDtzOjQ3OiIAcGhwRG9jdW1lbnRvclxSZWZsZWN0aW9uXFBocFxNZXRob2QAdmlzaWJpbGl0eSI7TzozOToicGhwRG9jdW1lbnRvclxSZWZsZWN0aW9uXFBocFxWaXNpYmlsaXR5IjoxOntzOjUxOiIAcGhwRG9jdW1lbnRvclxSZWZsZWN0aW9uXFBocFxWaXNpYmlsaXR5AHZpc2liaWxpdHkiO3M6NjoicHVibGljIjt9czo0NjoiAHBocERvY3VtZW50b3JcUmVmbGVjdGlvblxQaHBcTWV0aG9kAGFyZ3VtZW50cyI7YTowOnt9czo0NToiAHBocERvY3VtZW50b3JcUmVmbGVjdGlvblxQaHBcTWV0aG9kAGxvY2F0aW9uIjtPOjMzOiJwaHBEb2N1bWVudG9yXFJlZmxlY3Rpb25cTG9jYXRpb24iOjI6e3M6NDU6IgBwaHBEb2N1bWVudG9yXFJlZmxlY3Rpb25cTG9jYXRpb24AbGluZU51bWJlciI7aTo5NjE7czo0NzoiAHBocERvY3VtZW50b3JcUmVmbGVjdGlvblxMb2NhdGlvbgBjb2x1bW5OdW1iZXIiO2k6NDcxNDQ7fXM6NDg6IgBwaHBEb2N1bWVudG9yXFJlZmxlY3Rpb25cUGhwXE1ldGhvZABlbmRMb2NhdGlvbiI7TzozMzoicGhwRG9jdW1lbnRvclxSZWZsZWN0aW9uXExvY2F0aW9uIjoyOntzOjQ1OiIAcGhwRG9jdW1lbnRvclxSZWZsZWN0aW9uXExvY2F0aW9uAGxpbmVOdW1iZXIiO2k6OTY0O3M6NDc6IgBwaHBEb2N1bWVudG9yXFJlZmxlY3Rpb25cTG9jYXRpb24AY29sdW1uTnVtYmVyIjtpOjQ3MjQ2O31zOjQ3OiIAcGhwRG9jdW1lbnRvclxSZWZsZWN0aW9uXFBocFxNZXRob2QAcmV0dXJuVHlwZSI7TzozNzoicGhwRG9jdW1lbnRvclxSZWZsZWN0aW9uXFR5cGVzXE1peGVkXyI6MDp7fXM6NTc6IgBwaHBEb2N1bWVudG9yXFJlZmxlY3Rpb25cUGhwXE1ldGhvZABoYXNSZXR1cm5CeVJlZmVyZW5jZSI7YjowO3M6NDU6IgBwaHBEb2N1bWVudG9yXFJlZmxlY3Rpb25cUGhwXE1ldGhvZABtZXRhZGF0YSI7YTowOnt9fXM6NjM6IlxfX1R3aWdUZW1wbGF0ZV80OWNiNjE2YzczYWQ0ZTY5ZTkyZTNkMzYzMDYwNTUwYzo6aXNUcmFpdGFibGUoKSI7TzozNToicGhwRG9jdW1lbnRvclxSZWZsZWN0aW9uXFBocFxNZXRob2QiOjEyOntzOjQ1OiIAcGhwRG9jdW1lbnRvclxSZWZsZWN0aW9uXFBocFxNZXRob2QAZG9jQmxvY2siO086MzM6InBocERvY3VtZW50b3JcUmVmbGVjdGlvblxEb2NCbG9jayI6Nzp7czo0MjoiAHBocERvY3VtZW50b3JcUmVmbGVjdGlvblxEb2NCbG9jawBzdW1tYXJ5IjtzOjA6IiI7czo0NjoiAHBocERvY3VtZW50b3JcUmVmbGVjdGlvblxEb2NCbG9jawBkZXNjcmlwdGlvbiI7Tzo0NToicGhwRG9jdW1lbnRvclxSZWZsZWN0aW9uXERvY0Jsb2NrXERlc2NyaXB0aW9uIjoyOntzOjU5OiIAcGhwRG9jdW1lbnRvclxSZWZsZWN0aW9uXERvY0Jsb2NrXERlc2NyaXB0aW9uAGJvZHlUZW1wbGF0ZSI7czowOiIiO3M6NTE6IgBwaHBEb2N1bWVudG9yXFJlZmxlY3Rpb25cRG9jQmxvY2tcRGVzY3JpcHRpb24AdGFncyI7YTowOnt9fXM6Mzk6IgBwaHBEb2N1bWVudG9yXFJlZmxlY3Rpb25cRG9jQmxvY2sAdGFncyI7YToxOntpOjA7Tzo0NjoicGhwRG9jdW1lbnRvclxSZWZsZWN0aW9uXERvY0Jsb2NrXFRhZ3NcR2VuZXJpYyI6Mjp7czo3OiIAKgBuYW1lIjtzOjE4OiJjb2RlQ292ZXJhZ2VJZ25vcmUiO3M6MTQ6IgAqAGRlc2NyaXB0aW9uIjtOO319czo0MjoiAHBocERvY3VtZW50b3JcUmVmbGVjdGlvblxEb2NCbG9jawBjb250ZXh0IjtPOjM4OiJwaHBEb2N1bWVudG9yXFJlZmxlY3Rpb25cVHlwZXNcQ29udGV4dCI6Mjp7czo0OToiAHBocERvY3VtZW50b3JcUmVmbGVjdGlvblxUeXBlc1xDb250ZXh0AG5hbWVzcGFjZSI7czowOiIiO3M6NTY6IgBwaHBEb2N1bWVudG9yXFJlZmxlY3Rpb25cVHlwZXNcQ29udGV4dABuYW1lc3BhY2VBbGlhc2VzIjthOjA6e319czo0MzoiAHBocERvY3VtZW50b3JcUmVmbGVjdGlvblxEb2NCbG9jawBsb2NhdGlvbiI7TjtzOjUwOiIAcGhwRG9jdW1lbnRvclxSZWZsZWN0aW9uXERvY0Jsb2NrAGlzVGVtcGxhdGVTdGFydCI7YjowO3M6NDg6IgBwaHBEb2N1bWVudG9yXFJlZmxlY3Rpb25cRG9jQmxvY2sAaXNUZW1wbGF0ZUVuZCI7YjowO31zOjQyOiIAcGhwRG9jdW1lbnRvclxSZWZsZWN0aW9uXFBocFxNZXRob2QAZnFzZW4iO086MzA6InBocERvY3VtZW50b3JcUmVmbGVjdGlvblxGcXNlbiI6Mjp7czozNzoiAHBocERvY3VtZW50b3JcUmVmbGVjdGlvblxGcXNlbgBmcXNlbiI7czo2MzoiXF9fVHdpZ1RlbXBsYXRlXzQ5Y2I2MTZjNzNhZDRlNjllOTJlM2QzNjMwNjA1NTBjOjppc1RyYWl0YWJsZSgpIjtzOjM2OiIAcGhwRG9jdW1lbnRvclxSZWZsZWN0aW9uXEZxc2VuAG5hbWUiO3M6MTE6ImlzVHJhaXRhYmxlIjt9czo0NToiAHBocERvY3VtZW50b3JcUmVmbGVjdGlvblxQaHBcTWV0aG9kAGFic3RyYWN0IjtiOjA7czo0MjoiAHBocERvY3VtZW50b3JcUmVmbGVjdGlvblxQaHBcTWV0aG9kAGZpbmFsIjtiOjA7czo0MzoiAHBocERvY3VtZW50b3JcUmVmbGVjdGlvblxQaHBcTWV0aG9kAHN0YXRpYyI7YjowO3M6NDc6IgBwaHBEb2N1bWVudG9yXFJlZmxlY3Rpb25cUGhwXE1ldGhvZAB2aXNpYmlsaXR5IjtPOjM5OiJwaHBEb2N1bWVudG9yXFJlZmxlY3Rpb25cUGhwXFZpc2liaWxpdHkiOjE6e3M6NTE6IgBwaHBEb2N1bWVudG9yXFJlZmxlY3Rpb25cUGhwXFZpc2liaWxpdHkAdmlzaWJpbGl0eSI7czo2OiJwdWJsaWMiO31zOjQ2OiIAcGhwRG9jdW1lbnRvclxSZWZsZWN0aW9uXFBocFxNZXRob2QAYXJndW1lbnRzIjthOjA6e31zOjQ1OiIAcGhwRG9jdW1lbnRvclxSZWZsZWN0aW9uXFBocFxNZXRob2QAbG9jYXRpb24iO086MzM6InBocERvY3VtZW50b3JcUmVmbGVjdGlvblxMb2NhdGlvbiI6Mjp7czo0NToiAHBocERvY3VtZW50b3JcUmVmbGVjdGlvblxMb2NhdGlvbgBsaW5lTnVtYmVyIjtpOjk2OTtzOjQ3OiIAcGhwRG9jdW1lbnRvclxSZWZsZWN0aW9uXExvY2F0aW9uAGNvbHVtbk51bWJlciI7aTo0NzI5Njt9czo0ODoiAHBocERvY3VtZW50b3JcUmVmbGVjdGlvblxQaHBcTWV0aG9kAGVuZExvY2F0aW9uIjtPOjMzOiJwaHBEb2N1bWVudG9yXFJlZmxlY3Rpb25cTG9jYXRpb24iOjI6e3M6NDU6IgBwaHBEb2N1bWVudG9yXFJlZmxlY3Rpb25cTG9jYXRpb24AbGluZU51bWJlciI7aTo5NzI7czo0NzoiAHBocERvY3VtZW50b3JcUmVmbGVjdGlvblxMb2NhdGlvbgBjb2x1bW5OdW1iZXIiO2k6NDczNTg7fXM6NDc6IgBwaHBEb2N1bWVudG9yXFJlZmxlY3Rpb25cUGhwXE1ldGhvZAByZXR1cm5UeXBlIjtPOjM3OiJwaHBEb2N1bWVudG9yXFJlZmxlY3Rpb25cVHlwZXNcTWl4ZWRfIjowOnt9czo1NzoiAHBocERvY3VtZW50b3JcUmVmbGVjdGlvblxQaHBcTWV0aG9kAGhhc1JldHVybkJ5UmVmZXJlbmNlIjtiOjA7czo0NToiAHBocERvY3VtZW50b3JcUmVmbGVjdGlvblxQaHBcTWV0aG9kAG1ldGFkYXRhIjthOjA6e319czo2NDoiXF9fVHdpZ1RlbXBsYXRlXzQ5Y2I2MTZjNzNhZDRlNjllOTJlM2QzNjMwNjA1NTBjOjpnZXREZWJ1Z0luZm8oKSI7TzozNToicGhwRG9jdW1lbnRvclxSZWZsZWN0aW9uXFBocFxNZXRob2QiOjEyOntzOjQ1OiIAcGhwRG9jdW1lbnRvclxSZWZsZWN0aW9uXFBocFxNZXRob2QAZG9jQmxvY2siO086MzM6InBocERvY3VtZW50b3JcUmVmbGVjdGlvblxEb2NCbG9jayI6Nzp7czo0MjoiAHBocERvY3VtZW50b3JcUmVmbGVjdGlvblxEb2NCbG9jawBzdW1tYXJ5IjtzOjA6IiI7czo0NjoiAHBocERvY3VtZW50b3JcUmVmbGVjdGlvblxEb2NCbG9jawBkZXNjcmlwdGlvbiI7Tzo0NToicGhwRG9jdW1lbnRvclxSZWZsZWN0aW9uXERvY0Jsb2NrXERlc2NyaXB0aW9uIjoyOntzOjU5OiIAcGhwRG9jdW1lbnRvclxSZWZsZWN0aW9uXERvY0Jsb2NrXERlc2NyaXB0aW9uAGJvZHlUZW1wbGF0ZSI7czowOiIiO3M6NTE6IgBwaHBEb2N1bWVudG9yXFJlZmxlY3Rpb25cRG9jQmxvY2tcRGVzY3JpcHRpb24AdGFncyI7YTowOnt9fXM6Mzk6IgBwaHBEb2N1bWVudG9yXFJlZmxlY3Rpb25cRG9jQmxvY2sAdGFncyI7YToxOntpOjA7Tzo0NjoicGhwRG9jdW1lbnRvclxSZWZsZWN0aW9uXERvY0Jsb2NrXFRhZ3NcR2VuZXJpYyI6Mjp7czo3OiIAKgBuYW1lIjtzOjE4OiJjb2RlQ292ZXJhZ2VJZ25vcmUiO3M6MTQ6IgAqAGRlc2NyaXB0aW9uIjtOO319czo0MjoiAHBocERvY3VtZW50b3JcUmVmbGVjdGlvblxEb2NCbG9jawBjb250ZXh0IjtPOjM4OiJwaHBEb2N1bWVudG9yXFJlZmxlY3Rpb25cVHlwZXNcQ29udGV4dCI6Mjp7czo0OToiAHBocERvY3VtZW50b3JcUmVmbGVjdGlvblxUeXBlc1xDb250ZXh0AG5hbWVzcGFjZSI7czowOiIiO3M6NTY6IgBwaHBEb2N1bWVudG9yXFJlZmxlY3Rpb25cVHlwZXNcQ29udGV4dABuYW1lc3BhY2VBbGlhc2VzIjthOjA6e319czo0MzoiAHBocERvY3VtZW50b3JcUmVmbGVjdGlvblxEb2NCbG9jawBsb2NhdGlvbiI7TjtzOjUwOiIAcGhwRG9jdW1lbnRvclxSZWZsZWN0aW9uXERvY0Jsb2NrAGlzVGVtcGxhdGVTdGFydCI7YjowO3M6NDg6IgBwaHBEb2N1bWVudG9yXFJlZmxlY3Rpb25cRG9jQmxvY2sAaXNUZW1wbGF0ZUVuZCI7YjowO31zOjQyOiIAcGhwRG9jdW1lbnRvclxSZWZsZWN0aW9uXFBocFxNZXRob2QAZnFzZW4iO086MzA6InBocERvY3VtZW50b3JcUmVmbGVjdGlvblxGcXNlbiI6Mjp7czozNzoiAHBocERvY3VtZW50b3JcUmVmbGVjdGlvblxGcXNlbgBmcXNlbiI7czo2NDoiXF9fVHdpZ1RlbXBsYXRlXzQ5Y2I2MTZjNzNhZDRlNjllOTJlM2QzNjMwNjA1NTBjOjpnZXREZWJ1Z0luZm8oKSI7czozNjoiAHBocERvY3VtZW50b3JcUmVmbGVjdGlvblxGcXNlbgBuYW1lIjtzOjEyOiJnZXREZWJ1Z0luZm8iO31zOjQ1OiIAcGhwRG9jdW1lbnRvclxSZWZsZWN0aW9uXFBocFxNZXRob2QAYWJzdHJhY3QiO2I6MDtzOjQyOiIAcGhwRG9jdW1lbnRvclxSZWZsZWN0aW9uXFBocFxNZXRob2QAZmluYWwiO2I6MDtzOjQzOiIAcGhwRG9jdW1lbnRvclxSZWZsZWN0aW9uXFBocFxNZXRob2QAc3RhdGljIjtiOjA7czo0NzoiAHBocERvY3VtZW50b3JcUmVmbGVjdGlvblxQaHBcTWV0aG9kAHZpc2liaWxpdHkiO086Mzk6InBocERvY3VtZW50b3JcUmVmbGVjdGlvblxQaHBcVmlzaWJpbGl0eSI6MTp7czo1MToiAHBocERvY3VtZW50b3JcUmVmbGVjdGlvblxQaHBcVmlzaWJpbGl0eQB2aXNpYmlsaXR5IjtzOjY6InB1YmxpYyI7fXM6NDY6IgBwaHBEb2N1bWVudG9yXFJlZmxlY3Rpb25cUGhwXE1ldGhvZABhcmd1bWVudHMiO2E6MDp7fXM6NDU6IgBwaHBEb2N1bWVudG9yXFJlZmxlY3Rpb25cUGhwXE1ldGhvZABsb2NhdGlvbiI7TzozMzoicGhwRG9jdW1lbnRvclxSZWZsZWN0aW9uXExvY2F0aW9uIjoyOntzOjQ1OiIAcGhwRG9jdW1lbnRvclxSZWZsZWN0aW9uXExvY2F0aW9uAGxpbmVOdW1iZXIiO2k6OTc3O3M6NDc6IgBwaHBEb2N1bWVudG9yXFJlZmxlY3Rpb25cTG9jYXRpb24AY29sdW1uTnVtYmVyIjtpOjQ3NDA4O31zOjQ4OiIAcGhwRG9jdW1lbnRvclxSZWZsZWN0aW9uXFBocFxNZXRob2QAZW5kTG9jYXRpb24iO086MzM6InBocERvY3VtZW50b3JcUmVmbGVjdGlvblxMb2NhdGlvbiI6Mjp7czo0NToiAHBocERvY3VtZW50b3JcUmVmbGVjdGlvblxMb2NhdGlvbgBsaW5lTnVtYmVyIjtpOjk4MDtzOjQ3OiIAcGhwRG9jdW1lbnRvclxSZWZsZWN0aW9uXExvY2F0aW9uAGNvbHVtbk51bWJlciI7aTo0NzYzNzt9czo0NzoiAHBocERvY3VtZW50b3JcUmVmbGVjdGlvblxQaHBcTWV0aG9kAHJldHVyblR5cGUiO086Mzc6InBocERvY3VtZW50b3JcUmVmbGVjdGlvblxUeXBlc1xNaXhlZF8iOjA6e31zOjU3OiIAcGhwRG9jdW1lbnRvclxSZWZsZWN0aW9uXFBocFxNZXRob2QAaGFzUmV0dXJuQnlSZWZlcmVuY2UiO2I6MDtzOjQ1OiIAcGhwRG9jdW1lbnRvclxSZWZsZWN0aW9uXFBocFxNZXRob2QAbWV0YWRhdGEiO2E6MDp7fX1zOjY4OiJcX19Ud2lnVGVtcGxhdGVfNDljYjYxNmM3M2FkNGU2OWU5MmUzZDM2MzA2MDU1MGM6OmdldFNvdXJjZUNvbnRleHQoKSI7TzozNToicGhwRG9jdW1lbnRvclxSZWZsZWN0aW9uXFBocFxNZXRob2QiOjEyOntzOjQ1OiIAcGhwRG9jdW1lbnRvclxSZWZsZWN0aW9uXFBocFxNZXRob2QAZG9jQmxvY2siO047czo0MjoiAHBocERvY3VtZW50b3JcUmVmbGVjdGlvblxQaHBcTWV0aG9kAGZxc2VuIjtPOjMwOiJwaHBEb2N1bWVudG9yXFJlZmxlY3Rpb25cRnFzZW4iOjI6e3M6Mzc6IgBwaHBEb2N1bWVudG9yXFJlZmxlY3Rpb25cRnFzZW4AZnFzZW4iO3M6Njg6IlxfX1R3aWdUZW1wbGF0ZV80OWNiNjE2YzczYWQ0ZTY5ZTkyZTNkMzYzMDYwNTUwYzo6Z2V0U291cmNlQ29udGV4dCgpIjtzOjM2OiIAcGhwRG9jdW1lbnRvclxSZWZsZWN0aW9uXEZxc2VuAG5hbWUiO3M6MTY6ImdldFNvdXJjZUNvbnRleHQiO31zOjQ1OiIAcGhwRG9jdW1lbnRvclxSZWZsZWN0aW9uXFBocFxNZXRob2QAYWJzdHJhY3QiO2I6MDtzOjQyOiIAcGhwRG9jdW1lbnRvclxSZWZsZWN0aW9uXFBocFxNZXRob2QAZmluYWwiO2I6MDtzOjQzOiIAcGhwRG9jdW1lbnRvclxSZWZsZWN0aW9uXFBocFxNZXRob2QAc3RhdGljIjtiOjA7czo0NzoiAHBocERvY3VtZW50b3JcUmVmbGVjdGlvblxQaHBcTWV0aG9kAHZpc2liaWxpdHkiO086Mzk6InBocERvY3VtZW50b3JcUmVmbGVjdGlvblxQaHBcVmlzaWJpbGl0eSI6MTp7czo1MToiAHBocERvY3VtZW50b3JcUmVmbGVjdGlvblxQaHBcVmlzaWJpbGl0eQB2aXNpYmlsaXR5IjtzOjY6InB1YmxpYyI7fXM6NDY6IgBwaHBEb2N1bWVudG9yXFJlZmxlY3Rpb25cUGhwXE1ldGhvZABhcmd1bWVudHMiO2E6MDp7fXM6NDU6IgBwaHBEb2N1bWVudG9yXFJlZmxlY3Rpb25cUGhwXE1ldGhvZABsb2NhdGlvbiI7TzozMzoicGhwRG9jdW1lbnRvclxSZWZsZWN0aW9uXExvY2F0aW9uIjoyOntzOjQ1OiIAcGhwRG9jdW1lbnRvclxSZWZsZWN0aW9uXExvY2F0aW9uAGxpbmVOdW1iZXIiO2k6OTgyO3M6NDc6IgBwaHBEb2N1bWVudG9yXFJlZmxlY3Rpb25cTG9jYXRpb24AY29sdW1uTnVtYmVyIjtpOjQ3NjQ0O31zOjQ4OiIAcGhwRG9jdW1lbnRvclxSZWZsZWN0aW9uXFBocFxNZXRob2QAZW5kTG9jYXRpb24iO086MzM6InBocERvY3VtZW50b3JcUmVmbGVjdGlvblxMb2NhdGlvbiI6Mjp7czo0NToiAHBocERvY3VtZW50b3JcUmVmbGVjdGlvblxMb2NhdGlvbgBsaW5lTnVtYmVyIjtpOjE4NTk7czo0NzoiAHBocERvY3VtZW50b3JcUmVmbGVjdGlvblxMb2NhdGlvbgBjb2x1bW5OdW1iZXIiO2k6ODk3MTE7fXM6NDc6IgBwaHBEb2N1bWVudG9yXFJlZmxlY3Rpb25cUGhwXE1ldGhvZAByZXR1cm5UeXBlIjtPOjM3OiJwaHBEb2N1bWVudG9yXFJlZmxlY3Rpb25cVHlwZXNcTWl4ZWRfIjowOnt9czo1NzoiAHBocERvY3VtZW50b3JcUmVmbGVjdGlvblxQaHBcTWV0aG9kAGhhc1JldHVybkJ5UmVmZXJlbmNlIjtiOjA7czo0NToiAHBocERvY3VtZW50b3JcUmVmbGVjdGlvblxQaHBcTWV0aG9kAG1ldGFkYXRhIjthOjA6e319fXM6NDc6IgBwaHBEb2N1bWVudG9yXFJlZmxlY3Rpb25cUGhwXENsYXNzXwB1c2VkVHJhaXRzIjthOjA6e31zOjQ1OiIAcGhwRG9jdW1lbnRvclxSZWZsZWN0aW9uXFBocFxDbGFzc18AbG9jYXRpb24iO086MzM6InBocERvY3VtZW50b3JcUmVmbGVjdGlvblxMb2NhdGlvbiI6Mjp7czo0NToiAHBocERvY3VtZW50b3JcUmVmbGVjdGlvblxMb2NhdGlvbgBsaW5lTnVtYmVyIjtpOjE2O3M6NDc6IgBwaHBEb2N1bWVudG9yXFJlZmxlY3Rpb25cTG9jYXRpb24AY29sdW1uTnVtYmVyIjtpOjA7fXM6NDg6IgBwaHBEb2N1bWVudG9yXFJlZmxlY3Rpb25cUGhwXENsYXNzXwBlbmRMb2NhdGlvbiI7TzozMzoicGhwRG9jdW1lbnRvclxSZWZsZWN0aW9uXExvY2F0aW9uIjoyOntzOjQ1OiIAcGhwRG9jdW1lbnRvclxSZWZsZWN0aW9uXExvY2F0aW9uAGxpbmVOdW1iZXIiO2k6MTg2MDtzOjQ3OiIAcGhwRG9jdW1lbnRvclxSZWZsZWN0aW9uXExvY2F0aW9uAGNvbHVtbk51bWJlciI7aTowO31zOjQ1OiIAcGhwRG9jdW1lbnRvclxSZWZsZWN0aW9uXFBocFxDbGFzc18AbWV0YWRhdGEiO2E6MDp7fX19czo0NToiAHBocERvY3VtZW50b3JcUmVmbGVjdGlvblxQaHBcRmlsZQBpbnRlcmZhY2VzIjthOjA6e31zOjQxOiIAcGhwRG9jdW1lbnRvclxSZWZsZWN0aW9uXFBocFxGaWxlAHRyYWl0cyI7YTowOnt9czo0MDoiAHBocERvY3VtZW50b3JcUmVmbGVjdGlvblxQaHBcRmlsZQBlbnVtcyI7YTowOnt9czo0MzoiAHBocERvY3VtZW50b3JcUmVmbGVjdGlvblxQaHBcRmlsZQBtZXRhZGF0YSI7YTowOnt9fQ==";